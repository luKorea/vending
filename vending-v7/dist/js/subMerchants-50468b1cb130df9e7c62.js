/*! 版权所有，翻版必究 */!function(e){function t(t){for(var a,r,c=t[0],l=t[1],s=t[2],u=0,p=[];u<c.length;u++)r=c[u],Object.prototype.hasOwnProperty.call(o,r)&&o[r]&&p.push(o[r][0]),o[r]=0;for(a in l)Object.prototype.hasOwnProperty.call(l,a)&&(e[a]=l[a]);for(d&&d(t);p.length;)p.shift()();return i.push.apply(i,s||[]),n()}function n(){for(var e,t=0;t<i.length;t++){for(var n=i[t],a=!0,c=1;c<n.length;c++){var l=n[c];0!==o[l]&&(a=!1)}a&&(i.splice(t--,1),e=r(r.s=n[0]))}return e}var a={},o={41:0},i=[];function r(t){if(a[t])return a[t].exports;var n=a[t]={i:t,l:!1,exports:{}};return e[t].call(n.exports,n,n.exports,r),n.l=!0,n.exports}r.m=e,r.c=a,r.d=function(e,t,n){r.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:n})},r.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},r.t=function(e,t){if(1&t&&(e=r(e)),8&t)return e;if(4&t&&"object"==typeof e&&e&&e.__esModule)return e;var n=Object.create(null);if(r.r(n),Object.defineProperty(n,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var a in e)r.d(n,a,function(t){return e[t]}.bind(null,a));return n},r.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return r.d(t,"a",t),t},r.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},r.p="";var c=window.webpackJsonp=window.webpackJsonp||[],l=c.push.bind(c);c.push=t,c=c.slice();for(var s=0;s<c.length;s++)t(c[s]);var d=l;i.push([265,0]),n()}({265:function(e,t,n){"use strict";n.r(t);n(651);layui.use(["laydate","table","tree","flow","layer","form"],function(){$(".sidebar i").click(function(){$(".activityBox").hide(),$(".onLeft").show()}),$(".onLeft").click(function(){$(".onLeft").hide(),$(".activityBox").show()});var e=sessionStorage.token,t=layui.flow,n=layui.layer,a=layui.table,o=layui.form,i=layui.tree,r=sessionStorage.machineID,c=a.render({elem:"#moneyData",url:"".concat(vApi,"/pay/subMerList"),method:"post",contentType:"application/json",headers:{token:e},cols:[[{field:"sub_name",title:"子商户名称",align:"center"},{field:"merchant_name",title:"商户名称",align:"center"},{field:"merchant_short_name",title:"商户简称",align:"center"},{field:"wallet_id",title:"商户钱包ID",align:"center"},{field:"contact_name",title:"联系人",align:"center"},{field:"service_phone",title:"联系人电话",align:"center"},{field:"contact_email",title:"联系邮箱",align:"center"},{field:"merchant_remark",title:"商户备注",align:"center"},{field:"status",title:"是否关联",align:"center",templet:function(e){return 1==+e.status?"是":"否"}},{field:"operation",title:"操作",toolbar:"#barDemo",align:"center"}]],page:!0,loading:!0,request:{pageName:"pageNum",limitName:"pageSize"},where:{payId:m},parseData:function(e){return 200==e.code?{code:e.code,msg:e.message,count:e.data.total,data:e.data.list}:403!=e.code?{code:e.code,msg:e.message}:void(window.parent.location.href="login.html")},response:{statusCode:200},done:function(e){}}),l="add";function s(){o.val("information",{sub_name:"",contact_email:"",contact_name:"",merchant_remark:"",merchant_name:"",merchant_short_name:"",wallet_id:"",service_phone:""})}$(".addBtn").click(function(){0!==u.length?0===u.length||""!==m?($(".subTitle").html("新增子商户"),popupShow("MemberOperation","addBox")):n.msg("清先选择对应的数字货币商户",{icon:7}):n.msg("您的商户没有配置对应的数字货币支付方式，不能新增子商户！！",{icon:7})}),$(".submit_btn").click(function(){var t=o.val("information");t.payId=m,"edit"===l&&(t.channel_id=d.channel_id),loadingAjax("/pay/subMerchant","POST",JSON.stringify(t),e).then(function(e){200===e.code&&(n.msg("操作成功",{icon:1}),popupHide("MemberOperation","MemberContent"),s(),c.reload({where:{payId:m}}))}).catch(function(e){console.log(e),n.msg(e.message,{icon:7})})}),$(".cancel_btn").click(function(){$(".ListOperation").fadeOut(),null,popupHide("MemberOperation","MemberContent"),s()}),$(".playHeader .close").click(function(){$(this).parent().parent().addClass("margin0"),$(this).parents(".maskContnet").fadeOut(),s()}),$(".addBox .addCancelBtn").click(function(){popupHide("addMerchants","addBox"),s()});var d=null;a.on("tool(moneyData)",function(e){event.stopPropagation(),d=e.data,"operation"===e.event&&(e.data.id,$(".ListOperation").fadeIn(),$(".ListOperation").css({left:$(this).offset().left-35+"px",top:$(this).offset().top+35+"px"}))}),$(".ListOperation .edit").click(function(){l="edit",$(".subTitle").html("编辑子商户"),popupShow("MemberOperation","addBox"),console.log(d),o.val("information",{sub_name:d.sub_name,contact_email:d.contact_email,contact_name:d.contact_name,merchant_remark:d.merchant_remark,merchant_name:d.merchant_name,merchant_short_name:d.merchant_short_name,wallet_id:d.wallet_id,service_phone:d.service_phone})}),$(".ListOperation .relation").click(function(){n.confirm("收款方只能关联一个子商户，是否修改？",function(t){$.ajax({type:"POST",url:"".concat(vApi,"/pay/associationMer"),headers:{token:e,"Content-Type":"application/json"},data:JSON.stringify({channel_id:d.channel_id,payId:m}),success:function(e){200==e.code?(n.msg(e.message,{icon:1}),n.close(t),c.reload({where:{payId:m}})):403==e.code?window.parent.location.href="login.html":n.msg(e.message,{icon:2})}})})});var u=[];function p(){t.load({elem:"#demo",isAuto:!0,scrollElem:"#demo",end:" ",done:function(e,t){setTimeout(function(){var a=[];t(a.join(""),e<1e3);var o=JSON.stringify({pageNum:e,pageSize:100,merchantId:r});loadingAjax("/pay/digitalCurrencyList","post",o,sessionStorage.token).then(function(e){u=e.data,e.data.forEach(function(e,t){a.push('<span activityID="'.concat(e.id,'">').concat(e.payee,"</span>"))}),t(a.join(""),e.data.length>=100)}).catch(function(e){console.log(e),n.msg(e.message,{icon:7}),t(a.join(""),200==e.code)})},200)}})}p(),$(".queryBtn").click(function(){n.msg("已刷新",{icon:1});treeList()});var m="";$("body").on("click",".activityArr span",function(){$(this).addClass("active").siblings().removeClass("active"),m=$(this).attr("activityID"),c.reload({where:{payId:Number(m)}})});!function(e,t,n){e.render({elem:"#".concat(t),id:"treelist",showLine:!0,onlyIconControl:!0,data:n,spread:!0,text:{defaultNodeName:"无数据",none:"您没有权限，请联系管理员授权!"},click:function(e){e.data.title;for(var n=$("#".concat(t," .layui-tree-txt")),a=0;a<n.length;a++)n[a].innerHTML===e.data.title?n[a].style.color="#be954a":n[a].style.color="#555";r!=e.data.id&&(r=e.data.id,$("#demo").remove(),$(document).unbind(),$(".activityList1").append('<div class="activityArr" id="demo"></div>'),p(),$(".activityList1 span").removeClass("active"),"",m="",c.reload({where:{payId:""}}))}})}(i,"test1",treeList());sessionStorage.marchantName;var f=window.parent.permissionsData1();permissionsVal1({476:!1},f)[476]?$(".pushBtn").removeClass("hide"):$(".pushBtn").addClass("hide"),$(".refreshBtnList").click(function(){n.msg("已刷新",{icon:1});treeList()}),$("body").click(function(){$(".ListOperation").fadeOut(),null})})},651:function(e,t){}});