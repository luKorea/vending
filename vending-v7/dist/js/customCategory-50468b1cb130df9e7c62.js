/*! 版权所有，翻版必究 */!function(e){function t(t){for(var n,s,r=t[0],l=t[1],d=t[2],f=0,u=[];f<r.length;f++)s=r[f],Object.prototype.hasOwnProperty.call(i,s)&&i[s]&&u.push(i[s][0]),i[s]=0;for(n in l)Object.prototype.hasOwnProperty.call(l,n)&&(e[n]=l[n]);for(c&&c(t);u.length;)u.shift()();return o.push.apply(o,d||[]),a()}function a(){for(var e,t=0;t<o.length;t++){for(var a=o[t],n=!0,r=1;r<a.length;r++){var l=a[r];0!==i[l]&&(n=!1)}n&&(o.splice(t--,1),e=s(s.s=a[0]))}return e}var n={},i={10:0},o=[];function s(t){if(n[t])return n[t].exports;var a=n[t]={i:t,l:!1,exports:{}};return e[t].call(a.exports,a,a.exports,s),a.l=!0,a.exports}s.m=e,s.c=n,s.d=function(e,t,a){s.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:a})},s.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},s.t=function(e,t){if(1&t&&(e=s(e)),8&t)return e;if(4&t&&"object"==typeof e&&e&&e.__esModule)return e;var a=Object.create(null);if(s.r(a),Object.defineProperty(a,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var n in e)s.d(a,n,function(t){return e[t]}.bind(null,n));return a},s.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return s.d(t,"a",t),t},s.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},s.p="";var r=window.webpackJsonp=window.webpackJsonp||[],l=r.push.bind(r);r.push=t,r=r.slice();for(var d=0;d<r.length;d++)t(r[d]);var c=l;o.push([245,0]),a()}({245:function(e,t,a){"use strict";a.r(t);a(611);layui.use(["table","form","layer","tree"],function(){var e=window.parent.permissionsData1(),t=sessionStorage.machineID,a=permissionsVal1({373:!1,374:!1,372:!1,403:!1},e);function n(){a[373]?$(".addBtn").removeClass("hide"):$(".addBtn").addClass("hide"),a[374]?$(".ListOperation .edit").removeClass("hide"):$(".ListOperation .edit").addClass("hide"),a[372]?$(".ListOperation .del").removeClass("hide"):$(".ListOperation .del").addClass("hide"),a[374]||a[372]?$(".Toperation").removeClass("hide"):$(".Toperation").addClass("hide"),a[403]?$(".rankImg").removeClass("hide"):$(".rankImg").addClass("hide")}n(),sessionStorage.classTag=sessionStorage.machineID;var i=layui.table,o=layui.layer,s=layui.tree,r=null,l=sessionStorage.token,d=[[{field:"1",title:"升降序",templet:"#imgtmp",event:"rank",align:"center"},{field:"rank",title:"排序",align:"center"},{field:"classifyName",title:"类目名",align:"center"},{field:"remark",title:"备注",align:"center"},{field:"user",title:"创建人",align:"center",templet:function(e){return null!=e.user?e.user.userName:""}},{field:"classifyTime",title:"创建时间",align:"center"},{field:"lastUser",title:"最后修改人",align:"center"},{field:"lastTime",title:"最后修改时间",align:"center"},{field:"operation",align:"center",title:"操作",toolbar:"#barDemo"}]],c=i.render({elem:"#tableTest",url:"".concat(vApi,"/classify/findAll"),method:"post",contentType:"application/json",headers:{token:l},cols:d,id:"tableId",page:!0,loading:!0,request:{pageName:"pageNum",limitName:"pageSize"},where:{merchantId:t},parseData:function(e){return 200==e.code?{code:e.code,msg:"",count:e.data.total,data:e.data.list}:403!=e.code?{code:e.code,msg:e.message}:void(window.parent.location.href="login.html")},response:{statusCode:200},done:function(e){r=e.data,n(),403==e.code?window.parent.location.href="login.html":405==e.code&&$(".hangContent").show()}});$(".queryBtn").click(function(){saveTableWidth(d),c.reload({where:{},cols:d})});$(".addBtn").click(function(){$('.addClass input[name="addTypeName"]').val(""),$('.addClass input[name="addNote"]').val(""),popupShow("addClass","addContent")}),$(".cancel-btn").click(function(){popupHide("addClass","addContent")});var f=layui.form;$(".determine-btn").click(function(){var e=f.val("aDDValData");if(e.addTypeName){var a=JSON.stringify({classifyName:e.addTypeName,remark:e.addNote,merchantId:Number(t)});$(".mask").fadeIn(),$(".maskSpan").addClass("maskIcon"),loadingAjax("/classify/saveClassify","post",a,sessionStorage.token,"mask","addClass","addContent",o).then(function(e){o.msg(e.message,{icon:1}),c.reload({where:{}}),loadingAjax("/refreshGoods","post","",sessionStorage.token).then(function(e){}).catch(function(e){})}).catch(function(e){o.msg(e.message,{icon:2})})}else o.msg("请填写类目名")});var u=null,p=null,m=null;i.on("tool(test)",function(e){if(event.stopPropagation(),u=e.data,m=e,"operation"===e.event){if(p==e.data.classifyId)return $(".ListOperation").fadeOut(),void(p=null);p=e.data.classifyId,$(".ListOperation").fadeIn(),$(".ListOperation").css({left:$(this).offset().left-35+"px",top:$(this).offset().top+35+"px"})}else if("rank"==e.event){console.log(e);var a=JSON.stringify({topId:r[e.data.rank-1].classifyId,bottomId:r[e.data.rank-2].classifyId,merchantId:t});loadingAjax("/classify/sortClassify","post",a,l,"","","",o).then(function(e){o.msg(e.message,{icon:1}),c.reload({where:{}})}).catch(function(e){o.msg(e.message,{icon:2})})}}),$(".ListOperation .edit").click(function(){popupShow("editClass","editContent"),f.val("editValData",{addTypeName:u.classifyName,addNote:u.remark})}),$(".ListOperation .del").click(function(){o.confirm("确定删除？",function(e){Goodsdel(u,2,m,e,c,sessionStorage.classTag)})}),$(".editDetermine-btn").click(function(){var e=f.val("editValData");if(e.addTypeName){var a=JSON.stringify({classifyId:u.classifyId,classifyName:e.addTypeName,remark:e.addNote,merchantId:Number(t)});$(".mask").fadeIn(),$(".maskSpan").addClass("maskIcon"),loadingAjax("/classify/updateClassify","post",a,sessionStorage.token,"mask","editClass","editContent",o).then(function(e){o.msg(e.message,{icon:1}),c.reload({where:{}}),loadingAjax("/refreshGoods","post","",sessionStorage.token).then(function(e){}).catch(function(e){})}).catch(function(e){o.msg(e.message,{icon:2})})}else o.msg("请填写类目名")}),$(".editCancel-btn").click(function(){popupHide("editClass","editContent")}),$(".playHeader .close").click(function(){$(this).parent().parent().addClass("margin0"),$(this).parents(".maskContnet").fadeOut()});var g=treeList();function h(e,a,n,i){e.render({elem:"#".concat(a),id:"treelist",showLine:!0,onlyIconControl:!0,data:i,spread:!0,text:{defaultNodeName:"无数据",none:"您没有权限，请联系管理员授权!"},click:function(e){t=String(e.data.id),console.log(t,"test"),n.reload({where:{merchantId:t}});for(var i=$("#".concat(a," .layui-tree-txt")),o=0;o<i.length;o++)i[o].innerHTML===e.data.title?i[o].style.color="#be954a":i[o].style.color="#555"}})}h(s,"testGoods",c,g),$(".refreshBtnList").click(function(){var e=treeList();JSON.stringify(e)!=JSON.stringify(g)?(h(s,"testGoods",c,g=e),c.reload({where:{merchantId:t}}),o.msg("已刷新",{icon:1})):o.msg("已刷新",{icon:1})}),$(".sidebar i").click(function(){$(".left-mian").hide(),$(".on-left").show()}),$(".on-left").click(function(){$(".left-mian").show(),$(".on-left").hide()}),$("body").bind("keydown",function(e){116==e.keyCode&&f5Fun()}),$("body").click(function(){$(".ListOperation").fadeOut(),p=null})})},611:function(e,t){}});