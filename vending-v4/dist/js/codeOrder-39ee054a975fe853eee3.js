/*! 版权所有，翻版必究 */!function(l){function e(e){for(var t,i,n=e[0],a=e[1],o=e[2],r=0,c=[];r<n.length;r++)i=n[r],Object.prototype.hasOwnProperty.call(d,i)&&d[i]&&c.push(d[i][0]),d[i]=0;for(t in a)Object.prototype.hasOwnProperty.call(a,t)&&(l[t]=a[t]);for(m&&m(e);c.length;)c.shift()();return u.push.apply(u,o||[]),s()}function s(){for(var e,t=0;t<u.length;t++){for(var i=u[t],n=!0,a=1;a<i.length;a++){var o=i[a];0!==d[o]&&(n=!1)}n&&(u.splice(t--,1),e=r(r.s=i[0]))}return e}var i={},d={7:0},u=[];function r(e){if(i[e])return i[e].exports;var t=i[e]={i:e,l:!1,exports:{}};return l[e].call(t.exports,t,t.exports,r),t.l=!0,t.exports}r.m=l,r.c=i,r.d=function(e,t,i){r.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:i})},r.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},r.t=function(t,e){if(1&e&&(t=r(t)),8&e)return t;if(4&e&&"object"==typeof t&&t&&t.__esModule)return t;var i=Object.create(null);if(r.r(i),Object.defineProperty(i,"default",{enumerable:!0,value:t}),2&e&&"string"!=typeof t)for(var n in t)r.d(i,n,function(e){return t[e]}.bind(null,n));return i},r.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return r.d(t,"a",t),t},r.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},r.p="";var t=window.webpackJsonp=window.webpackJsonp||[],n=t.push.bind(t);t.push=e,t=t.slice();for(var a=0;a<t.length;a++)e(t[a]);var m=n;u.push([154,0]),s()}({154:function(e,t,i){"use strict";i.r(t);t=i(423);layui.use(["laydate","table","tree","flow","layer","form"],function(){var t=getKeyTime().startTime,i=getKeyTime().endTime;layui.laydate.render({elem:"#test6",range:!0,value:getKeyTime().keyTimeData,done:function(e){e=e.split(" - ");t=e[0],i=e[1]}});var e=sessionStorage.token,n=layui.flow,a=layui.layer,o=layui.table,r=(layui.form,layui.tree),c=sessionStorage.machineID,l=o.render({elem:"#moneyData",url:"".concat(vApi,"/order/getCodeOrder"),method:"post",contentType:"application/json",headers:{token:e},cols:[[{field:"activity_name",width:130,title:"活动名",align:"center"},{field:"good_code",width:180,title:"取货码",align:"center"},{field:"machineName",width:200,title:"售货机名",align:"center",templet:function(e){return"<div>".concat(e.machineName,"</div>\n                    <div>(").concat(e.machineNumber,")</div>")}},{field:"machineAddress",width:210,title:"终端地址",align:"center"},{field:"ship_info",width:250,title:"出货情况",align:"center",templet:function(e){if(0==e.ship_info.length)return"-";var i="";return e.ship_info.forEach(function(e,t){i+="<div>".concat(e.goods_Name,"(").concat(e.way,"货道").concat(0==e.ship_status?"出货失败":1==e.ship_status?"出货成功":"货道故障",")</div>")}),i}},{field:"operate_time",width:160,align:"center",title:"取货时间",templet:function(e){return e.operate_time?timeStamp(e.operate_time):"-"}},{field:"operate_time",width:100,title:"退货状态",align:"center",templet:function(e){return 0==e.refund?"未退货":"已退货"}},{field:"operation",width:100,title:"操作",toolbar:"#refundDemo",align:"center"}]],page:!0,loading:!0,request:{pageName:"pageNum",limitName:"pageSize"},where:{merchant_id:Number(c),start_time:t||null,end_time:i||null},parseData:function(e){return 200==e.code?{code:e.code,msg:e.message,count:e.data.total,data:e.data.list}:403!=e.code?{code:e.code,msg:e.message}:void(window.parent.location.href="login.html")},response:{statusCode:200},done:function(){}});function s(){n.load({elem:"#demo",isAuto:!0,scrollElem:"#demo",end:" ",done:function(t,n){setTimeout(function(){var i=[];n(i.join(""),t<1e3);var e=JSON.stringify({pageNum:t,pageSize:10,merchant_id:c});loadingAjax("/activity/getActivityList","post",e,sessionStorage.token).then(function(e){e.data.list.forEach(function(e,t){i.push('<span activityID="'.concat(e.id,'">').concat(e.activity_name,"</span>"))}),n(i.join(""),10<=e.data.list)}).catch(function(e){console.log(e),a.msg(e.message,{icon:7}),n(i.join(""),200==e.code)})},200)}})}s(),$(".queryBtn").click(function(){l.reload({where:{start_time:t||null,end_time:i||null}})});var d="";$("body").on("click",".activityArr span",function(){$(".allmachine").removeClass("active"),$(this).addClass("active").siblings().removeClass("active"),d=$(this).attr("activityID"),l.reload({where:{activity_id:Number(d)}})}),$(".allmachine").click(function(){$(this).addClass("active"),$(".activityArr span").removeClass("active"),d="",l.reload({where:{activity_id:null}})}),o.on("row(moneyData)",function(e){var t=e.data;console.log(e),1!=t.refund&&a.confirm("确定退货？",function(e){a.close(e);e=JSON.stringify({good_code:t.good_code});loadingAjax("/machine/activityRefund","post",e,sessionStorage.token).then(function(e){a.msg(e.message,{icon:1}),l.reload({where:{}})}).catch(function(e){a.msg(e.message,{icon:2})})})});var u,m,o=treeList();u="test1",m=o,r.render({elem:"#".concat(u),id:"treelist",showLine:!0,onlyIconControl:!0,data:m,spread:!0,text:{defaultNodeName:"无数据",none:"您没有权限，请联系管理员授权!"},click:function(e){e.data.title;for(var t=$("#".concat(u," .layui-tree-txt")),i=0;i<t.length;i++)t[i].innerHTML===e.data.title?t[i].style.color="#be954a":t[i].style.color="#555";c!=e.data.id&&(c=e.data.id,$("#demo").remove(),$(document).unbind(),$(".activityList1").append('<div class="activityArr" id="demo"></div>'),s(),$(".activityList1 span").removeClass("active"),$(".allmachine").addClass("active"),l.reload({where:{activity_id:null,merchant_id:c}}))}});sessionStorage.marchantName;$("body").on("click",".activityList1 span",function(){$(".allmachine").removeClass("active"),$(this).addClass("active").siblings().removeClass("active"),l.reload({where:{activity_id:$(this).attr("activityid")}})}),$(".allmachine").click(function(){$(this).addClass("active"),$(".machineList span").removeClass("active"),l.reload({where:{activity_id:null}})})})},423:function(e,t){}});