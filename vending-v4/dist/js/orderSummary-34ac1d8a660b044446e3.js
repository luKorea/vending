/*! 版权所有，翻版必究 */!function(c){function e(e){for(var t,n,i=e[0],a=e[1],o=e[2],r=0,s=[];r<i.length;r++)n=i[r],Object.prototype.hasOwnProperty.call(d,n)&&d[n]&&s.push(d[n][0]),d[n]=0;for(t in a)Object.prototype.hasOwnProperty.call(a,t)&&(c[t]=a[t]);for(f&&f(e);s.length;)s.shift()();return u.push.apply(u,o||[]),l()}function l(){for(var e,t=0;t<u.length;t++){for(var n=u[t],i=!0,a=1;a<n.length;a++){var o=n[a];0!==d[o]&&(i=!1)}i&&(u.splice(t--,1),e=r(r.s=n[0]))}return e}var n={},d={24:0},u=[];function r(e){if(n[e])return n[e].exports;var t=n[e]={i:e,l:!1,exports:{}};return c[e].call(t.exports,t,t.exports,r),t.l=!0,t.exports}r.m=c,r.c=n,r.d=function(e,t,n){r.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:n})},r.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},r.t=function(t,e){if(1&e&&(t=r(t)),8&e)return t;if(4&e&&"object"==typeof t&&t&&t.__esModule)return t;var n=Object.create(null);if(r.r(n),Object.defineProperty(n,"default",{enumerable:!0,value:t}),2&e&&"string"!=typeof t)for(var i in t)r.d(n,i,function(e){return t[e]}.bind(null,i));return n},r.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return r.d(t,"a",t),t},r.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},r.p="";var t=window.webpackJsonp=window.webpackJsonp||[],i=t.push.bind(t);t.push=e,t=t.slice();for(var a=0;a<t.length;a++)e(t[a]);var f=i;u.push([156,0]),l()}({156:function(e,t,n){"use strict";n.r(t);t=n(389);layui.use(["table","form","layer","tree","laydate"],function(){tooltip(".refreshBtnList",{transition:!0,time:200}),sessionStorage.classTag=sessionStorage.machineID;var e=layui.table,o=layui.layer,t=layui.tree,n=layui.laydate,r=sessionStorage.marchantName,s=sessionStorage.machineID,i=sessionStorage.token,c=getKeyTime().startTime,l=getKeyTime().endTime;n.render({elem:"#test6",range:!0,value:getKeyTime().keyTimeData,done:function(e){console.log(e);e=e.split(" - ");console.log(e),c=e[0],l=e[1]}});var a=e.render({elem:"#tableTest",url:"".concat(vApi,"/order/getOrderMerchant"),method:"post",contentType:"application/json",headers:{token:i},cols:[[{field:"info",width:220,title:"售货机名(编号)",align:"center",templet:function(e){return"<div>".concat(e.info,"</div>\n                      <div>(").concat(e.machineId,")</div>")}},{field:"number",width:190,title:"订单编号",align:"center"},{field:"number",width:130,title:"订单类型",align:"center",templet:function(e){return 0==e.mail?"售货机订单":"邮寄订单"}},{field:"amount",width:130,title:"订单金额(￥)",align:"center"},{field:"payStatus",width:130,align:"center",title:"支付状态",templet:function(e){return 1==e.payStatus?"等待支付":2==e.payStatus?"已支付":"未支付"}},{field:"time",width:180,title:"支付时间",align:"center",templet:function(e){return e.time?timeStamp(e.time):"-"}},{field:"bili",width:130,align:"center",title:"支付类型",templet:function(e){return 1==e.payType?"微信":0==e.payType?"支付宝":"工行支付"}},{field:"sign_name",width:150,title:"退款状态",align:"center",templet:function(e){var t=0,n=0;return e.goodsList.forEach(function(e){t+=e.count,n+=e.refund_count}),0==n?"未退款":t-n==0?"全部退款":"部分退款"}},{field:"shipStatus",width:150,title:"出货状态",align:"center",templet:function(e){return 0==e.mail?0==e.shipStatus?"未出货":1==e.shipStatus?"部分出货失败":"全部出货成功":"-"}},{field:"ship_info",width:200,title:"出货详情",align:"center",templet:function(e){if(0==e.ship_info.length)return"-";var n="";return e.ship_info.forEach(function(e,t){n+="<div>".concat(e.goods_Name,"(").concat(e.way,"货道").concat(0==e.ship_status?"出货失败":1==e.ship_status?"出货成功":"货道故障",")</div>")}),n}},{field:"ship_info",width:200,title:"邮寄信息",align:"center",templet:function(e){return 1==e.mail?"\n                                <div>收货人:".concat(e.sign_name,"</div>\n                                <div>收货人电话:").concat(e.sign_phone,"</div>\n                                <div>s收货地址:").concat(e.sign_address,"</div>\n                                <div>快递/物流状态:").concat(0==e.dispatch_status?"未发货":1==e.dispatch_status?"已发货":"已收货","</div>\n                                <div>快递/物流公司:").concat(e.express_type||"-","</div>\n                                <div>快递/物流单号:").concat(e.express_number||"-","</div>\n                               "):"-"}},{field:"sales_no",width:160,title:"销售经理",align:"center",templet:function(e){return e.sales_no||"-"}},{field:"payee",width:160,title:"收款方",align:"center"}]],id:"tableId",page:!0,loading:!0,request:{pageName:"pageNum",limitName:"pageSize"},where:{merchant_id:s,startTime:c,endTime:l},parseData:function(e){return 200==e.code?{code:e.code,msg:"",count:e.data.total,data:e.data.list}:403!=e.code?{code:e.code,msg:e.message}:void(window.parent.location.href="login.html")},response:{statusCode:200},done:function(e){e.data,f(),405==e.code&&$(".hangContent").show()}});layui.form;$(".playHeader .close").click(function(){$(this).parent().parent().addClass("margin0"),$(this).parents(".maskContnet").fadeOut()});var d=treeList();p(t,"testGoods",d),$(".refreshBtnList").click(function(){var e=treeList();JSON.stringify(e)!=JSON.stringify(d)&&(p(t,"testGoods",d=e),a.reload({where:{merchant_id:sessionStorage.machineID}})),o.msg("已刷新",{icon:1})}),$(".sidebar i").click(function(){$(".left-mian").hide(),$(".on-left").show()}),$(".on-left").click(function(){$(".left-mian").show(),$(".on-left").hide()}),$("body").bind("keydown",function(e){116==e.keyCode&&f5Fun()});var u=!1;function f(){u?$(".pushBtn").removeClass("hide"):$(".pushBtn").addClass("hide")}function p(e,i,t){e.render({elem:"#".concat(i),id:"treelist",showLine:!0,onlyIconControl:!0,data:t,spread:!0,text:{defaultNodeName:"无数据",none:"您没有权限，请联系管理员授权!"},click:function(e){console.log(e),r=e.data.title;for(var t=$("#".concat(i," .layui-tree-txt")),n=0;n<t.length;n++)t[n].innerHTML===e.data.title?t[n].style.color="#be954a":t[n].style.color="#555";s!=e.data.id&&(s=e.data.id,a.reload({where:{merchant_id:s}}))}})}permissionsVal(464).then(function(e){u=e.addFlag,f()}).catch(function(e){o.msg("服务器请求超时",{icon:7})}),$(".pushBtn").click(function(){var a;c&&l?timeFlag(c,l)?o.msg("时间选择范围最多三个月",{icon:7}):($(".mask").fadeIn(),$(".maskSpan").addClass("maskIcon"),new Date,(a=new XMLHttpRequest).open("GET","".concat(vApi,"/complete?startDate=").concat(c,"&endDate=").concat(l,"&merchant_id=").concat(s),!0),a.setRequestHeader("token",sessionStorage.token),a.responseType="blob",a.onload=function(e){var t,n,i;200==a.status?($(".mask").fadeOut(),$(".maskSpan").removeClass("maskIcon"),i=a.response,t="".concat(r,"订单汇总(").concat(c,"-").concat(l,").xls"),(n=document.createElement("a")).download=t,n.style.display="none",i=new Blob([i]),n.href=URL.createObjectURL(i),document.body.appendChild(n),n.click(),document.body.removeChild(n)):($(".mask").fadeOut(),$(".maskSpan").removeClass("maskIcon"),o.msg("服务器请求超时",{icon:2}))},sessionStorage.machineID,a.send()):o.msg("请选择时间",{icon:7})}),$(".queryBtn").click(function(){timeFlag(c,l)?o.msg("时间选择范围最多三个月",{icon:7}):a.reload({where:{startTime:c,endTime:l}})})})}});