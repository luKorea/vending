/*! 版权所有，翻版必究 */!function(d){function e(e){for(var a,t,i=e[0],p=e[1],n=e[2],y=0,o=[];y<i.length;y++)t=i[y],Object.prototype.hasOwnProperty.call(r,t)&&r[t]&&o.push(r[t][0]),r[t]=0;for(a in p)Object.prototype.hasOwnProperty.call(p,a)&&(d[a]=p[a]);for(s&&s(e);o.length;)o.shift()();return l.push.apply(l,n||[]),c()}function c(){for(var e,a=0;a<l.length;a++){for(var t=l[a],i=!0,p=1;p<t.length;p++){var n=t[p];0!==r[n]&&(i=!1)}i&&(l.splice(a--,1),e=y(y.s=t[0]))}return e}var t={},r={24:0},l=[];function y(e){if(t[e])return t[e].exports;var a=t[e]={i:e,l:!1,exports:{}};return d[e].call(a.exports,a,a.exports,y),a.l=!0,a.exports}y.m=d,y.c=t,y.d=function(e,a,t){y.o(e,a)||Object.defineProperty(e,a,{enumerable:!0,get:t})},y.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},y.t=function(a,e){if(1&e&&(a=y(a)),8&e)return a;if(4&e&&"object"==typeof a&&a&&a.__esModule)return a;var t=Object.create(null);if(y.r(t),Object.defineProperty(t,"default",{enumerable:!0,value:a}),2&e&&"string"!=typeof a)for(var i in a)y.d(t,i,function(e){return a[e]}.bind(null,i));return t},y.n=function(e){var a=e&&e.__esModule?function(){return e.default}:function(){return e};return y.d(a,"a",a),a},y.o=function(e,a){return Object.prototype.hasOwnProperty.call(e,a)},y.p="";var a=window.webpackJsonp=window.webpackJsonp||[],i=a.push.bind(a);a.push=e,a=a.slice();for(var p=0;p<a.length;p++)e(a[p]);var s=i;l.push([148,0]),c()}({148:function(e,a,t){"use strict";t.r(a);a=t(410);layui.use(["table","form","layer","tree"],function(){tooltip(".refreshBtnList",{transition:!0,time:200});var e=layui.table,p=layui.layer,p=layui.layer,a=(layui.util,layui.tree),n=layui.form,t=null,y=e.render({elem:"#payList",url:"".concat(vApi,"/pay/getPayParam"),method:"post",contentType:"application/json",headers:{token:sessionStorage.token},cols:[[{field:"1",width:80,title:"",templet:"#imgtmp",event:"rank",align:"center"},{field:"rank",width:80,title:"排序",align:"center"},{field:"payName",width:180,title:"支付类型",align:"center"},{field:"app_id",width:300,title:"微信公众号id/支付宝商户id",align:"center"},{field:"merchantName",width:250,title:"所属商户",align:"center"},{field:"payee",width:280,title:"收款方",align:"center"},{field:"update_user",width:200,title:"最后修改人",align:"center"},{field:"update_time",width:250,title:"最后修改时间",align:"center",templet:function(e){return e.update_time?timeStamp(e.update_time):"-"}},{field:"operation",right:0,width:150,title:"操作",toolbar:"#barDemo",fixed:"right"}]],id:"tablePayId",loading:!0,request:{pageName:"pageNum",limitName:"pageSize"},where:{merchantId:Number(sessionStorage.machineID)},parseData:function(e){return 200==e.code?{code:e.code,msg:e.message,count:e.data.total,data:e.data}:{code:e.code,msg:e.message}},response:{statusCode:200},done:function(e){t=e.data,403==e.code&&(window.parent.location.href="login.html")}});$(".refreshBtn").click(function(){location.reload()}),$("body").bind("keydown",function(e){116==e.keyCode&&f5Fun()}),$(".playHeader .close").click(function(){$(this).parent().parent().addClass("margin0"),$(this).parents(".maskContnet").fadeOut()});var o=null;e.on("tool(payList)",function(e){o=e.data,console.log(o),"edit"==e.event?("微信"==o.payName?($(".changePay .WeChat").show(),$(".changePay .Alipay").hide(),$(".changePay .IcbcPay").hide()):"支付宝"==o.payName?($(".changePay .WeChat").hide(),$(".changePay .IcbcPay").hide(),$(".changePay .Alipay").show()):3==o.payType?($(".changePay .IcbcPay").show(),$(".changePay .WeChat").hide(),$(".changePay .Alipay").hide()):($(".changePay .WeChat").hide(),$(".changePay .Alipay").hide(),$(".changePay .IcbcPay").hide()),n.val("SetPay",{typeIndex:o.payType,payee:o.payee,officialId:"微信"==o.payName?o.app_id:"",MerchantsId:"微信"==o.payName?o.mchId:"",app_key:"微信"==o.payName?o.app_key:"",MerchantsKey:"微信"==o.payName?o.app_private_key:"",aliPayId:"支付宝"==o.payName?o.app_id:"",alipay_public_key:"支付宝"==o.payName?o.alipay_public_key:"",app_private_key:"支付宝"==o.payName?o.app_private_key:"",mchId:3==o.payType?o.mchId:"",app_id:3==o.payType?o.app_id:"",ICBC_app_key:3==o.payType?o.app_key:"",ICBC_alipay_public_key:3==o.payType?o.alipay_public_key:"",ICBC_app_private_key:3==o.payType?o.app_private_key:""}),popupShow("changePay","changeBox")):"del"==e.event?p.confirm("确定删除？",function(e){p.close(e);e=JSON.stringify({merchantId:Number(d),id:o.id});loadingAjax("/pay/deletePayParam","post",e,sessionStorage.token,"","","",p).then(function(e){p.msg(e.message,{icon:1}),y.reload({where:{}})}).catch(function(e){p.msg(e.message,{icon:2})})}):"rank"==e.event&&1!=e.data.rank&&(console.log(e),console.log(t),e=JSON.stringify({merchantId:Number(d),topId:e.data.id,bottomId:t[e.data.rank-2].id}),loadingAjax("/pay/sortPayParam","post",e,sessionStorage.token,"","","",p).then(function(e){p.msg("修改成功",{icon:1}),y.reload({where:{}})}).catch(function(e){console.log(res),p.msg("修改失败",{icon:1})}))}),$(".changeBody .cancel_btn").click(function(){popupHide("changePay","changeBox")}),$(".changeBody .submit_btn").click(function(){var t=n.val("SetPay");if("2"==t.typeIndex){if(!(t.payee&&t.officialId&&t.MerchantsId&&t.app_key&&t.MerchantsKey))return void p.msg("带*为必填",{icon:7})}else if("1"==t.typeIndex){if(!(t.payee&&t.aliPayId&&t.alipay_public_key&&t.app_private_key))return void p.msg("带*为必填",{icon:7})}else if("3"==t.typeIndex){if(!(t.payee&&t.mchId&&t.app_id&&t.ICBC_app_key&&t.ICBC_alipay_public_key&&t.ICBC_app_private_key))return void p.msg("带*为必填",{icon:7})}else if(!t.payee||!t.aliPayId)return void p.msg("带*为必填",{icon:7});if($(".mask").fadeIn(),$(".maskSpan").addClass("maskIcon"),2==t.typeIndex)var e=JSON.stringify({app_id:t.officialId,mchId:t.MerchantsId,app_key:t.app_key}),a="/pay/testWxPay";else if(1==t.typeIndex)e=JSON.stringify({app_id:t.aliPayId,app_private_key:t.app_private_key,alipay_public_key:t.alipay_public_key}),a="/pay/testAliPay";else if(3==t.typeIndex){var i=JSON.stringify({alipay_public_key:t.ICBC_alipay_public_key,mchId:t.mchId,app_id:t.app_id,app_key:t.ICBC_app_key,app_private_key:t.ICBC_app_private_key});return void loadingAjax("/pay/testICBCPay","post",i,sessionStorage.token,"mask","","",p).then(function(e){var a=JSON.stringify({merchantId:d,id:o.id,payee:t.payee,payType:t.typeIndex,alipay_public_key:t.ICBC_alipay_public_key,mchId:t.mchId,app_id:t.app_id,app_key:t.ICBC_app_key,app_private_key:t.ICBC_app_private_key});loadingAjax("/pay/updatePayParam","post",a,sessionStorage.token,"mask","changePay","changeBox",p).then(function(e){p.msg(e.message,{icon:1}),y.reload({where:{}}),n.val("addPay",{typeIndex:"",payee:"",alipay_public_key:"",mchId:"",app_id:"",app_key:"",app_private_key:""})}).catch(function(e){p.msg(e.message,{icon:2})})}).catch(function(e){p.msg(e.message,{icon:2})})}loadingAjax(a,"post",e,sessionStorage.token,"mask","","",p).then(function(e){var a=JSON.stringify({merchantId:d,id:o.id,payee:t.payee,payType:t.typeIndex,app_id:"2"==t.typeIndex?t.officialId:t.aliPayId,app_key:"2"==t.typeIndex?t.app_key:"",mchId:"2"==t.typeIndex?t.MerchantsId:"",alipay_public_key:"1"==t.typeIndex?t.alipay_public_key:"",app_private_key:"1"==t.typeIndex?t.app_private_key:t.MerchantsKey});loadingAjax("/pay/updatePayParam","post",a,sessionStorage.token,"mask","changePay","changeBox",p).then(function(e){p.msg(e.message,{icon:1}),y.reload({where:{}}),n.val("SetPay",{typeIndex:"",payee:"",officialId:"",MerchantsId:"",app_key:"",aliPayId:"",alipay_public_key:"",app_private_key:""})}).catch(function(e){p.msg(e.message,{icon:2})})}).catch(function(e){p.msg(e.message,{icon:2})})});var d=sessionStorage.machineID,i=treeList();a.render({elem:"#test1",id:"treelist",showLine:!0,onlyIconControl:!0,data:i,spread:!0,text:{defaultNodeName:"无数据",none:"您没有权限，请联系管理员授权!"},click:function(e){console.log(e),y.reload({where:{merchantId:e.data.id}}),d=e.data.id;for(var a=$("#test1 .layui-tree-txt"),t=0;t<a.length;t++)a[t].innerHTML===e.data.title?a[t].style.color="#be954a":a[t].style.color="#555"}}),$(".sidebar i").click(function(){$(".left-mian").hide(),$(".onLeft").show()}),$(".onLeft").click(function(){$(".left-mian").show(),$(".onLeft").hide()});e=JSON.stringify({status:1});loadingAjax("/pay/getAllPayType","post",e,sessionStorage.token).then(function(e){console.log(e);var t='<option value="">请选择</option>';e.data.forEach(function(e,a){1==e.status&&(t+='<option value="'.concat(e.id,'">').concat(e.name,"</option>"))}),$("#editTypeSelect").html(t),$("#addTypeSelect").html(t),n.render("select")}).catch(function(e){}),$(".addBtnClick").click(function(){popupShow("addePay","addBox")});n.on("select(addSelect)",function(e){console.log(e.value),1==e.value?($(".addePay .WeChat").hide(),$(".addePay .IcbcPay").hide(),$(".addePay .Alipay").show()):2==e.value?($(".addePay .WeChat").show(),$(".addePay .Alipay").hide(),$(".addePay .IcbcPay").hide()):(3==e.value?$(".addePay .IcbcPay").show():$(".addePay .IcbcPay").hide(),$(".addePay .WeChat").hide(),$(".addePay .Alipay").hide())}),$(".addePay .submit_btn").click(function(){var t=n.val("addPay");if("2"==t.typeIndex){if(!(t.payee&&t.officialId&&t.MerchantsId&&t.app_key&&t.MerchantsKey))return void p.msg("带*为必填",{icon:7})}else if("1"==t.typeIndex){if(!(t.payee&&t.aliPayId&&t.alipay_public_key&&t.app_private_key))return void p.msg("带*为必填",{icon:7})}else if("3"==t.typeIndex){if(!(t.payee&&t.mchId&&t.app_id&&t.ICBC_app_key&&t.ICBC_alipay_public_key&&t.ICBC_app_private_key))return void p.msg("带*为必填",{icon:7})}else if(!t.payee||!t.typeIndex)return void p.msg("带*为必填",{icon:7});if($(".mask").fadeIn(),$(".maskSpan").addClass("maskIcon"),2!=t.typeIndex&&1!=t.typeIndex&&3!=t.typeIndex&&(i=JSON.stringify({merchantId:d,payee:t.payee,payType:t.typeIndex}),loadingAjax("/pay/newPayParam","post",i,sessionStorage.token,"mask","addePay","addBox",p).then(function(e){p.msg(e.message,{icon:1}),y.reload({where:{}}),n.val("addPay",{typeIndex:"",payee:"",officialId:"",MerchantsId:"",app_key:"",aliPayId:"",alipay_public_key:"",app_private_key:"",MerchantsKey:""})}).catch(function(e){console.log(e),p.msg(e.message,{icon:2})})),2==t.typeIndex)var e=JSON.stringify({app_id:t.officialId,mchId:t.MerchantsId,app_key:t.app_key}),a="/pay/testWxPay";else if(1==t.typeIndex)e=JSON.stringify({app_id:t.aliPayId,app_private_key:t.app_private_key,alipay_public_key:t.alipay_public_key}),a="/pay/testAliPay";else if(3==t.typeIndex){var i=JSON.stringify({alipay_public_key:t.ICBC_alipay_public_key,mchId:t.mchId,app_id:t.app_id,app_key:t.ICBC_app_key,app_private_key:t.ICBC_app_private_key});return void loadingAjax("/pay/testICBCPay","post",i,sessionStorage.token,"mask","","",p).then(function(e){var a=JSON.stringify({merchantId:d,payee:t.payee,payType:t.typeIndex,alipay_public_key:t.ICBC_alipay_public_key,mchId:t.mchId,app_id:t.app_id,app_key:t.ICBC_app_key,app_private_key:t.ICBC_app_private_key});loadingAjax("/pay/newPayParam","post",a,sessionStorage.token,"mask","addePay","addBox",p).then(function(e){p.msg(e.message,{icon:1}),y.reload({where:{}}),n.val("addPay",{typeIndex:"",payee:"",ICBC_alipay_public_key:"",mchId:"",app_id:"",ICBC_app_key:"",ICBC_app_private_key:""})}).catch(function(e){p.msg(e.message,{icon:2})})}).catch(function(e){p.msg(e.message,{icon:2})})}loadingAjax(a,"post",e,sessionStorage.token,"mask","","",p).then(function(e){var a=JSON.stringify({merchantId:d,payee:t.payee,payType:t.typeIndex,app_id:"2"==t.typeIndex?t.officialId:t.aliPayId,app_key:"2"==t.typeIndex?t.app_key:"",mchId:"2"==t.typeIndex?t.MerchantsId:"",alipay_public_key:"1"==t.typeIndex?t.alipay_public_key:"",app_private_key:"1"==t.typeIndex?t.app_private_key:t.MerchantsKey});loadingAjax("/pay/newPayParam","post",a,sessionStorage.token,"mask","addePay","addBox",p).then(function(e){p.msg(e.message,{icon:1}),y.reload({where:{}}),n.val("addPay",{typeIndex:"",payee:"",officialId:"",MerchantsId:"",app_key:"",aliPayId:"",alipay_public_key:"",app_private_key:"",MerchantsKey:""})}).catch(function(e){p.msg(e.message,{icon:2})})}).catch(function(e){p.msg(e.message,{icon:2})})}),$(".addePay .cancel_btn").click(function(){popupHide("addePay","addBox")}),$(".refreshBtnList").click(function(){var e=treeList();JSON.stringify(e)!=JSON.stringify(i)?(i=e,a.reload("treelist",{data:i}),y.reload({where:{merchantId:Number(sessionStorage.machineID)}})):p.msg("已刷新",{icon:1})})})},410:function(e,a){}});