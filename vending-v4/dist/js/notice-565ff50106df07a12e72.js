/*! 版权所有，翻版必究 */!function(c){function t(t){for(var e,n,a=t[0],o=t[1],i=t[2],s=0,d=[];s<a.length;s++)n=a[s],Object.prototype.hasOwnProperty.call(l,n)&&l[n]&&d.push(l[n][0]),l[n]=0;for(e in o)Object.prototype.hasOwnProperty.call(o,e)&&(c[e]=o[e]);for(p&&p(t);d.length;)d.shift()();return u.push.apply(u,i||[]),r()}function r(){for(var t,e=0;e<u.length;e++){for(var n=u[e],a=!0,o=1;o<n.length;o++){var i=n[o];0!==l[i]&&(a=!1)}a&&(u.splice(e--,1),t=s(s.s=n[0]))}return t}var n={},l={22:0},u=[];function s(t){if(n[t])return n[t].exports;var e=n[t]={i:t,l:!1,exports:{}};return c[t].call(e.exports,e,e.exports,s),e.l=!0,e.exports}s.m=c,s.c=n,s.d=function(t,e,n){s.o(t,e)||Object.defineProperty(t,e,{enumerable:!0,get:n})},s.r=function(t){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})},s.t=function(e,t){if(1&t&&(e=s(e)),8&t)return e;if(4&t&&"object"==typeof e&&e&&e.__esModule)return e;var n=Object.create(null);if(s.r(n),Object.defineProperty(n,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var a in e)s.d(n,a,function(t){return e[t]}.bind(null,a));return n},s.n=function(t){var e=t&&t.__esModule?function(){return t.default}:function(){return t};return s.d(e,"a",e),e},s.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},s.p="";var e=window.webpackJsonp=window.webpackJsonp||[],a=e.push.bind(e);e.push=t,e=e.slice();for(var o=0;o<e.length;o++)t(e[o]);var p=a;u.push([146,0]),r()}({146:function(t,e,n){"use strict";n.r(e);e=n(407);layui.use(["table","form","layer"],function(){var t=layui.table,e=layui.form,a=layui.layer,o=sessionStorage.token,n=t.render({elem:"#noticeTable",method:"post",url:"".concat(vApi,"/notices/getNoticeList"),contentType:"application/json",headers:{token:sessionStorage.token},cols:[[{field:"n_number",width:200,title:"公告编号",align:"center"},{field:"title",width:210,title:"标题",align:"center"},{field:"isShow",width:135,title:"是否首页展示",align:"center",templet:function(t){return 1==t.is_show?"是":"否"}},{field:"status",width:130,title:"状态",align:"center",templet:function(t){return 1==t.n_status?"已发布":"草稿箱"}},{field:"attach_name",width:150,title:"附件名",align:"center",templet:function(t){return t.attach_name||"-"}},{field:"attach_url",width:320,title:"附件地址",align:"center",templet:function(t){return t.attach_url||"-"}},{field:"create_user",width:130,title:"创建人",align:"center"},{field:"create_time",width:180,title:"创建时间",align:"center",templet:function(t){return timeStamp(t.create_time)}},{field:"operation",width:180,title:"操作",align:"center",toolbar:"#barDemo"}]],id:"noticeId",page:!0,loading:!0,request:{pageName:"pageNum",limitName:"pageSize"},where:{},parseData:function(t){return 200==t.code?{code:t.code,msg:t.message,count:t.data.total,data:t.data.list}:403!=t.code?{code:t.code,msg:t.message}:void(window.parent.location.href="login.html")},response:{statusCode:200},done:function(){}});$(".playHeader .close").click(function(){$(this).parent().parent().addClass("margin0"),$(this).parents(".maskContnet").fadeOut()}),$("body").bind("keydown",function(t){116==t.keyCode&&f5Fun()}),$(".refreshBtn").click(function(){location.reload()}),$(".addPushBtn").click(function(){popupShow("addEditCont","modificationBox")}),$(".addEditCont .cancelBtn").click(function(){popupHide("addEditCont","modificationBox")}),$('.addUploadBtn input[name="addUpload"]').change(function(t){var e,n;$(this).val()&&(e=this,(n=new FormData).append("file",t.target.files[0]),$(".mask").fadeIn(),$(".maskSpan").addClass("maskIcon"),$.ajax({type:"post",url:"".concat(vApi,"/fileUpload"),processData:!1,contentType:!1,timeout:1e4,headers:{token:o},data:n,success:function(t){$(".mask").fadeOut(),$(".maskSpan").removeClass("maskIcon"),$(e).val(""),0==t.code?(a.msg("上传成功",{icon:1}),$('.addEditCont input[name="address"]').val(t.data.src)):a.msg(t.message,{icon:7})},error:function(){$(e).val(""),$(".mask").fadeOut(),$(".maskSpan").removeClass("maskIcon"),a.msg("上传失败",{icon:2})}}))}),$(".addEditCont .delUploadBtn").click(function(){a.confirm("确定删除附件？",function(t){a.close(t),$('.addEditCont input[name="address"]').val(""),a.msg("已删除",{icon:1})})});var i=window.wangEditor,s=new i("#addWangEditor");s.customConfig.customUploadImg=function(t,e){console.log(t);var n=new FormData;n.append("file",t[0]),$.ajax({type:"post",url:"".concat(vApi,"/fileUpload"),processData:!1,contentType:!1,timeout:1e4,headers:{token:o},data:n,success:function(t){0==t.code?e(t.data.src):a.msg(t.message,{icon:7})},error:function(){a.msg("上传失败",{icon:2})}})},s.create(),$(".addEditCont .readingBtn").click(function(){$(".previewContent .playHeader span").html("公告详情"),$(".previewContent .previewHtml").html(s.txt.html()),popupShow("previewContent","previewBox")}),$(".addEditCont .determinePushBtn").click(function(){var t,e=this;$('.addEditCont input[name="title"]').val()&&$('.addEditCont input[name="number"]').val()?11<s.txt.html().length?$('.addEditCont input[name="accessoryName"]').val()&&$('.addEditCont input[name="address"]').val()||!$('.addEditCont input[name="accessoryName"]').val()&&!$('.addEditCont input[name="address"]').val()?($(".mask").fadeIn(),$(".maskSpan").addClass("maskIcon"),t=JSON.stringify({n_number:$('.addEditCont input[name="number"]').val(),title:$('.addEditCont input[name="title"]').val(),content:s.txt.html(),isShow:Number($('.addEditCont input[name="indexShow"]:checked').val()),status:Number($(this).attr("pushType")),attach_name:$('.addEditCont input[name="accessoryName"]').val(),attach_url:$('.addEditCont input[name="address"]').val(),merchantId:sessionStorage.machineID}),loadingAjax("/notices/addNotice","post",t,sessionStorage.token,"mask","addEditCont","modificationBox",a).then(function(t){a.msg(t.message,{icon:1}),n.reload({where:{}}),1==$(e).attr("pushType")&&1==$('.addEditCont input[name="indexShow"]:checked').val()&&loadingAjax("/pushNotice","post","",sessionStorage.token).then(function(t){}).catch(function(t){}),window.parent.shuffling(),console.log($(e).attr("pushType")),console.log($('.addEditCont input[name="indexShow"]:checked').val()),$('.addEditCont input[name="number"]').val(""),$('.addEditCont input[name="title"]').val(""),s.txt.html(""),$('.addEditCont input[name="accessoryName"]').val(""),$('.addEditCont input[name="address"]').val("")}).catch(function(t){console.log(t),a.msg(t.message,{icon:2})})):a.msg("附近名与附件地址必须同时填写"):a.msg("公告详情最少五个字",{icon:7}):a.msg("带*号为必填",{icon:7})});var d=new i("#editWangEditor");d.customConfig.customUploadImg=function(t,e){console.log(t);var n=new FormData;n.append("file",t[0]),$.ajax({type:"post",url:"".concat(vApi,"/fileUpload"),processData:!1,contentType:!1,timeout:1e4,headers:{token:o},data:n,success:function(t){0==t.code?e(t.data.src):a.msg(t.message,{icon:7})},error:function(){a.msg("上传失败",{icon:2})}})},d.create();var c=null;t.on("tool(noticeTable)",function(t){c=t.data,console.log(c),"preview"==t.event?($(".previewContent .playHeader span").html(t.data.title+"的公告详情"),$(".previewContent .previewHtml").html(t.data.content),popupShow("previewContent","previewBox")):"edit"==t.event?($('.EditCont input[name="number"]').val(c.n_number),$('.EditCont input[name="title"]').val(c.title),$('.EditCont input[name="indexShow"][value=1]').prop("checked",1==c.is_show),$('.EditCont input[name="indexShow"][value=0]').prop("checked",0==c.is_show),$('.EditCont input[name="accessoryName"]').val(c.attach_name),$('.EditCont input[name="address"]').val(c.attach_url),d.txt.html(c.content),e.render("radio"),popupShow("EditCont","editBox")):"dow"==t.event&&a.confirm(1==c.is_show?"确定隐藏？":"确定展示？",function(t){a.close(t);t=JSON.stringify({n_number:c.n_number,title:c.title,content:c.content,is_show:1==c.is_show?0:1,n_status:c.n_status,attach_name:c.attach_name,attach_url:c.attach_url,merchantId:sessionStorage.machineID,id:c.id});loadingAjax("/notices/updateNotice","post",t,sessionStorage.token,"mask","EditCont","editBox",a).then(function(t){a.msg(t.message,{icon:1}),n.reload({where:{}}),loadingAjax("/pushNotice","post","",sessionStorage.token).then(function(t){}).catch(function(t){})}).catch(function(t){console.log(t),a.msg(t.message,{icon:2})})})}),$(".EditCont .readingBtn").click(function(){$(".previewContent .playHeader span").html(c.title+"的公告详情"),$(".previewContent .previewHtml").html(d.txt.html()),popupShow("previewContent","previewBox")}),$(".EditCont .cancelBtn").click(function(){popupHide("EditCont","editBox")}),$(".EditCont .editDelUploadBtn").click(function(){a.confirm("确定删除附件？",function(t){a.close(t),$('.EditCont input[name="address"]').val("")})}),$('.EditCont .editUploadBtn input[name="editUpload"]').change(function(t){var e,n;$(this).val()&&(e=this,(n=new FormData).append("file",t.target.files[0]),$(".mask").fadeIn(),$(".maskSpan").addClass("maskIcon"),$.ajax({type:"post",url:"".concat(vApi,"/fileUpload"),processData:!1,contentType:!1,timeout:1e4,headers:{token:o},data:n,success:function(t){$(".mask").fadeOut(),$(".maskSpan").removeClass("maskIcon"),$(e).val(""),0==t.code?(a.msg("上传成功"),$('.EditCont input[name="address"]').val(t.data.src)):a.msg(t.message,{icon:7})},error:function(){$(e).val(""),$(".mask").fadeOut(),$(".maskSpan").removeClass("maskIcon"),a.msg("上传失败",{icon:2})}}))}),$(".EditCont .determinePushBtn").click(function(){var t,e=this;$('.EditCont input[name="title"]').val()&&$('.EditCont input[name="number"]').val()?11<!s.txt.html().length?a.msg("公告详情最少五个字",{icon:7}):$('.EditCont input[name="accessoryName"]').val()&&$('.EditCont input[name="address"]').val()||!$('.EditCont input[name="accessoryName"]').val()&&!$('.EditCont input[name="address"]').val()?(console.log($('.addEditCont input[name="push"]:checked').val()),t=JSON.stringify({n_number:$('.EditCont input[name="number"]').val(),title:$('.EditCont input[name="title"]').val(),content:d.txt.html(),is_show:Number($('.EditCont input[name="indexShow"]:checked').val()),n_status:Number($(this).attr("pushType")),attach_name:$('.EditCont input[name="accessoryName"]').val(),attach_url:$('.EditCont input[name="address"]').val(),merchantId:sessionStorage.machineID,id:c.id}),loadingAjax("/notices/updateNotice","post",t,sessionStorage.token,"mask","EditCont","editBox",a).then(function(t){a.msg(t.message,{icon:1}),n.reload({where:{}}),1==$(e).attr("pushType")&&loadingAjax("/pushNotice","post","",sessionStorage.token).then(function(t){}).catch(function(t){})}).catch(function(t){console.log(t),a.msg(t.message,{icon:2})})):a.msg("附近名与附件地址必须同时填写"):a.msg("带*号为必填",{icon:7})}),$(".queryBtn").click(function(){n.reload({where:{keyword:$('.key-contnet input[name="keyMerchants"]').val()}})})})},407:function(t,e){}});