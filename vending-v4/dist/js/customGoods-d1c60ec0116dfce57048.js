/*! 版权所有，翻版必究 */!function(l){function e(e){for(var o,t,a=e[0],n=e[1],i=e[2],d=0,s=[];d<a.length;d++)t=a[d],Object.prototype.hasOwnProperty.call(c,t)&&c[t]&&s.push(c[t][0]),c[t]=0;for(o in n)Object.prototype.hasOwnProperty.call(n,o)&&(l[o]=n[o]);for(m&&m(e);s.length;)s.shift()();return g.push.apply(g,i||[]),r()}function r(){for(var e,o=0;o<g.length;o++){for(var t=g[o],a=!0,n=1;n<t.length;n++){var i=t[n];0!==c[i]&&(a=!1)}a&&(g.splice(o--,1),e=d(d.s=t[0]))}return e}var t={},c={9:0},g=[];function d(e){if(t[e])return t[e].exports;var o=t[e]={i:e,l:!1,exports:{}};return l[e].call(o.exports,o,o.exports,d),o.l=!0,o.exports}d.m=l,d.c=t,d.d=function(e,o,t){d.o(e,o)||Object.defineProperty(e,o,{enumerable:!0,get:t})},d.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},d.t=function(o,e){if(1&e&&(o=d(o)),8&e)return o;if(4&e&&"object"==typeof o&&o&&o.__esModule)return o;var t=Object.create(null);if(d.r(t),Object.defineProperty(t,"default",{enumerable:!0,value:o}),2&e&&"string"!=typeof o)for(var a in o)d.d(t,a,function(e){return o[e]}.bind(null,a));return t},d.n=function(e){var o=e&&e.__esModule?function(){return e.default}:function(){return e};return d.d(o,"a",o),o},d.o=function(e,o){return Object.prototype.hasOwnProperty.call(e,o)},d.p="";var o=window.webpackJsonp=window.webpackJsonp||[],a=o.push.bind(o);o.push=e,o=o.slice();for(var n=0;n<o.length;n++)e(o[n]);var m=a;g.push([136,0]),r()}({136:function(e,o,t){"use strict";t.r(o);o=t(387);layui.use(["table","form","layer","layedit","tree"],function(){tooltip(".refreshBtnList",{transition:!0,time:200});var g=layui.jquery,o=layui.tree;g(".sidebar i").click(function(){g(".left-mian").hide(),g(".on-left").show()}),g(".on-left").click(function(){g(".left-mian").show(),g(".on-left").hide()});var i=layui.table,e=window.wangEditor,a=sessionStorage.token+"",n=i.render({elem:"#tableTest",url:"".concat(vApi,"/goods/findAll"),method:"post",contentType:"application/json",headers:{token:a},cols:[[{checkbox:!0},{field:"goods_images",width:100,title:"图片",templet:"#imgtmp",align:"center"},{field:"goods_Core",width:180,title:"商品编号",align:"center"},{field:"goods_Name",width:200,title:"商品名",color:"#409eff",align:"center",templet:function(e){return 1==e.mail?"(邮寄)"+e.goods_Name:e.goods_Name}},{field:"mail",width:120,title:"是否邮寄商品",align:"center",templet:function(e){return 0==e.mail?"否":"是"}},{field:"goods_Status",width:120,title:"商品状态",align:"center",templet:function(e){return 1==e.goods_Status?"启用":"不启用"}},{field:"classifyName",width:120,title:"商品类目",align:"center"},{field:"goods_Price",width:120,align:"center",title:"销售价 ",templet:function(e){var o=e.goods_Price;if(e.goods_Price=Number(Number(e.goods_Price).toFixed(2)),isNaN(e.goods_Price))return o;o=-1!==e.goods_Price.toString().indexOf(".")?e.goods_Price.toLocaleString():e.goods_Price.toString().replace(/(\d)(?=(?:\d{3})+$)/g,"$1,"),e=o.split(".");return 1==e.length?o+=".00":1==e[1].length&&(o+="0"),o}},{field:"goods_Cost",width:120,align:"center",title:"成本价 ",templet:function(e){var o=e.goods_Cost;if(e.goods_Cost=Number(Number(e.goods_Cost).toFixed(2)),isNaN(e.goods_Cost))return o;o=-1!==e.goods_Cost.toString().indexOf(".")?e.goods_Cost.toLocaleString():e.goods_Cost.toString().replace(/(\d)(?=(?:\d{3})+$)/g,"$1,"),e=o.split(".");return 1==e.length?o+=".00":1==e[1].length&&(o+="0"),o}},{field:"goods_Param",width:120,title:"规格说明 ",align:"center"},{field:"create_user",width:130,title:"创建人 ",align:"center"},{field:"goods_Time",width:200,title:"创建时间 ",align:"center",templet:function(e){return e.goods_Time?timeStamp(e.goods_Time):"-"}},{field:"update_user",width:130,title:"最后修改人 ",align:"center"},{field:"update_time",width:200,title:"最后修改时间 ",align:"center",templet:function(e){return e.update_time?timeStamp(e.update_time):"-"}},{field:"operation",align:"center",position:"absolute",right:0,width:200,title:"操作",toolbar:"#barDemo"}]],id:"tableId",page:!0,loading:!0,limits:[100,50,20,10],request:{pageName:"pageNum",limitName:"pageSize"},where:{condition:sessionStorage.machineID},parseData:function(e){return 200==e.code?{code:e.code,msg:"",count:e.data.total,data:e.data.list}:{code:e.code,msg:e.message}},response:{statusCode:200},done:function(e){F(),403==e.code?window.parent.location.href="login.html":405==e.code&&g(".hangContent").show()}}),d=layui.form;function t(e,o){loadingAjax("/classify/findAll","post",JSON.stringify({pageNum:1,pageSize:200,merchantId:e}),sessionStorage.token).then(function(e){var t='<option value="">全部</option>';1==o&&g("#addGoodsType").empty(),g("#EditGoodsType").empty(),g("#GoodsType").empty(),g.each(e.data.list,function(e,o){t+='<option value="'.concat(o.classifyId,'">').concat(o.classifyName,"</option>")}),1==o&&g("#addGoodsType").append(t),g("#EditGoodsType").append(t),g("#GoodsType").append(t),d.render("select")}).catch(function(e){})}t(sessionStorage.machineID,1);var s="";d.on("select(mySelect1)",function(e){console.log(e),s=e.value});var l="";d.on("select(stateSelect)",function(e){l=e.value}),g(".query-btnClick").click(function(){n.reload({where:{conditionTwo:g(".KyeText").val(),conditionThree:s,conditionFour:l}})});var r,c=null,m=null,p=null;i.on("tool(test)",function(o){"add"===o.event?(p=o.data,console.log(p),g(".anUp").slideUp(),c!=p.goods_Id?(c=p.goods_Id,g(this).siblings(".anUp").slideDown()):c=null,g(".preferentialClick").click(function(){g(".anUp").slideUp(),g(".preferential").fadeIn(),g('input[name="GoodsName"]').val(p.goods_Name),g('input[name="goods_Price"]').val(p.goods_Price),g('input[name="vip_Price"]').val(p.vipPrice),g('input[name="integral"]').val(p.integral)})):"delete"===o.event?layer.confirm("确定删除？",function(e){Goodsdel(o.data.goods_Id,1,o,e)}):console.log(o)}),g(".upload-btn1").click(function(){f=m=1,w=0,k(),popupShow("GoodsMaterial","goodsMaterialBox")}),g("body").on("click",".GoodsInformation",function(){c=null,g(".anUp").slideUp(),popupShow("editor","editor-content"),g(".editor").scrollTop(0),d.val("EditValData",{goodsBarcode:p.goods_Core,goodsName:p.goods_Name,goodsType:p.classify_Id,goodsPrice:p.goods_Price,goodsCost:p.goods_Cost,goodsParam:p.goods_Param,goodsStatus:p.goods_Status}),console.log(p.goods_images),1==p.mail?g('.editor input[name="editmail"]').prop("checked",!0):g('.editor input[name="editmail"]').prop("checked",!1),g("#editImg").attr("src",p.goods_images);var e=p.goods_Descript.replace(/video/g,"iframe");u.txt.html(e),d.render()}),g("body").on("click",".anUp .previewDetails",function(){c=null,g(".anUp").slideUp(),popupShow("reading","margin0"),g(".reading-box").html(p.goods_Descript)});var u=new e("#editWangEditor");u.customConfig.uploadImgHooks={error:function(){layer.msg("图片上传失败")}},u.create(),g(".editDetermine-btn").click(function(){c=null;var e,o=d.val("EditValData");console.log(o),o.goodsParam&&o.goodsBarcode&&o.goodsName&&o.goodsType&&o.goodsPrice?0<o.goodsPrice?(e=u.txt.html().replace(/iframe/g,'video  controls="false"'),e=JSON.stringify({goods_Id:p.goods_Id,goods_Core:o.goodsBarcode,goods_Name:o.goodsName,classify_Id:o.goodsType,brand:o.goodsBrand,goods_Price:o.goodsPrice,goods_Cost:o.goodsCost||0,goods_Param:o.goodsParam,goods_Status:o.goodsStatus,goods_Images:g("#editImg").attr("src"),goods_Descript:e,mail:g('.editor input[name="editmail"]').prop("checked")?1:0}),g(".mask").fadeIn(),g(".maskSpan").addClass("maskIcon"),loadingAjax("/goods/updateGoods","post",e,sessionStorage.token,"mask","","",layer).then(function(e){layer.msg("修改成功",{icon:1}),g(".editor").fadeOut(),n.reload({where:{}})}).catch(function(e){layer.msg(e.message,{icon:2})})):layer.msg("同一销售价必须大于0",{icon:7}):layer.msg("带*为必填",{icon:7})}),g(".preferential .cancel-btn").on("click",function(){g(".preferential").fadeOut(),c=null}),layui.layedit.set({uploadImage:{url:"".concat(vApi,"/fileUpload"),headers:{token:a},type:"post",code:200}}),g(".editor .cancel-btn").click(function(){g(".editor").fadeOut(),c=null});var h=null,f=null;g(".add-btn").click(function(){popupShow("addGoods","editor-content"),g(".addGoods").scrollTop(0),g(".tailoring-container").fadeIn()}),g(".addGoods .cancel-btn2").click(function(){popupHide("addGoods","editor-content"),g(".upload-demo2 .upload-list2").fadeOut()}),g(".upload-btn2").click(function(){m=2,f=1,w=0,k(),popupShow("GoodsMaterial","goodsMaterialBox")});var y=new e("#addWangEditor");y.customConfig.menus=["head","bold","fontSize","fontName","italic","underline","strikeThrough","foreColor","backColor","link","list","justify","quote","emoticon","image","table","video","undo","redo"],y.customConfig.uploadImgHooks={error:function(){layer.msg("图片上传失败")}};var v=null;g(".upVideo").click(function(e){v=g(this).attr("typeID"),popupShow("goodsmaterialVideo","materialBox"),b=b||i.render({elem:"#materiaVideoTable",method:"post",url:"".concat(vApi,"/good_material/getGoodMaterial"),contentType:"application/json",headers:{token:a},cols:[[{field:"name",width:120,title:"视频名",align:"center"},{field:"publishTime",width:180,title:"发布时间",align:"center"},{field:"addUser",width:150,title:"发布人",align:"center"},{field:"operation",width:150,title:"操作",toolbar:"#barDemoVideo",align:"center"}]],page:!0,id:"VideoListData",loading:!0,request:{pageName:"pageNum",limitName:"pageSize"},where:{conditionFour:"1",conditionFive:"2",conditionSix:I},parseData:function(e){return 200==e.code?{code:e.code,msg:"",count:e.data.total,data:e.data.list}:{code:e.code,msg:e.message}},response:{statusCode:200},done:function(e){403==e.code&&(window.parent.location.href="login.html")}})}),y.create(),g(".determine-btn2").click(function(){var e,o=d.val("addValData");console.log(o),console.log(g('.addGoods input[name="mail"]')),console.log(g('.addGoods input[name="mail"]').prop("checked")),o.goodsParam&&o.goodsBarcode&&o.goodsName&&o.goodsType&&o.goodsPrice?h?0<o.goodsPrice?(e=y.txt.html().replace(/iframe/g,'video controls="false"'),e=JSON.stringify({goods_Core:o.goodsBarcode,goods_Name:o.goodsName,classify_Id:o.goodsType,brand:o.goodsBrand,goods_Price:o.goodsPrice,goods_Cost:o.goodsCost||0,goods_Param:o.goodsParam,goods_Status:o.goodsStatus,goods_Images:h,goods_Descript:e,merchantId:sessionStorage.machineID,mail:g('.addGoods input[name="mail"]').prop("checked")?1:0}),g(".mask").fadeIn(),g(".maskSpan").addClass("maskIcon"),loadingAjax("/goods/saveGoods","post",e,sessionStorage.token,"mask","","",layer).then(function(e){g(".addGoods").fadeOut(),g(".upload-demo2 .upload-list2").fadeOut(),h=null,d.val("addValData",{goodsBarcode:"",goodsName:"",goodsType:"",goodsBrand:"",goodsPrice:"",goodsCost:0,goodsParam:""}),layer.msg("添加成功",{icon:1}),n.reload({where:{}}),y.txt.clear()}).catch(function(e){layer.msg(e.message,{icon:2})})):layer.msg("同一销售价必须大于0",{icon:7}):layer.msg("请上传商品图片",{icon:7}):layer.msg("带*为必填",{icon:7})}),g(".reading-btn").click(function(){popupShow("reading","margin0"),"add"==g(this).attr("id")?(g(".reading").fadeIn(),g(".reading-box").html(y.txt.html())):"edit"==g(this).attr("id")&&g(".reading-box").html(u.txt.html())}),g(".reading-down").click(function(){g(".Goods-wrap").removeClass("fixed"),g(".reading").fadeOut(),c=null}),g(".playHeader .close").click(function(){g(this).parent().parent().addClass("margin0"),g(this).parents(".maskContnet").fadeOut(),c=null});var w=null,_=null;function k(){_=i.render({elem:"#materiaImgTable",method:"post",url:"".concat(vApi,"/good_material/getGoodMaterial"),contentType:"application/json",headers:{token:a},cols:[[{field:"img",width:100,title:"图片",align:"center",templet:"#materiaImgtmp"},{field:"name",width:120,title:"图片名",align:"center"},{field:"publishTime",width:180,title:"发布时间",align:"center"},{field:"addUser",width:150,title:"发布人",align:"center"},{field:"operationa",right:0,align:"center",width:150,title:"操作",toolbar:"#materiaImg",fixed:"right"}]],page:!0,id:"ImgListData",loading:!0,request:{pageName:"pageNum",limitName:"pageSize"},parseData:function(e){return 200==e.code?{code:e.code,msg:"",count:e.data.total,data:e.data.list}:{code:e.code,msg:e.message}},where:{conditionFour:w,conditionFive:"2",conditionSix:I},response:{statusCode:200},done:function(e){403==e.code&&(window.parent.location.href="login.html")}})}g(".materialKeyCont .queryBtnClick").click(function(){console.log(g('.materialKeyCont input[name="KyeText"]').val()),_.reload({where:{conditionFour:w,conditionFive:"2",conditionThree:g('.materialKeyCont input[name="KyeText"]').val()}})}),g(".goodsmaterialVideo .queryBtnClick").click(function(){b.reload({where:{conditionFour:"1",conditionFive:"2",conditionThree:g('.goodsmaterialVideo input[name="KyeText"]').val()}})}),i.on("tool(materiaImgTable)",function(e){console.log(e),console.log(f,h),1==f?2==m?(h=e.data.img,g("#GoodsImg").attr("src",h),g(".upload-demo2 .upload-list2").fadeIn()):(r=e.data.img,g("#editImg").attr("src",r)):2==m?11<y.txt.html().length?y.txt.append('<p style="text-align: center;"><img src="'.concat(e.data.img,'"></img></p>')):y.txt.html('<p style="text-align: center;"><img src="'.concat(e.data.img,'"></img></p>')):11<u.txt.html().length?u.txt.append('<p style="text-align: center;"><img src="'.concat(e.data.img,'"></img></p>')):u.txt.html('<p style="text-align: center;"><img src="'.concat(e.data.img,'"></img></p>')),popupHide("GoodsMaterial","goodsMaterialBox")});var b=null;i.on("tool(materiaVideoTable)",function(e){console.log(e),"preview"==e.event?(popupShow("materialPreview","previewBox"),g(".perviewBody video").attr("src",e.data.img),console.log(v)):(console.log(v),2==v?11<y.txt.html().length?y.txt.append('<div><iframe src="'.concat(e.data.img,'"></iframe></div>')):y.txt.html('<div><iframe src="'.concat(e.data.img,'"></iframe></div>')):11<u.txt.html().length?u.txt.append('<div><iframe src="'.concat(e.data.img,'"></iframe></div>')):u.txt.html('<div><iframe src="'.concat(e.data.img,'"></iframe></div>')),popupHide("goodsmaterialVideo","materialBox"))}),g(".upImg").click(function(){f=g(this).attr("contType"),m=g(this).attr("goodsIndex"),w=2,popupShow("GoodsMaterial","goodsMaterialBox"),k()}),g(".refreshBtnList").click(function(){var e=treeList();JSON.stringify(e)!=JSON.stringify(x)&&(N(o,"testGoods",n,x=e,"condition","goodsClass",t),n.reload({where:{condition:sessionStorage.machineID}})),layer.msg("已刷新",{icon:1})});var S,I=sessionStorage.machineID,x=S=treeList();function N(e,d,s,o,l,r,c){e.render({elem:"#".concat(d),id:"treelist",showLine:!0,onlyIconControl:!0,data:o,spread:!0,text:{defaultNodeName:"无数据",none:"您没有权限，请联系管理员授权!"},click:function(e){var o,t,a;G&&(e.data.id==sessionStorage.machineID?g(".add-btn").show():g(".add-btn").hide()),I=e.data.id+"",r&&c(e.data.id+""),s.reload({where:(o={},t=l,a=e.data.id+"",t in o?Object.defineProperty(o,t,{value:a,enumerable:!0,configurable:!0,writable:!0}):o[t]=a,o)});for(var n=g("#".concat(d," .layui-tree-txt")),i=0;i<n.length;i++)n[i].innerHTML===e.data.title?n[i].style.color="#be954a":n[i].style.color="#555"}})}console.log(x),N(o,"testGoods",n,x,"condition","goodsClass",t);var C=null;var T,P=null;g(".pushGoodsBtn").click(function(){P=i.checkStatus("tableId"),console.log(P),0<P.data.length?(leg.tree({ele:".treeList",data:S,cascade:!1}),popupShow("chooseLower","chooseBox"),g.each(g(".treeList input"),function(){P.data[0].merchantId==g(this).val()&&g(this).prop("disabled",!0)})):layer.msg("请选择需要推送的商品",{icon:7})});var B=null;g(".determineBtn").click(function(){B=leg.getCheckedNodes().map(Number),console.log(leg.getCheckedNodes()),0!=B.length?(popupShow("PushMandatory","MandatoryBox"),console.log(P)):layer.msg("请选择要推送的商户",{icon:7})}),g(".mandatroFooter div").click(function(){var t=[];T=g(this).attr("Ptype"),g(".mask").fadeIn(),g(".maskSpan").addClass("maskIcon"),P.data.forEach(function(e,o){e={className:e.classifyName,goodsId:e.goods_Id};t.push(e)});var e=JSON.stringify({goods:t,merchantId:sessionStorage.machineID,mid:B,type:T});loadingAjax("/goods/sendGoods","post",e,a,"mask","chooseLower","chooseBox",layer).then(function(e){console.log(e),C&&C.reload({where:{}}),popupHide("PushMandatory","MandatoryBox"),layer.msg(e.message,{icon:1})}).catch(function(e){g(".mask").fadeOut(),g(".maskSpan").removeClass("maskIcon"),popupHide("PushMandatory","MandatoryBox"),layer.msg(e.message,{icon:2})})}),g(".chooseFooter .chooseCan").click(function(){popupHide("chooseLower","chooseBox")}),g(".pushListBtn").click(function(){popupShow("topGoodsList","topBox"),C=C||i.render({elem:"#parentTableTest",url:"".concat(vApi,"/goods/getSendHistory"),method:"post",height:500,contentType:"application/json",headers:{token:a},cols:[[{type:"checkbox"},{field:"goods_images",width:80,title:"图片",templet:"#Listimgtmp",align:"center"},{field:"goods_Name",width:150,title:"商品名",color:"#409eff",align:"center",templet:function(e){return 1==e.mail?"(邮寄)"+e.goods_Name:e.goods_Name}},{field:"classifyName",width:160,title:"商品类目",align:"center"},{field:"tempMerchant",width:160,title:"商品所属商户",align:"center"},{field:"topMerchant",width:160,title:"推送商户",align:"center"},{field:"targetMerchant",width:160,title:"接收商户",align:"center"},{field:"goods_Param",width:130,title:"接收状态 ",align:"center",templet:function(e){return 0==e.received?"未接收":"已接收"}},{field:"sendTime",width:200,title:"推送时间 ",align:"center",templet:function(e){var o=new Date(e.sendTime);return o.getFullYear()+"-"+(o.getMonth()+1)+"-"+(e=o.getDate())+" "+o.getHours()+":"+o.getMinutes()+":"+o.getSeconds()}}]],id:"parentTableId",page:!0,loading:!0,limits:[10,20,50],request:{pageName:"pageNum",limitName:"pageSize"},where:{condition:sessionStorage.machineID,conditionFour:"0"},parseData:function(e){return 200==e.code?{code:e.code,msg:"",count:e.data.total,data:e.data.list}:{code:e.code,msg:e.message}},response:{statusCode:200},done:function(e){403==e.code&&(window.parent.location.href="login.html");e.data.list;for(var o in e.data){var t=e.data[o];t.childMerchantId==sessionStorage.machineID&&1!=t.received||(g(".list_table1 tr[data-index="+o+'] input[type="checkbox"]').prop("disabled",!0),d.render())}}})}),g(".topBody .pushQueryBtn").click(function(){C.reload({where:{conditionTwo:g('.topBody select[name="mandatory"]').val(),conditionThree:g('.topBody select[name="receiveStatus"]').val(),conditionFour:g('.topBody select[name="receiveType"]').val(),goods_Name:g('.topBody input[name="KyeText"]').val()}})}),g(".topBody .pushGoodsListBtn").click(function(){var e=i.checkStatus("parentTableId");console.log(e);var t=[];0<e.data.length?(e.data.forEach(function(e,o){e.childMerchantId==sessionStorage.machineID&&0==e.received&&(e={className:e.classifyName,goodsId:e.goods_Id,merchantId:sessionStorage.machineID},t.push(e))}),0<t.length?(g(".mask").fadeIn(),g(".maskSpan").addClass("maskIcon"),e=JSON.stringify({goods:t,merchantId:sessionStorage.machineID}),loadingAjax("/goods/forwardGoods","post",e,sessionStorage.token,"mask","topGoodsList","topBox",layer).then(function(e){console.log(e),layer.msg(e.message,{icon:1}),n.reload({where:{}}),C.reload({where:{}})}).catch(function(e){g(".mask").fadeOut(),g(".maskSpan").removeClass("maskIcon"),layer.msg(e.message,{icon:2})})):layer.msg("没有能接收的商品",{icon:7})):layer.msg("请选择接收的商品",{icon:7})}),g("body").bind("keydown",function(e){116==e.keyCode&&(e.preventDefault(),location.reload())});var G=!0,D=!0,O=!0,M=!0,j=!0,L=!1;function F(){G?g(".add-btn").removeClass("hide"):g(".add-btn").addClass("hide"),D?g(".GoodsInformation").removeClass("hide"):g(".GoodsInformation").addClass("hide"),O?g(".del-btn").removeClass("hide"):g(".del-btn").addClass("hide"),M?g(".pushGoodsBtn").removeClass("hide"):g(".pushGoodsBtn").addClass("hide"),j?g(".pushListBtn").removeClass("hide"):g(".pushListBtn").addClass("hide"),L?g(".syncBtn").removeClass("hide"):g(".syncBtn").addClass("hide"),console.log(L)}permissionsVal(377,378,375,416,415,461).then(function(e){G=e.addFlag,D=e.editFlag,O=e.delFlag,M=e.fourFlag,j=e.fiveFlag,L=e.sixFlag,F()}).catch(function(e){layer.msg("服务器请求超时",{icon:7})}),g(".syncBtn").click(function(){popupShow("synchronousCont","synchronousBox"),g(".synchronousGoodsName").val(),g(".synchronousMachineName").val(),A=i.render({elem:"#cGoodsTable",url:"".concat(vApi,"/goods/findAll"),method:"post",contentType:"application/json",headers:{token:a},cols:[[{checkbox:!0},{field:"goods_images",width:100,title:"图片",templet:"#imgtmp",align:"center"},{field:"goods_Core",width:150,title:"商品编号",align:"center"},{field:"goods_Name",width:150,title:"商品名",color:"#409eff",align:"center",templet:function(e){return 1==e.mail?"(邮寄)"+e.goods_Name:e.goods_Name}},{field:"goods_Price",width:80,align:"center",title:"销售价 ",templet:function(e){var o=e.goods_Price;if(e.goods_Price=Number(Number(e.goods_Price).toFixed(2)),isNaN(e.goods_Price))return o;o=-1!==e.goods_Price.toString().indexOf(".")?e.goods_Price.toLocaleString():e.goods_Price.toString().replace(/(\d)(?=(?:\d{3})+$)/g,"$1,"),e=o.split(".");return 1==e.length?o+=".00":1==e[1].length&&(o+="0"),o}},{field:"mail",width:150,title:"是否邮寄商品",align:"center",templet:function(e){return 0==e.mail?"否":"是"}}]],id:"goodsTableS",page:!0,loading:!0,request:{pageName:"pageNum",limitName:"pageSize"},where:{condition:sessionStorage.machineID},parseData:function(e){return 200==e.code?{code:e.code,msg:"",count:e.data.total,data:e.data.list}:{code:e.code,msg:e.message}},response:{statusCode:200},done:function(e){F(),403==e.code?window.parent.location.href="login.html":405==e.code&&g(".hangContent").show()}}),H=i.render({elem:"#machineTable",url:"".concat(vApi,"/machine/getMachineList"),method:"post",contentType:"application/json",headers:{token:a},cols:[[{checkbox:!0},{field:"number",width:150,title:"售货机编号",align:"center",templet:function(e){return e.number||"-"}},{field:"info",width:250,title:"售货机信息",align:"center",templet:function(e){return e.info?"<div>".concat(e.info,"</div>"):'<div><span style="color:red;">*</span>(售货机为新上线机器，请编辑售货机信息！)</div>'}},{field:"location",width:250,title:"地址",align:"center",templet:function(e){return e.location||" - "}}]],id:"machineIDTable",page:!0,loading:!0,limits:[10,20,50,100],request:{pageName:"pageNum",limitName:"pageSize"},where:{merchantId:sessionStorage.machineID},parseData:function(e){return 200==e.code?{code:e.code,msg:e.message,count:e.data.total,data:e.data.list}:{code:e.code,msg:e.message}},response:{statusCode:200},done:function(e){F(),403==e.code?window.parent.location.href="login.html":405==e.code&&g(".hangContent").show()}})});var A=null;g(".synchronousGoodsQuery").click(function(){A.reload({where:{conditionTwo:g(".synchronousGoodsName").val()}})});var H=null;g(".synchronousMachineQuery").click(function(){H.reload({where:{keyword:g(".synchronousMachineName").val()}})}),g(".synchronousCont .synchronousCancel").click(function(){popupHide("synchronousCont","synchronousBox")}),g(".synchronousCont .synchronousBtn").click(function(){var a=i.checkStatus("goodsTableS").data,n=i.checkStatus("machineIDTable").data;console.log(a),console.log(n),0!=a.length&&0!=n.length?layer.confirm("确定同步价格？",function(e){layer.close(e);var o=[],t=[];a.forEach(function(e){e={goodId:e.goods_Id,price:e.goods_Price};o.push(e)}),n.forEach(function(e){e={machineId:e.machineId};t.push(e)});e=JSON.stringify({goods:o,machines:t});loadingAjax("/goods/syncPrice","post",e,sessionStorage.token).then(function(e){layer.msg(e.message,{icon:1}),A.reload({where:{}}),H.reload({where:{}}),popupHide("synchronousCont","synchronousBox")}).catch(function(e){layer.msg(e.message,{icon:2}),console.log(e)})}):layer.msg("请选择需要同步价格的商品与售货机",{icon:7})})})},387:function(e,o){}});