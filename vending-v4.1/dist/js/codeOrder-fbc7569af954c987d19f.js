/*! 版权所有，翻版必究 */!function(e){function t(t){for(var i,r,c=t[0],l=t[1],s=t[2],u=0,m=[];u<c.length;u++)r=c[u],Object.prototype.hasOwnProperty.call(a,r)&&a[r]&&m.push(a[r][0]),a[r]=0;for(i in l)Object.prototype.hasOwnProperty.call(l,i)&&(e[i]=l[i]);for(d&&d(t);m.length;)m.shift()();return o.push.apply(o,s||[]),n()}function n(){for(var e,t=0;t<o.length;t++){for(var n=o[t],i=!0,c=1;c<n.length;c++){var l=n[c];0!==a[l]&&(i=!1)}i&&(o.splice(t--,1),e=r(r.s=n[0]))}return e}var i={},a={9:0},o=[];function r(t){if(i[t])return i[t].exports;var n=i[t]={i:t,l:!1,exports:{}};return e[t].call(n.exports,n,n.exports,r),n.l=!0,n.exports}r.m=e,r.c=i,r.d=function(e,t,n){r.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:n})},r.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},r.t=function(e,t){if(1&t&&(e=r(e)),8&t)return e;if(4&t&&"object"==typeof e&&e&&e.__esModule)return e;var n=Object.create(null);if(r.r(n),Object.defineProperty(n,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var i in e)r.d(n,i,function(t){return e[t]}.bind(null,i));return n},r.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return r.d(t,"a",t),t},r.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},r.p="";var c=window.webpackJsonp=window.webpackJsonp||[],l=c.push.bind(c);c.push=t,c=c.slice();for(var s=0;s<c.length;s++)t(c[s]);var d=l;o.push([274,0]),n()}({274:function(e,t,n){"use strict";n.r(t);n(673);layui.use(["laydate","table","tree","flow","layer","form"],function(){var e=getKeyTime().startTime,t=getKeyTime().endTime;layui.laydate.render({elem:"#test6",range:!0,value:getKeyTime().keyTimeData,done:function(n){var i=n.split(" - ");e=i[0],t=i[1]}});var n=sessionStorage.token,i=layui.flow,a=layui.layer,o=layui.table,r=(layui.form,layui.tree),c=sessionStorage.machineID,l=o.render({elem:"#moneyData",url:"".concat(vApi,"/order/getCodeOrder"),method:"post",contentType:"application/json",headers:{token:n},height:600,cols:[[{field:"activity_name",width:130,title:"活动名",align:"center",fixed:"left"},{field:"good_code",width:180,title:"取货码",align:"center"},{field:"machineName",width:200,title:"售货机名(编号)",align:"center",templet:function(e){return"<div>".concat(e.machineName,"</div>\n                    <div>(").concat(e.machineNumber,")</div>")}},{field:"machineAddress",width:210,title:"终端地址",align:"center"},{field:"ship_info",width:250,title:"出货情况",align:"center",templet:function(e){if(0==e.ship_info.length)return"-";var t="";return e.ship_info.forEach(function(e,n){t+="<div>".concat(e.goods_Name,"(").concat(e.way,"货道").concat(0==e.ship_status?"出货失败":1==e.ship_status?"出货成功":"货道故障",")</div>")}),t}},{field:"operate_time",width:160,align:"center",title:"取货时间",templet:function(e){return e.operate_time?timeStamp(e.operate_time):"-"}},{field:"operate_time",width:100,title:"退货状态",align:"center",templet:function(e){return 0==e.refund?"未退货":"已退货"}},{field:"operation",width:100,title:"操作",toolbar:"#refundDemo",align:"center"}]],page:!0,loading:!0,request:{pageName:"pageNum",limitName:"pageSize"},where:{merchant_id:Number(c),start_time:e||null,end_time:t||null},parseData:function(e){return 200==e.code?{code:e.code,msg:e.message,count:e.data.total,data:e.data.list}:403!=e.code?{code:e.code,msg:e.message}:void(window.parent.location.href="login.html")},response:{statusCode:200},done:function(e){}});function s(){i.load({elem:"#demo",isAuto:!0,scrollElem:"#demo",end:" ",done:function(e,t){setTimeout(function(){var n=[];t(n.join(""),e<1e3);var i=JSON.stringify({pageNum:e,pageSize:100,merchant_id:c});loadingAjax("/activity/getActivityList","post",i,sessionStorage.token).then(function(e){e.data.list.forEach(function(e,t){n.push('<span activityID="'.concat(e.id,'">').concat(e.activity_name,"</span>"))}),t(n.join(""),e.data.list.length>=100)}).catch(function(e){console.log(e),a.msg(e.message,{icon:7}),t(n.join(""),200==e.code)})},200)}})}s(),$(".queryBtn").click(function(){l.reload({where:{good_code:$('.newKeyContent input[name="codeNumber"]').val(),start_time:e||null,end_time:t||null}})});var d="";$("body").on("click",".activityArr span",function(){$(".allmachine").removeClass("active"),$(this).addClass("active").siblings().removeClass("active"),d=$(this).attr("activityID"),l.reload({where:{activity_id:Number(d)}})}),$(".allmachine").click(function(){$(this).addClass("active"),$(".activityArr span").removeClass("active"),d="",l.reload({where:{activity_id:null}})});var u=null;o.on("tool(moneyData)",function(e){u=e.data,a.confirm("确定退货？",function(e){a.close(e);var t=JSON.stringify({good_code:u.good_code});loadingAjax("/machine/activityRefund","post",t,sessionStorage.token).then(function(e){a.msg(e.message,{icon:1}),l.reload({where:{}})}).catch(function(e){a.msg(e.message,{icon:2})})})}),function(e,t,n){e.render({elem:"#".concat(t),id:"treelist",showLine:!0,onlyIconControl:!0,data:n,spread:!0,text:{defaultNodeName:"无数据",none:"您没有权限，请联系管理员授权!"},click:function(e){m=e.data.title;for(var n=$("#".concat(t," .layui-tree-txt")),i=0;i<n.length;i++)n[i].innerHTML===e.data.title?n[i].style.color="#be954a":n[i].style.color="#555";c!=e.data.id&&(c=e.data.id,$("#demo").remove(),$(document).unbind(),$(".activityList1").append('<div class="activityArr" id="demo"></div>'),s(),$(".activityList1 span").removeClass("active"),$(".allmachine").addClass("active"),"",l.reload({where:{activity_id:null,merchant_id:c}}))}})}(r,"test1",treeList());var m=sessionStorage.marchantName;var f=window.parent.permissionsData1();permissionsVal1({476:!1},f)[476]?$(".pushBtn").removeClass("hide"):$(".pushBtn").addClass("hide"),$(".pushBtn").click(function(){if(e&&t)if(timeFlag(e,t))a.msg("时间选择范围最多三个月",{icon:7});else{var n="取货码-".concat(m,"(").concat(e,"至").concat(t,").xls"),i=$(".codeNumber").val(),o="".concat(vApi,"/exportCodesExcel?startDate=").concat(e,"&endDate=").concat(t,"&merchant_id=").concat(c,"&code=").concat(i);exportExcel(o,n)}else a.msg("请选择时间",{icon:7})})})},673:function(e,t){}});