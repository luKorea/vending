/*! 版权所有，翻版必究 */!function(s){function e(e){for(var t,n,o=e[0],a=e[1],i=e[2],r=0,p=[];r<o.length;r++)n=o[r],Object.prototype.hasOwnProperty.call(d,n)&&d[n]&&p.push(d[n][0]),d[n]=0;for(t in a)Object.prototype.hasOwnProperty.call(a,t)&&(s[t]=a[t]);for(u&&u(e);p.length;)p.shift()();return c.push.apply(c,i||[]),l()}function l(){for(var e,t=0;t<c.length;t++){for(var n=c[t],o=!0,a=1;a<n.length;a++){var i=n[a];0!==d[i]&&(o=!1)}o&&(c.splice(t--,1),e=r(r.s=n[0]))}return e}var n={},d={21:0},c=[];function r(e){if(n[e])return n[e].exports;var t=n[e]={i:e,l:!1,exports:{}};return s[e].call(t.exports,t,t.exports,r),t.l=!0,t.exports}r.m=s,r.c=n,r.d=function(e,t,n){r.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:n})},r.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},r.t=function(t,e){if(1&e&&(t=r(t)),8&e)return t;if(4&e&&"object"==typeof t&&t&&t.__esModule)return t;var n=Object.create(null);if(r.r(n),Object.defineProperty(n,"default",{enumerable:!0,value:t}),2&e&&"string"!=typeof t)for(var o in t)r.d(n,o,function(e){return t[e]}.bind(null,o));return n},r.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return r.d(t,"a",t),t},r.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},r.p="";var t=window.webpackJsonp=window.webpackJsonp||[],o=t.push.bind(t);t.push=e,t=t.slice();for(var a=0;a<t.length;a++)e(t[a]);var u=o;c.push([146,0]),l()}({146:function(e,t,n){"use strict";n.r(t);n(395);layui.use(["table","form","layer"],function(){var e=layui.table,o=(layui.form,layui.layer),n=e.render({elem:"#payTypeList",url:"/api/pay/getAllPayType",method:"post",contentType:"application/json",headers:{token:sessionStorage.token},cols:[[{field:"logo",width:180,title:"图标",templet:"#imgtmp"},{field:"name",width:180,title:"类型名"},{field:"status",width:180,title:"状态",templet:function(e){return 1==e.status?"启用":"禁用"}},{field:"update_user",width:180,title:"最后修改人"},{field:"update_time",width:180,title:"最后修改时间",templet:function(e){if(e.update_time){var t=new Date(e.update_time);return t.getFullYear()+"-"+(t.getMonth()+1)+"-"+(e=t.getDate())+" "+t.getHours()+":"+t.getMinutes()+":"+t.getSeconds()}return""}},{field:"operation",fixed:"right",right:0,width:180,title:"操作",toolbar:"#barDemo"}]],id:"tableId",loading:!0,where:{condition:sessionStorage.machineID},parseData:function(e){return 200==e.code?{code:e.code,msg:e.message,count:e.data.total,data:e.data}:403!=e.code?{code:e.code,msg:e.message}:void(window.parent.location.href="login.html")},response:{statusCode:200},done:function(e){405==e.code&&$(".hangContent").show()}});$(".addTypeBtn").click(function(){popupShow("addpayType","addBox")}),$('.listFlex input[name="uploadImg"]').change(function(e){}),$(".refreshBtn").click(function(){location.reload()}),$("body").bind("keydown",function(e){116==e.keyCode&&f5Fun()}),$(".playHeader .close").click(function(){$(this).parent().parent().addClass("margin0"),$(this).parents(".maskContnet").fadeOut()});var a=null;$('.addpayType .listFlex input[name="uploadImg"]').change(function(e){var t=this,n=new FormData;n.append("file",e.target.files[0]),$.ajax({type:"post",url:"/api/fileUpload",processData:!1,contentType:!1,timeout:1e4,headers:{token:token},data:n,success:function(e){console.log(e),$(t).val(""),0==e.code?(a=e.data.src,$(".addpayType .logiImg img").prop("src",a),$(".logiImg").show()):o.msg(e.message,{icon:7})},error:function(){o.msg("服务器请求超时",{icon:2})}})}),$(".addpayType .addCancelBtn").click(function(){popupHide("addpayType","addBox")}),$(".addpayType .RdetermineBtn").click(function(){var e;$('.addpayType input[name="name"]').val()?a?(e=JSON.stringify({logo:a,name:$('.addpayType input[name="name"]').val()}),loadingAjax("/api/pay/newPayType","post",e,sessionStorage.token,"","addpayType","addBox",o).then(function(e){o.msg("添加成功",{icon:1}),n.reload({where:{}}),$('.addpayType input[name="name"]').val(""),$(".addpayType .logiImg").hide(),a=null}).catch(function(e){console.log(e),o.msg("添加失败",{icon:2})})):o.msg("请上传图标",{icon:7}):o.msg("类型名不能为空",{icon:7})});var i=null;e.on("tool(payTypeList)",function(e){i=e.data,"edit"==e.event?($('.editpayType input[name="name"]').val(i.name),$(".editpayType .logiImg img").prop("src",i.logo),popupShow("editpayType","editBox")):"del"==e.event?o.confirm("确定删除？",function(e){o.close(e);var t=JSON.stringify({id:i.id});loadingAjax("/api/pay/deletePayType","post",t,sessionStorage.token,"","","",o).then(function(e){o.msg(e.message,{icon:1}),n.reload({where:{}})}).catch(function(e){o.msg(e.message,{icon:2})})}):"status"==e.event&&o.confirm(1==i.status?"确定禁用？":"确定启用？",function(e){o.close(e);var t=JSON.stringify({id:i.id,logo:"微信"==i.name||"支付宝"==i.name?"":i.logo,name:i.name,status:1==i.status?0:1});loadingAjax("/api/pay/updatePayType","post",t,sessionStorage.token,"","editpayType","editBox",o).then(function(e){console.log(e),o.msg(e.message,{icon:1}),n.reload({where:{}})}).catch(function(e){console.log(e),o.msg(e.message,{icon:2})})})}),$('.editpayType .listFlex input[name="uploadImg"]').change(function(e){var t=this,n=new FormData;n.append("file",e.target.files[0]),$.ajax({type:"post",url:"/api/fileUpload",processData:!1,contentType:!1,timeout:1e4,headers:{token:token},data:n,success:function(e){console.log(e),$(t).val(""),0==e.code?$(".editpayType .logiImg img").prop("src",e.data.src):o.msg(e.message,{icon:7})},error:function(){o.msg("服务器请求超时",{icon:2})}})}),$(".editpayType .RdetermineBtn").click(function(){var e;$('.editpayType input[name="name"]').val()?(e=JSON.stringify({id:i.id,logo:$(".editpayType .logiImg img").prop("src"),name:$('.editpayType input[name="name"]').val()}),loadingAjax("/api/pay/updatePayType","post",e,sessionStorage.token,"","editpayType","editBox",o).then(function(e){console.log(e),o.msg(e.message,{icon:1}),n.reload({where:{}}),a=null}).catch(function(e){console.log(e),o.msg(e.message,{icon:2})})):o.msg("类型名不能为空",{icon:7})})})},395:function(e,t){}});