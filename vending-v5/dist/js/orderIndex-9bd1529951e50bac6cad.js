/*! 版权所有，翻版必究 */!function(e){function t(t){for(var a,r,c=t[0],s=t[1],d=t[2],l=0,p=[];l<c.length;l++)r=c[l],Object.prototype.hasOwnProperty.call(o,r)&&o[r]&&p.push(o[r][0]),o[r]=0;for(a in s)Object.prototype.hasOwnProperty.call(s,a)&&(e[a]=s[a]);for(u&&u(t);p.length;)p.shift()();return i.push.apply(i,d||[]),n()}function n(){for(var e,t=0;t<i.length;t++){for(var n=i[t],a=!0,c=1;c<n.length;c++){var s=n[c];0!==o[s]&&(a=!1)}a&&(i.splice(t--,1),e=r(r.s=n[0]))}return e}var a={},o={27:0},i=[];function r(t){if(a[t])return a[t].exports;var n=a[t]={i:t,l:!1,exports:{}};return e[t].call(n.exports,n,n.exports,r),n.l=!0,n.exports}r.m=e,r.c=a,r.d=function(e,t,n){r.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:n})},r.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},r.t=function(e,t){if(1&t&&(e=r(e)),8&t)return e;if(4&t&&"object"==typeof e&&e&&e.__esModule)return e;var n=Object.create(null);if(r.r(n),Object.defineProperty(n,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var a in e)r.d(n,a,function(t){return e[t]}.bind(null,a));return n},r.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return r.d(t,"a",t),t},r.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},r.p="";var c=window.webpackJsonp=window.webpackJsonp||[],s=c.push.bind(c);c.push=t,c=c.slice();for(var d=0;d<c.length;d++)t(c[d]);var u=s;i.push([613,0]),n()}({613:function(e,t,n){"use strict";n.r(t);n(693);var a=n(2);function o(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,a=new Array(t);n<t;n++)a[n]=e[n];return a}$("#city").val("");var i=n(79);function r(e){e=e;var t=i.enc.Utf8.parse("yuebaowenhua2020"),n=i.AES.encrypt(e,t,{iv:i.enc.Utf8.parse("A-16-Byte-String"),mode:i.mode.CBC,padding:i.pad.Pkcs7});return String(n)}var c=Object(a.b)("goods"),s=null;$.ajax({type:"post",url:"/api/order/getMailData",timeout:1e4,headers:{"Content-Type":"application/json"},data:JSON.stringify({key:c}),success:function(e){$(".mask").hide(),200==e.code?function(e){var t=e,n=i.enc.Utf8.parse("yuebaowenhua2020"),o=i.AES.decrypt(t.toString(),n,{iv:i.enc.Utf8.parse("A-16-Byte-String"),mode:i.mode.CBC,padding:i.pad.Pkcs7}).toString(i.enc.Utf8);(s=JSON.parse(o)).payee.forEach(function(e){d.push(e.payType)});var r=navigator.userAgent.toLowerCase();if("alipay"==r.match(/Alipay/i)){if(-1==d.indexOf(1))return $(".determineCont h1").html("当前不支持支付宝付款，请使用其他方式进行扫码购买！"),void $(".determineCont").show();l=1,u=s.payee[d.indexOf(1)]}else{if("micromessenger"!=r.match(/MicroMessenger/i))return $(".determineCont h1").html("请使用支付宝或者微信扫码进行购买！"),void $(".determineCont").show();if(-1==d.indexOf(2))return $(".determineCont h1").html("当前不支持微信付款，请使用其他方式进行扫码购买！"),void $(".determineCont").show();l=2,function(e){var t=Object(a.b)("code"),n=e,o=window.location.href;if(null==t||""==t)window.location.href="https://open.weixin.qq.com/connect/oauth2/authorize?appid=".concat(n,"&redirect_uri=").concat(encodeURIComponent(o),"&response_type=code&scope=snsapi_base&state=STATE#wechat_redirect"),scope=snsapi_base;else{var i=JSON.stringify({code:t,machineId:s.machineId});Object(a.d)("/api/pay/wxLogin","post",i).then(function(e){p=e.data}).catch(function(e){Object(a.g)("微信授权失败")})}}((u=s.payee[d.indexOf(2)]).app_id)}$(".wrap").show(),c=s.goods,f="",c.forEach(function(e){f+='<li class="list flex">\n                        <div class="img">\n                            <img src="'.concat(e.goods_img,'" />\n                        </div>\n                        <div class="goodsInform">\n                            <h5>').concat(e.goods_Name,'</h5>\n                            <div class="flexC of">\n                                <p>单价：￥').concat(Object(a.f)(e.goods_Price),"</p>\n                               \n                                <p>X").concat(e.count,"</p>\n                            </div>\n                            <h5>总价：￥").concat(Number(e.goods_Price)*Number(e.count),"</h5>\n                        </div>\n                    </li>")}),$(".goodsList").html(f);var c,f;var m=JSON.stringify({machine:s.machineId});console.log(s,"商品数据"),console.log(s.goods[0].mail,"类型"),1==s.goods[0].mail?($(".userInformation1").show(),$(".userInformation2").hide(),$(".footer2").hide(),$(".footer1").show(),document.title="邮寄商品购买",$(".header h1").html("邮寄商品购买")):0==s.goods[0].mail&&($(".userInformation1").hide(),$(".userInformation2").show(),$(".footer2").show(),$(".footer1").hide(),document.title="商品购买",$(".header h1").html("商品购买"));Object(a.d)("/api/scanSuccess","post",m).then(function(e){}).catch(function(e){})}(e.data):Object(a.g)("页面初始化失败")},error:function(e){$(".mask").hide(),Object(a.g)("页面初始化失败")}});var d=[],u="",l="",p="";function f(){var e=JSON.stringify({merchantId:s.merchant,sales_no:1==s.goods[0].mail?$('.informationList input[name="salse"]').val():$('.informationList input[name="salse2"]').val(),payee:u.payee,notes:$('.informationList input[name="notes"]').val(),sign_name:$('.informationList input[name="name"]').val(),sign_address:$("#city").val()+$('.informationList input[name="addressss"]').val(),sign_phone:$('.informationList input[name="phone"]').val(),goods:s.goods,machineId:s.machineId,open_id:p}),t=JSON.stringify({data:r(e)});Object(a.d)("/api/pay/wxpay_js","post",t).then(function(e){y=e.message.slice(2,e.message.indexOf("创")),setTimeout(function(e){var t;t=y,v=setInterval(function(e){var n=JSON.stringify({data:r(t)});Object(a.d)("/api/pay/getPayStatus","post",n).then(function(e){2==e.data.payStatus&&(clearInterval(v),""===e.data.url||null===e.data.url?location.href="placeOrder.html":location.href=e.data.url)})},1500)},5e3),"undefined"==typeof WeixinJSBridge?document.addEventListener?document.addEventListener("WeixinJSBridgeReady",m,!1):document.attachEvent&&(document.attachEvent("WeixinJSBridgeReady",m),document.attachEvent("onWeixinJSBridgeReady",m)):($(".mask").hide(),m(e.data))}).catch(function(e){$(".mask").hide(),Object(a.g)("微信下单失败")})}function m(e){WeixinJSBridge.invoke("getBrandWCPayRequest",{appId:e.appId,timeStamp:e.timeStamp,nonceStr:e.nonceStr,package:e.package,signType:"MD5",paySign:e.paySign},function(e){"get_brand_wcpay_request:ok"==e.err_msg||(Object(a.g)("已取消支付"),clearInterval(v))})}$("#city").click(function(e){SelCity(this,e)});$(".footer1 h1").click(function(){if($("#hcity").val()&&$("#hproper").val()&&$("#harea").val())if($(".address").val()&&$(".name").val()&&$(".phone").val()){if(1==function(e){var t=1;if(e&&!/^1[3456789]\d{9}$/.test(e))return Object(a.g)("请填写正确的手机号码"),t=0,!1;return t}($(".phone").val()))if($(".mask").show(),1==l){var e=JSON.stringify({merchantId:s.merchant,sales_no:$('.informationList input[name="salse"]').val(),payee:u.payee,notes:$('.informationList input[name="notes"]').val(),sign_name:$('.informationList input[name="name"]').val(),sign_address:$("#city").val()+$('.informationList input[name="addressss"]').val(),sign_phone:$('.informationList input[name="phone"]').val(),goods:s.goods,machineId:s.machineId}),t=JSON.stringify({data:r(e)});Object(a.d)("/api/pay/alipay_js","post",t).then(function(e){var t=document.createElement("divForm");t.innerHTML=e.msg.body,document.body.appendChild(t),document.forms[0].acceptCharset="UTF-8",document.forms[0].submit(),$(".mask").hide()}).catch(function(e){$(".mask").hide(),Object(a.g)("下单失败")})}else 2==l&&($(".mask").show(),f())}else Object(a.g)("请把信息完善！");else Object(a.g)("请选择省市区！")}),$(".footer2 h1").click(function(){if(1==l){$(".mask").show();var e=JSON.stringify({merchantId:s.merchant,sales_no:$('.informationList input[name="salse2"]').val(),payee:u.payee,goods:s.goods,machineId:s.machineId}),t=JSON.stringify({data:r(e)});Object(a.d)("/api/pay/alipay_js","post",t).then(function(e){var t=document.createElement("divForm");t.innerHTML=e.msg.body,document.body.appendChild(t),document.forms[0].acceptCharset="UTF-8",document.forms[0].submit(),$(".mask").hide()}).catch(function(e){$(".mask").hide(),Object(a.g)("下单失败")})}else 2==l&&($(".mask").show(),f())}),$(".cancelFlag p").eq(0).click(function(){window.location.href="placeOrder.html"}),setTimeout(function(e){$(".determineCont h1").html("您已超过2分钟没有提交订单，请关闭页面重新扫码购买。"),$(".determineCont").show()},12e5);var h,g,y="",v=null,b=useState(0),O=(g=2,function(e){if(Array.isArray(e))return e}(h=b)||function(e,t){if("undefined"!=typeof Symbol&&Symbol.iterator in Object(e)){var n=[],a=!0,o=!1,i=void 0;try{for(var r,c=e[Symbol.iterator]();!(a=(r=c.next()).done)&&(n.push(r.value),!t||n.length!==t);a=!0);}catch(e){o=!0,i=e}finally{try{a||null==c.return||c.return()}finally{if(o)throw i}}return n}}(h,g)||function(e,t){if(e){if("string"==typeof e)return o(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?o(e,t):void 0}}(h,g)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}());O[0];(0,O[1])()},693:function(e,t){}});