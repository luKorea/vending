/*! 版权所有，翻版必究 */!function(t){function e(e){for(var a,s,c=e[0],d=e[1],r=e[2],u=0,p=[];u<c.length;u++)s=c[u],Object.prototype.hasOwnProperty.call(o,s)&&o[s]&&p.push(o[s][0]),o[s]=0;for(a in d)Object.prototype.hasOwnProperty.call(d,a)&&(t[a]=d[a]);for(l&&l(e);p.length;)p.shift()();return i.push.apply(i,r||[]),n()}function n(){for(var t,e=0;e<i.length;e++){for(var n=i[e],a=!0,c=1;c<n.length;c++){var d=n[c];0!==o[d]&&(a=!1)}a&&(i.splice(e--,1),t=s(s.s=n[0]))}return t}var a={},o={24:0},i=[];function s(e){if(a[e])return a[e].exports;var n=a[e]={i:e,l:!1,exports:{}};return t[e].call(n.exports,n,n.exports,s),n.l=!0,n.exports}s.m=t,s.c=a,s.d=function(t,e,n){s.o(t,e)||Object.defineProperty(t,e,{enumerable:!0,get:n})},s.r=function(t){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})},s.t=function(t,e){if(1&e&&(t=s(t)),8&e)return t;if(4&e&&"object"==typeof t&&t&&t.__esModule)return t;var n=Object.create(null);if(s.r(n),Object.defineProperty(n,"default",{enumerable:!0,value:t}),2&e&&"string"!=typeof t)for(var a in t)s.d(n,a,function(e){return t[e]}.bind(null,a));return n},s.n=function(t){var e=t&&t.__esModule?function(){return t.default}:function(){return t};return s.d(e,"a",e),e},s.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},s.p="";var c=window.webpackJsonp=window.webpackJsonp||[],d=c.push.bind(c);c.push=e,c=c.slice();for(var r=0;r<c.length;r++)e(c[r]);var l=d;i.push([265,0]),n()}({265:function(t,e,n){"use strict";n.r(e);n(656);layui.use(["table","form","layer"],function(){var t=layui.table,e=layui.form,n=layui.layer,a=sessionStorage.token,o=t.render({elem:"#noticeTable",method:"post",url:"".concat(vApi,"/notices/getNoticeList"),contentType:"application/json",headers:{token:sessionStorage.token},cols:[[{field:"n_number",title:"公告编号",align:"center"},{field:"title",title:"标题",align:"center"},{field:"isShow",title:"是否展示",align:"center",templet:function(t){return 1==t.is_show?"是":"否"}},{field:"status",title:"状态",align:"center",templet:function(t){return 1==t.n_status?"已发布":"草稿箱"}},{field:"attach_name",title:"附件名",align:"center",templet:function(t){return t.attach_name?t.attach_name:"-"}},{field:"attach_url",title:"附件地址",align:"center",templet:function(t){return t.attach_url?'<a href="'.concat(t.attach_url,'" target="_blank" style="color: rgb(190, 149, 74)">').concat(t.attach_url,"</a>"):"-"}},{field:"create_user",title:"创建人",align:"center"},{field:"create_time",title:"创建时间",align:"center",templet:function(t){return timeStamp(t.create_time)}},{field:"operation",title:"操作",align:"center",toolbar:"#barDemo"}]],id:"noticeId",page:!0,loading:!0,request:{pageName:"pageNum",limitName:"pageSize"},where:{},parseData:function(t){return 200==t.code?{code:t.code,msg:t.message,count:t.data.total,data:t.data.list}:403!=t.code?{code:t.code,msg:t.message}:void(window.parent.location.href="login.html")},response:{statusCode:200},done:function(t){}});$(".playHeader .close").click(function(){$(this).parent().parent().addClass("margin0"),$(this).parents(".maskContnet").fadeOut()}),$("body").bind("keydown",function(t){116==t.keyCode&&f5Fun()}),$(".refreshBtn").click(function(){location.reload()}),$(".addPushBtn").click(function(){popupShow("addEditCont","modificationBox")}),$(".addEditCont .cancelBtn").click(function(){popupHide("addEditCont","modificationBox")}),$('.addUploadBtn input[name="addUpload"]').change(function(t){if($(this).val()){var e=this,o=new FormData;o.append("file",t.target.files[0]),$(".mask").fadeIn(),$(".maskSpan").addClass("maskIcon"),$.ajax({type:"post",url:"".concat(vApi,"/fileUpload"),processData:!1,contentType:!1,timeout:1e4,headers:{token:a},data:o,success:function(t){$(".mask").fadeOut(),$(".maskSpan").removeClass("maskIcon"),$(e).val(""),0==t.code?(n.msg("上传成功",{icon:1}),$('.addEditCont input[name="address"]').val(t.data.src)):n.msg(t.message,{icon:7})},error:function(t){$(e).val(""),$(".mask").fadeOut(),$(".maskSpan").removeClass("maskIcon"),n.msg("上传失败",{icon:2})}})}}),$(".addEditCont .delUploadBtn").click(function(){n.confirm("确定删除附件？",function(t){n.close(t),$('.addEditCont input[name="address"]').val(""),n.msg("已删除",{icon:1})})});var i=window.wangEditor,s=new i("#addWangEditor");s.customConfig.customUploadImg=function(t,e){console.log(t);var o=new FormData;o.append("file",t[0]),$.ajax({type:"post",url:"".concat(vApi,"/fileUpload"),processData:!1,contentType:!1,timeout:1e4,headers:{token:a},data:o,success:function(t){0==t.code?e(t.data.src):n.msg(t.message,{icon:7})},error:function(t){n.msg("上传失败",{icon:2})}})},s.create(),$(".addEditCont .readingBtn").click(function(){$(".previewContent .playHeader span").html("公告详情"),$(".previewContent .previewHtml").html(s.txt.html()),popupShow("previewContent","previewBox")}),$(".addEditCont .determinePushBtn").click(function(){var t=this;if($('.addEditCont input[name="title"]').val()&&$('.addEditCont input[name="number"]').val())if(s.txt.html().length>11)if($('.addEditCont input[name="accessoryName"]').val()&&$('.addEditCont input[name="address"]').val()||!$('.addEditCont input[name="accessoryName"]').val()&&!$('.addEditCont input[name="address"]').val()){$(".mask").fadeIn(),$(".maskSpan").addClass("maskIcon");var e=JSON.stringify({n_number:$('.addEditCont input[name="number"]').val(),title:$('.addEditCont input[name="title"]').val(),content:s.txt.html(),isShow:Number($('.addEditCont input[name="indexShow"]:checked').val()),status:Number($(this).attr("pushType")),attach_name:$('.addEditCont input[name="accessoryName"]').val(),attach_url:$('.addEditCont input[name="address"]').val(),merchantId:sessionStorage.machineID});loadingAjax("/notices/addNotice","post",e,sessionStorage.token,"mask","addEditCont","modificationBox",n).then(function(e){n.msg(e.message,{icon:1}),o.reload({where:{}}),1==$(t).attr("pushType")&&1==$('.addEditCont input[name="indexShow"]:checked').val()&&loadingAjax("/pushNotice","post","",sessionStorage.token).then(function(t){}).catch(function(t){}),window.parent.shuffling(),console.log($(t).attr("pushType")),console.log($('.addEditCont input[name="indexShow"]:checked').val()),$('.addEditCont input[name="number"]').val(""),$('.addEditCont input[name="title"]').val(""),s.txt.html(""),$('.addEditCont input[name="accessoryName"]').val(""),$('.addEditCont input[name="address"]').val("")}).catch(function(t){console.log(t),n.msg(t.message,{icon:2})})}else n.msg("附近名与附件地址必须同时填写");else n.msg("公告详情最少五个字",{icon:7});else n.msg("带*号为必填",{icon:7})});var c=new i("#editWangEditor");c.customConfig.customUploadImg=function(t,e){console.log(t);var o=new FormData;o.append("file",t[0]),$.ajax({type:"post",url:"".concat(vApi,"/fileUpload"),processData:!1,contentType:!1,timeout:1e4,headers:{token:a},data:o,success:function(t){0==t.code?e(t.data.src):n.msg(t.message,{icon:7})},error:function(t){n.msg("上传失败",{icon:2})}})},c.create();var d=null,r=null;t.on("tool(noticeTable)",function(t){if(event.stopPropagation(),d=t.data,"operation"===t.event){if(r==t.data.id)return $(".ListOperation").fadeOut(),void(r=null);r=t.data.id,1==d.n_status?$(".ListOperation .edit0").addClass("hide"):$(".ListOperation .edit0").removeClass("hide"),1==d.is_show?$(".ListOperation .dow").html("隐藏"):$(".ListOperation .dow").html("展示"),$(".ListOperation").fadeIn(),$(".ListOperation").css({left:$(this).offset().left-35+"px",top:$(this).offset().top+35+"px"})}}),$(".ListOperation .edit0").click(function(){$('.EditCont input[name="number"]').val(d.n_number),$('.EditCont input[name="title"]').val(d.title),$('.EditCont input[name="indexShow"][value=1]').prop("checked",1==d.is_show),$('.EditCont input[name="indexShow"][value=0]').prop("checked",0==d.is_show),$('.EditCont input[name="accessoryName"]').val(d.attach_name),$('.EditCont input[name="address"]').val(d.attach_url),c.txt.html(d.content),e.render("radio"),popupShow("EditCont","editBox")}),$(".ListOperation .dow").click(function(){n.confirm(1==d.is_show?"确定隐藏？":"确定展示？",function(t){n.close(t);var e=JSON.stringify({n_number:d.n_number,title:d.title,content:d.content,is_show:1==d.is_show?0:1,n_status:d.n_status,attach_name:d.attach_name,attach_url:d.attach_url,merchantId:sessionStorage.machineID,id:d.id});loadingAjax("/notices/updateNotice","post",e,sessionStorage.token,"mask","EditCont","editBox",n).then(function(t){n.msg(t.message,{icon:1}),o.reload({where:{}}),loadingAjax("/pushNotice","post","",sessionStorage.token).then(function(t){}).catch(function(t){})}).catch(function(t){console.log(t),n.msg(t.message,{icon:2})})})}),$(".ListOperation .preview").click(function(){$(".previewContent .playHeader span").html(d.title+"的公告详情"),$(".previewContent .previewHtml").html(d.content),popupShow("previewContent","previewBox")}),$(".EditCont .readingBtn").click(function(){$(".previewContent .playHeader span").html(d.title+"的公告详情"),$(".previewContent .previewHtml").html(c.txt.html()),popupShow("previewContent","previewBox")}),$(".EditCont .cancelBtn").click(function(){popupHide("EditCont","editBox")}),$(".EditCont .editDelUploadBtn").click(function(){n.confirm("确定删除附件？",function(t){n.close(t),$('.EditCont input[name="address"]').val("")})}),$('.EditCont .editUploadBtn input[name="editUpload"]').change(function(t){if($(this).val()){var e=this,o=new FormData;o.append("file",t.target.files[0]),$(".mask").fadeIn(),$(".maskSpan").addClass("maskIcon"),$.ajax({type:"post",url:"".concat(vApi,"/fileUpload"),processData:!1,contentType:!1,timeout:1e4,headers:{token:a},data:o,success:function(t){$(".mask").fadeOut(),$(".maskSpan").removeClass("maskIcon"),$(e).val(""),0==t.code?(n.msg("上传成功"),$('.EditCont input[name="address"]').val(t.data.src)):n.msg(t.message,{icon:7})},error:function(t){$(e).val(""),$(".mask").fadeOut(),$(".maskSpan").removeClass("maskIcon"),n.msg("上传失败",{icon:2})}})}}),$(".EditCont .determinePushBtn").click(function(){var t=this;if($('.EditCont input[name="title"]').val()&&$('.EditCont input[name="number"]').val())if(!s.txt.html().length>11)n.msg("公告详情最少五个字",{icon:7});else if($('.EditCont input[name="accessoryName"]').val()&&$('.EditCont input[name="address"]').val()||!$('.EditCont input[name="accessoryName"]').val()&&!$('.EditCont input[name="address"]').val()){console.log($('.addEditCont input[name="push"]:checked').val());var e=JSON.stringify({n_number:$('.EditCont input[name="number"]').val(),title:$('.EditCont input[name="title"]').val(),content:c.txt.html(),is_show:Number($('.EditCont input[name="indexShow"]:checked').val()),n_status:Number($(this).attr("pushType")),attach_name:$('.EditCont input[name="accessoryName"]').val(),attach_url:$('.EditCont input[name="address"]').val(),merchantId:sessionStorage.machineID,id:d.id});loadingAjax("/notices/updateNotice","post",e,sessionStorage.token,"mask","EditCont","editBox",n).then(function(e){n.msg(e.message,{icon:1}),o.reload({where:{}}),1==$(t).attr("pushType")&&loadingAjax("/pushNotice","post","",sessionStorage.token).then(function(t){}).catch(function(t){})}).catch(function(t){console.log(t),n.msg(t.message,{icon:2})})}else n.msg("附近名与附件地址必须同时填写");else n.msg("带*号为必填",{icon:7})}),$(".queryBtn").click(function(){o.reload({where:{keyword:$('.key-contnet input[name="keyMerchants"]').val()}})}),$("body").click(function(){$(".ListOperation").fadeOut(),r=null})})},656:function(t,e){}});