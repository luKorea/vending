/*! 版权所有，翻版必究 */!function(e){function o(o){for(var a,d,s=o[0],r=o[1],l=o[2],g=0,p=[];g<s.length;g++)d=s[g],Object.prototype.hasOwnProperty.call(n,d)&&n[d]&&p.push(n[d][0]),n[d]=0;for(a in r)Object.prototype.hasOwnProperty.call(r,a)&&(e[a]=r[a]);for(c&&c(o);p.length;)p.shift()();return i.push.apply(i,l||[]),t()}function t(){for(var e,o=0;o<i.length;o++){for(var t=i[o],a=!0,s=1;s<t.length;s++){var r=t[s];0!==n[r]&&(a=!1)}a&&(i.splice(o--,1),e=d(d.s=t[0]))}return e}var a={},n={11:0},i=[];function d(o){if(a[o])return a[o].exports;var t=a[o]={i:o,l:!1,exports:{}};return e[o].call(t.exports,t,t.exports,d),t.l=!0,t.exports}d.m=e,d.c=a,d.d=function(e,o,t){d.o(e,o)||Object.defineProperty(e,o,{enumerable:!0,get:t})},d.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},d.t=function(e,o){if(1&o&&(e=d(e)),8&o)return e;if(4&o&&"object"==typeof e&&e&&e.__esModule)return e;var t=Object.create(null);if(d.r(t),Object.defineProperty(t,"default",{enumerable:!0,value:e}),2&o&&"string"!=typeof e)for(var a in e)d.d(t,a,function(o){return e[o]}.bind(null,a));return t},d.n=function(e){var o=e&&e.__esModule?function(){return e.default}:function(){return e};return d.d(o,"a",o),o},d.o=function(e,o){return Object.prototype.hasOwnProperty.call(e,o)},d.p="";var s=window.webpackJsonp=window.webpackJsonp||[],r=s.push.bind(s);s.push=o,s=s.slice();for(var l=0;l<s.length;l++)o(s[l]);var c=r;i.push([244,0]),t()}({244:function(e,o,t){"use strict";t.r(o);t(608);layui.use(["table","form","layer","layedit","tree"],function(){var e=layui.jquery,o=layui.tree,t=window.parent.permissionsData1(),a=permissionsVal1({377:!1,378:!1,375:!1,416:!1,415:!1,461:!1},t);function n(){a[377]?e(".add-btn").removeClass("hide"):e(".add-btn").addClass("hide"),a[378]?e(".ListOperation .edit").removeClass("hide"):e(".ListOperation .edit").addClass("hide"),a[375]?e(".ListOperation .del").removeClass("hide"):e(".ListOperation .del").addClass("hide"),a[416]?e(".pushGoodsBtn").removeClass("hide"):e(".pushGoodsBtn").addClass("hide"),a[415]?e(".pushListBtn").removeClass("hide"):e(".pushListBtn").addClass("hide"),a[461]?e(".syncBtn").removeClass("hide"):e(".syncBtn").addClass("hide")}n(),e(".sidebar i").click(function(){e(".left-mian").hide(),e(".on-left").show()}),e(".on-left").click(function(){e(".left-mian").show(),e(".on-left").hide()});var i=layui.table,d=window.wangEditor,s=sessionStorage.token+"",r=i.render({elem:"#tableTest",url:"".concat(vApi,"/goods/findAll"),method:"post",contentType:"application/json",headers:{token:s},cols:[[{align:"center",type:"checkbox",fixed:"left"},{field:"goods_images",width:100,title:"图片",templet:"#imgtmp",align:"center",fixed:"left"},{field:"goods_Core",width:180,title:"商品编号",align:"center",fixed:"left"},{fixed:"left",field:"goods_Name",width:200,title:"商品名",color:"#409eff",align:"center",templet:function(e){return 1==e.mail?"(邮寄)"+e.goods_Name:e.goods_Name}},{field:"mail",width:120,title:"是否邮寄商品",align:"center",templet:function(e){return 0==e.mail?"否":"是"}},{field:"goods_Status",width:120,title:"商品状态",align:"center",templet:function(e){return 1==e.goods_Status?"启用":"不启用"}},{field:"classifyName",width:120,title:"商品类目",align:"center"},{field:"goods_Price",width:120,align:"center",title:"销售价 ",templet:function(e){return percentileMoney(e.goods_Price)}},{field:"goods_Cost",width:120,align:"center",title:"成本价 ",templet:function(e){return percentileMoney(e.goods_Cost)}},{field:"goods_Param",width:120,title:"规格说明 ",align:"center"},{field:"create_user",width:130,title:"创建人 ",align:"center"},{field:"goods_Time",width:200,title:"创建时间 ",align:"center",templet:function(e){return e.goods_Time?timeStamp(e.goods_Time):"-"}},{field:"update_user",width:130,title:"最后修改人 ",align:"center"},{field:"update_time",width:200,title:"最后修改时间 ",align:"center",templet:function(e){return e.update_time?timeStamp(e.update_time):"-"}},{field:"operation",fixed:"right",align:"center",position:"absolute",right:0,width:150,title:"操作",toolbar:"#barDemo"}]],id:"tableId",page:!0,loading:!0,limits:[100,50,20,10],request:{pageName:"pageNum",limitName:"pageSize"},where:{condition:sessionStorage.machineID},parseData:function(e){return 200==e.code?{code:e.code,msg:"",count:e.data.total,data:e.data.list}:{code:e.code,msg:e.message}},response:{statusCode:200},done:function(o){n(),403==o.code?window.parent.location.href="login.html":405==o.code&&e(".hangContent").show(),fixedFun()}});function l(){e(".relationRules").hide()}e(".relation").click(function(){console.log(f,"relationData"),e(".text").html("".concat(f.info," 关联分则规则")),e(".relationRules").show()}),e(".relationBtn").click(function(){var e=c.val("relationRules");e.machineId=machineSetData.machineId,e.payId=machineSetData.payType,loadingAjax("/accSplit/associationRule","post",JSON.stringify(e),s).then(function(e){200===e.code?(layer.msg("关联成功",{icon:1}),machineList.reload({where:{}}),l()):layer.msg("失败",{icon:2})}).catch(function(e){layer.msg(e,{icon:2})})}),e(".relationRules .cancelBtn").click(function(){l()});var c=layui.form;function g(o,t){loadingAjax("/classify/findAll","post",JSON.stringify({pageNum:1,pageSize:200,merchantId:o}),sessionStorage.token).then(function(o){var a='<option value="">全部</option>';1==t&&e("#addGoodsType").empty(),e("#EditGoodsType").empty(),e("#GoodsType").empty(),e.each(o.data.list,function(e,o){a+='<option value="'.concat(o.classifyId,'">').concat(o.classifyName,"</option>")}),1==t&&e("#addGoodsType").append(a),e("#EditGoodsType").append(a),e("#GoodsType").append(a),c.render("select")}).catch(function(e){})}g(sessionStorage.machineID,1);var p="";c.on("select(mySelect1)",function(e){console.log(e),p=e.value});var m="";c.on("select(stateSelect)",function(e){m=e.value}),e(".query-btnClick").click(function(){r.reload({where:{conditionTwo:e(".KyeText").val(),conditionThree:p,conditionFour:m}})});var u=null,h=null,f=null,y=null,v=null;i.on("tool(test)",function(o){if(event.stopPropagation(),f=o.data,v=o,"operation"===o.event){if(y==o.data.goods_Id)return e(".ListOperation").fadeOut(),void(y=null);y=o.data.goods_Id,e(".ListOperation").fadeIn(),e(".ListOperation").css({left:e(this).offset().left-35+"px",top:e(this).offset().top+35+"px"})}}),e(".ListOperation .edit").click(function(){e(".anUp").slideUp(),popupShow("editor","editor-content"),e(".editor").scrollTop(0),c.val("EditValData",{goodsBarcode:f.goods_Core,goodsName:f.goods_Name,goodsType:f.classify_Id,goodsPrice:f.goods_Price,goodsCost:f.goods_Cost,goodsParam:f.goods_Param,goodsStatus:f.goods_Status}),console.log(f.mail,"hdkjfksjdhfkjsdhfjk"),1==f.mail?e('.editor input[name="editmail"]').prop("checked",!0):e('.editor input[name="editmail"]').prop("checked",!1),e("#editImg").attr("src",f.goods_images);var o=f.goods_Descript.replace(/video/g,"iframe");w.txt.html(o),c.render()}),e(".ListOperation .goodsPreview").click(function(){popupShow("reading","margin0"),e(".reading .playHeader span").html("商品详情页预览"),e(".reading-box").html(f.goods_Descript)}),e(".ListOperation .del").click(function(){layer.confirm("确定删除？",function(e){Goodsdel(f.goods_Id,1,v,e)})}),e(".upload-btn1").click(function(){h=1,b=1,I=0,C(),popupShow("GoodsMaterial","goodsMaterialBox")});var w=new d("#editWangEditor");w.customConfig.uploadImgHooks={error:function(e,o){layer.msg("图片上传失败")}},w.create(),e(".editDetermine-btn").click(function(){null;var o=c.val("EditValData");if(console.log(o),o.goodsParam&&o.goodsBarcode&&o.goodsName&&o.goodsType&&o.goodsPrice){if(!(o.goodsPrice>0))return void layer.msg("同一销售价必须大于0",{icon:7});var t=w.txt.html().replace(/iframe/g,'video  controls="false"'),a=JSON.stringify({goods_Id:f.goods_Id,goods_Core:o.goodsBarcode,goods_Name:o.goodsName,classify_Id:o.goodsType,brand:o.goodsBrand,goods_Price:o.goodsPrice,goods_Cost:o.goodsCost?o.goodsCost:0,goods_Param:o.goodsParam,goods_Status:o.goodsStatus,goods_Images:e("#editImg").attr("src"),goods_Descript:t,mail:e('.editor input[name="editmail"]').prop("checked")?1:0});e(".mask").fadeIn(),e(".maskSpan").addClass("maskIcon"),loadingAjax("/goods/updateGoods","post",a,sessionStorage.token,"mask","","",layer).then(function(o){layer.msg("修改成功",{icon:1}),t="",e(".editor").fadeOut(),r.reload({where:{}})}).catch(function(e){layer.msg(e.message,{icon:2})})}else layer.msg("带*为必填",{icon:7})}),e(".preferential .cancel-btn").on("click",function(){e(".preferential").fadeOut(),null}),layui.layedit.set({uploadImage:{url:"".concat(vApi,"/fileUpload"),headers:{token:s},type:"post",code:200}}),e(".editor .cancel-btn").click(function(){e(".editor").fadeOut(),null});var k=null,b=null;e(".add-btn").click(function(){popupShow("addGoods","editor-content"),e(".addGoods").scrollTop(0),e(".tailoring-container").fadeIn()}),e(".addGoods .cancel-btn2").click(function(){popupHide("addGoods","editor-content"),e(".upload-demo2 .upload-list2").fadeOut()}),e(".upload-btn2").click(function(){h=2,b=1,I=0,C(),popupShow("GoodsMaterial","goodsMaterialBox")});var x=new d("#addWangEditor");x.customConfig.menus=["head","bold","fontSize","fontName","italic","underline","strikeThrough","foreColor","backColor","link","list","justify","quote","emoticon","image","table","video","undo","redo"],x.customConfig.uploadImgHooks={error:function(e,o){layer.msg("图片上传失败")}};var S=null;e(".upVideo").click(function(o){S=e(this).attr("typeID"),popupShow("goodsmaterialVideo","materialBox"),N||(N=i.render({elem:"#materiaVideoTable",method:"post",url:"".concat(vApi,"/good_material/getGoodMaterial"),contentType:"application/json",headers:{token:s},cols:[[{field:"name",title:"视频名",align:"center"},{field:"publishTime",title:"发布时间",align:"center"},{field:"addUser",title:"发布人",align:"center"},{field:"operation",title:"操作",toolbar:"#barDemoVideo",align:"center"}]],page:!0,id:"VideoListData",loading:!0,request:{pageName:"pageNum",limitName:"pageSize"},where:{conditionFour:"1",conditionFive:"2",conditionSix:B},parseData:function(e){return 200==e.code?{code:e.code,msg:"",count:e.data.total,data:e.data.list}:{code:e.code,msg:e.message}},response:{statusCode:200},done:function(e){403==e.code&&(window.parent.location.href="login.html")}}))}),x.create(),e(".determine-btn2").click(function(){var o=c.val("addValData");if(console.log(o),console.log(e('.addGoods input[name="mail"]')),console.log(e('.addGoods input[name="mail"]').prop("checked")),o.goodsParam&&o.goodsBarcode&&o.goodsName&&o.goodsType&&o.goodsPrice)if(k){if(!(o.goodsPrice>0))return void layer.msg("同一销售价必须大于0",{icon:7});var t=x.txt.html().replace(/iframe/g,'video controls="false"'),a=JSON.stringify({goods_Core:o.goodsBarcode,goods_Name:o.goodsName,classify_Id:o.goodsType,brand:o.goodsBrand,goods_Price:o.goodsPrice,goods_Cost:o.goodsCost?o.goodsCost:0,goods_Param:o.goodsParam,goods_Status:o.goodsStatus,goods_Images:k,goods_Descript:t,merchantId:sessionStorage.machineID,mail:e('.addGoods input[name="mail"]').prop("checked")?1:0});e(".mask").fadeIn(),e(".maskSpan").addClass("maskIcon"),loadingAjax("/goods/saveGoods","post",a,sessionStorage.token,"mask","","",layer).then(function(o){e(".addGoods").fadeOut(),e(".upload-demo2 .upload-list2").fadeOut(),k=null,c.val("addValData",{goodsBarcode:"",goodsName:"",goodsType:"",goodsBrand:"",goodsPrice:"",goodsCost:0,goodsParam:""}),t="",layer.msg("添加成功",{icon:1}),r.reload({where:{}}),x.txt.clear()}).catch(function(e){layer.msg(e.message,{icon:2})})}else layer.msg("请上传商品图片",{icon:7});else layer.msg("带*为必填",{icon:7})}),e(".reading-btn").click(function(){popupShow("reading","margin0"),"add"==e(this).attr("id")?(e(".reading").fadeIn(),e(".reading .playHeader span").html("商品详情页预览"),e(".reading-box").html(x.txt.html())):"edit"==e(this).attr("id")&&(e(".reading .playHeader span").html("商品详情页预览"),e(".reading-box").html(w.txt.html()))}),e(".reading-down").click(function(){e(".Goods-wrap").removeClass("fixed"),e(".reading").fadeOut(),null}),e(".playHeader .close").click(function(){e(this).parent().parent().addClass("margin0"),e(this).parents(".maskContnet").fadeOut(),null});var I=null,_=null;function C(){_=i.render({elem:"#materiaImgTable",method:"post",url:"".concat(vApi,"/good_material/getGoodMaterial"),contentType:"application/json",headers:{token:s},cols:[[{field:"img",title:"图片",align:"center",templet:"#materiaImgtmp"},{field:"name",title:"图片名",align:"center"},{field:"publishTime",title:"发布时间",align:"center"},{field:"addUser",title:"发布人",align:"center"},{field:"operationa",right:0,align:"center",width:100,title:"操作",toolbar:"#materiaImg",fixed:"right"}]],page:!0,id:"ImgListData",loading:!0,request:{pageName:"pageNum",limitName:"pageSize"},parseData:function(e){return 200==e.code?{code:e.code,msg:"",count:e.data.total,data:e.data.list}:{code:e.code,msg:e.message}},where:{conditionFour:I,conditionFive:"2",conditionSix:B},response:{statusCode:200},done:function(e){403==e.code&&(window.parent.location.href="login.html")}})}e(".materialKeyCont .queryBtnClick").click(function(){console.log(e('.materialKeyCont input[name="KyeText"]').val()),_.reload({where:{conditionFour:I,conditionFive:"2",conditionThree:e('.materialKeyCont input[name="KyeText"]').val()}})}),e(".goodsmaterialVideo .queryBtnClick").click(function(){N.reload({where:{conditionFour:"1",conditionFive:"2",conditionThree:e('.goodsmaterialVideo input[name="KyeText"]').val()}})}),i.on("tool(materiaImgTable)",function(o){"add"==o.event?1==b?2==h?(k=o.data.img,e("#GoodsImg").attr("src",k),e(".upload-demo2 .upload-list2").fadeIn(),popupHide("GoodsMaterial","goodsMaterialBox")):(u=o.data.img,e("#editImg").attr("src",u),popupHide("GoodsMaterial","goodsMaterialBox")):(2==h?x.txt.html().length>11?x.txt.append('<p style="text-align: center;"><img src="'.concat(o.data.img,'"></img></p>')):x.txt.html('<p style="text-align: center;"><img src="'.concat(o.data.img,'"></img></p>')):w.txt.html().length>11?w.txt.append('<p style="text-align: center;"><img src="'.concat(o.data.img,'"></img></p>')):w.txt.html('<p style="text-align: center;"><img src="'.concat(o.data.img,'"></img></p>')),popupHide("GoodsMaterial","goodsMaterialBox")):"previewD"==o.event&&(popupShow("reading","margin0"),e(".reading .playHeader span").html("商品图片预览"),e(".reading-box").html('<img src="'.concat(o.data.img,'"/>')))});var N=null;i.on("tool(materiaVideoTable)",function(o){console.log(o),"preview"==o.event?(popupShow("materialPreview","previewBox"),e(".perviewBody video").attr("src",o.data.img),console.log(S)):(console.log(S),2==S?(x.txt.html().length>11?x.txt.append('<div><iframe src="'.concat(o.data.img,'"></iframe></div>')):x.txt.html('<div><iframe src="'.concat(o.data.img,'"></iframe></div>')),popupHide("goodsmaterialVideo","materialBox")):(w.txt.html().length>11?w.txt.append('<div><iframe src="'.concat(o.data.img,'"></iframe></div>')):w.txt.html('<div><iframe src="'.concat(o.data.img,'"></iframe></div>')),popupHide("goodsmaterialVideo","materialBox")))}),e(".upImg").click(function(){b=e(this).attr("contType"),h=e(this).attr("goodsIndex"),I=2,popupShow("GoodsMaterial","goodsMaterialBox"),C()}),e(".refreshBtnList").click(function(){var e=treeList();JSON.stringify(e)!=JSON.stringify(P)?(D(o,"testGoods",r,P=e,"condition","goodsClass",g),r.reload({where:{condition:sessionStorage.machineID}}),layer.msg("已刷新",{icon:1})):layer.msg("已刷新",{icon:1})});var T,B=sessionStorage.machineID,P=T=treeList();function D(o,t,n,i,d,s,r){o.render({elem:"#".concat(t),id:"treelist",showLine:!0,onlyIconControl:!0,data:i,spread:!0,text:{defaultNodeName:"无数据",none:"您没有权限，请联系管理员授权!"},click:function(o){a[377]&&(o.data.id==sessionStorage.machineID?e(".add-btn").show():e(".add-btn").hide()),B=o.data.id+"",s&&r(o.data.id+""),n.reload({where:function(e,o,t){return o in e?Object.defineProperty(e,o,{value:t,enumerable:!0,configurable:!0,writable:!0}):e[o]=t,e}({},d,o.data.id+"")});for(var i=e("#".concat(t," .layui-tree-txt")),l=0;l<i.length;l++)i[l].innerHTML===o.data.title?i[l].style.color="#be954a":i[l].style.color="#555"}})}D(o,"testGoods",r,P,"condition","goodsClass",g);var O=null;var G=null,M=null;e(".pushGoodsBtn").click(function(){M=i.checkStatus("tableId"),console.log(M),M.data.length>0?(leg.tree({ele:".treeList",data:T,cascade:!1}),popupShow("chooseLower","chooseBox"),e.each(e(".treeList input"),function(){M.data[0].merchantId!=e(this).val()||e(this).prop("disabled",!0)})):layer.msg("请选择需要推送的商品",{icon:7})});var L=null;e(".determineBtn").click(function(){L=leg.getCheckedNodes().map(Number),console.log(leg.getCheckedNodes()),0!=L.length?(popupShow("PushMandatory","MandatoryBox"),console.log(M)):layer.msg("请选择要推送的商户",{icon:7})}),e(".mandatroFooter div").click(function(){var o=[];G=e(this).attr("Ptype"),e(".mask").fadeIn(),e(".maskSpan").addClass("maskIcon"),M.data.forEach(function(e,t){var a={className:e.classifyName,goodsId:e.goods_Id};o.push(a)});var t=JSON.stringify({goods:o,merchantId:sessionStorage.machineID,mid:L,type:G});loadingAjax("/goods/sendGoods","post",t,s,"mask","chooseLower","chooseBox",layer).then(function(e){console.log(e),O&&O.reload({where:{}}),popupHide("PushMandatory","MandatoryBox"),layer.msg(e.message,{icon:1})}).catch(function(o){e(".mask").fadeOut(),e(".maskSpan").removeClass("maskIcon"),popupHide("PushMandatory","MandatoryBox"),layer.msg(o.message,{icon:2})})}),e(".chooseFooter .chooseCan").click(function(){popupHide("chooseLower","chooseBox")}),e(".pushListBtn").click(function(){popupShow("topGoodsList","topBox"),O||setTimeout(function(){O=i.render({elem:"#parentTableTest",url:"".concat(vApi,"/goods/getSendHistory"),method:"post",height:500,contentType:"application/json",headers:{token:s},cols:[[{type:"checkbox"},{field:"goods_images",title:"图片",templet:"#Listimgtmp",align:"center"},{field:"goods_Name",title:"商品名",color:"#409eff",align:"center",templet:function(e){return 1==e.mail?"(邮寄)"+e.goods_Name:e.goods_Name}},{field:"classifyName",title:"商品类目",align:"center"},{field:"tempMerchant",title:"商品所属商户",align:"center"},{field:"topMerchant",title:"推送商户",align:"center"},{field:"targetMerchant",title:"接收商户",align:"center"},{field:"goods_Param",title:"接收状态 ",align:"center",templet:function(e){return 0==e.received?"未接收":"已接收"}},{field:"sendTime",title:"推送时间 ",align:"center",templet:function(e){var o=new Date(e.sendTime);return o.getFullYear()+"-"+(o.getMonth()+1)+"-"+(e=o.getDate())+" "+o.getHours()+":"+o.getMinutes()+":"+o.getSeconds()}}]],id:"parentTableId",page:!0,loading:!0,limits:[10,20,50],request:{pageName:"pageNum",limitName:"pageSize"},where:{condition:sessionStorage.machineID,conditionFour:"0"},parseData:function(e){return 200==e.code?{code:e.code,msg:"",count:e.data.total,data:e.data.list}:{code:e.code,msg:e.message}},response:{statusCode:200},done:function(o){for(var t in 403==o.code&&(window.parent.location.href="login.html"),o.data){var a=o.data[t];console.log(a.childMerchantId),a.childMerchantId==sessionStorage.machineID&&1!=a.received||(e(".list_table1 tr[data-index="+t+'] input[type="checkbox"]').prop("disabled",!0),c.render())}}})},500)}),e(".topBody .pushQueryBtn").click(function(){O.reload({where:{conditionTwo:e('.topBody select[name="mandatory"]').val(),conditionThree:e('.topBody select[name="receiveStatus"]').val(),conditionFour:e('.topBody select[name="receiveType"]').val(),goods_Name:e('.topBody input[name="KyeText"]').val()}})}),e(".topBody .pushGoodsListBtn").click(function(){var o=i.checkStatus("parentTableId");console.log(o);var t=[];if(o.data.length>0){if(o.data.forEach(function(e,o){if(e.childMerchantId==sessionStorage.machineID&&0==e.received){var a={className:e.classifyName,goodsId:e.goods_Id,merchantId:sessionStorage.machineID};t.push(a)}}),!(t.length>0))return void layer.msg("没有能接收的商品",{icon:7});e(".mask").fadeIn(),e(".maskSpan").addClass("maskIcon");var a=JSON.stringify({goods:t,merchantId:sessionStorage.machineID});loadingAjax("/goods/forwardGoods","post",a,sessionStorage.token,"mask","topGoodsList","topBox",layer).then(function(e){console.log(e),layer.msg(e.message,{icon:1}),r.reload({where:{}}),O.reload({where:{}})}).catch(function(o){e(".mask").fadeOut(),e(".maskSpan").removeClass("maskIcon"),layer.msg(o.message,{icon:2})})}else layer.msg("请选择接收的商品",{icon:7})}),e("body").bind("keydown",function(e){116==e.keyCode&&(e.preventDefault(),location.reload())}),e(".syncBtn").click(function(){popupShow("synchronousCont","synchronousBox"),e(".synchronousGoodsName").val(),e(".synchronousMachineName").val(),j=i.render({elem:"#cGoodsTable",url:"".concat(vApi,"/goods/findAll"),method:"post",contentType:"application/json",headers:{token:s},cols:[[{checkbox:!0},{field:"goods_images",title:"图片",templet:"#imgtmp",align:"center"},{field:"goods_Core",title:"商品编号",align:"center"},{field:"goods_Name",title:"商品名",color:"#409eff",align:"center",templet:function(e){return 1==e.mail?"(邮寄)"+e.goods_Name:e.goods_Name}},{field:"goods_Price",align:"center",title:"销售价 ",templet:function(e){return percentileMoney(e.goods_Price)}},{field:"mail",title:"是否邮寄商品",align:"center",templet:function(e){return 0==e.mail?"否":"是"}}]],id:"goodsTableS",page:!0,loading:!0,request:{pageName:"pageNum",limitName:"pageSize"},where:{condition:sessionStorage.machineID},parseData:function(e){return 200==e.code?{code:e.code,msg:"",count:e.data.total,data:e.data.list}:{code:e.code,msg:e.message}},response:{statusCode:200},done:function(o){n(),403==o.code?window.parent.location.href="login.html":405==o.code&&e(".hangContent").show()}}),H=i.render({elem:"#machineTable",url:"".concat(vApi,"/machine/getMachineList"),method:"post",contentType:"application/json",headers:{token:s},cols:[[{checkbox:!0},{field:"number",title:"售货机编号",align:"center",templet:function(e){return e.number?e.number:"-"}},{field:"info",title:"售货机信息",align:"center",templet:function(e){return e.info?"<div>".concat(e.info,"</div>"):'<div><span style="color:red;">*</span>(售货机为新上线机器，请编辑售货机信息！)</div>'}},{field:"location",title:"地址",align:"center",templet:function(e){return e.location?e.location:" - "}}]],id:"machineIDTable",page:!0,loading:!0,limits:[10,20,50,100],request:{pageName:"pageNum",limitName:"pageSize"},where:{merchantId:sessionStorage.machineID},parseData:function(e){return 200==e.code?{code:e.code,msg:e.message,count:e.data.total,data:e.data.list}:{code:e.code,msg:e.message}},response:{statusCode:200},done:function(o){n(),403==o.code?window.parent.location.href="login.html":405==o.code&&e(".hangContent").show()}})});var j=null;e(".synchronousGoodsQuery").click(function(){j.reload({where:{conditionTwo:e(".synchronousGoodsName").val()}})});var H=null;e(".synchronousMachineQuery").click(function(){H.reload({where:{keyword:e(".synchronousMachineName").val()}})}),e(".synchronousCont .synchronousCancel").click(function(){popupHide("synchronousCont","synchronousBox")}),e(".synchronousCont .synchronousBtn").click(function(){var e=i.checkStatus("goodsTableS").data,o=i.checkStatus("machineIDTable").data;console.log(e),console.log(o),0!=e.length&&0!=o.length?layer.confirm("确定同步价格？",function(t){layer.close(t);var a=[],n=[];e.forEach(function(e){var o={goodId:e.goods_Id,price:e.goods_Price};a.push(o)}),o.forEach(function(e){var o={machineId:e.machineId};n.push(o)});var i=JSON.stringify({goods:a,machines:n});loadingAjax("/goods/syncPrice","post",i,sessionStorage.token).then(function(e){layer.msg(e.message,{icon:1}),j.reload({where:{}}),H.reload({where:{}}),popupHide("synchronousCont","synchronousBox")}).catch(function(e){layer.msg(e.message,{icon:2}),console.log(e)})}):layer.msg("请选择需要同步价格的商品与售货机",{icon:7})});var A=!0;e("body").on("mouseenter",".pic102",function(o){e("#pic101").attr("src",e(this).attr("src"));var t=new Image;t.onload=function(){e("#pic101").css({width:this.width>=this.height?"335px":"auto",height:this.height>this.width?"450px":"auto"}).fadeIn("fast"),this.onload=null},t.src=e(this).attr("src")}),e(".Goods-wrap").on("click",".pic102",function(){event.stopPropagation(),A=!1}),e("body").on("mouseleave",".pic102",function(){A&&e("#pic101").hide()}),e("#pic101").click(function(){event.stopPropagation()}),e("body").click(function(){A=!0,e("#pic101").hide(),e(".ListOperation").fadeOut(),y=null}),e("#pic101").mouseenter(function(){e("#pic101").show()}),e("#pic101").mouseleave(function(){A&&e("#pic101").hide()})})},608:function(e,o){}});