/*! 版权所有，翻版必究 */!function(e){function t(t){for(var a,c,r=t[0],s=t[1],l=t[2],u=0,d=[];u<r.length;u++)c=r[u],Object.prototype.hasOwnProperty.call(o,c)&&o[c]&&d.push(o[c][0]),o[c]=0;for(a in s)Object.prototype.hasOwnProperty.call(s,a)&&(e[a]=s[a]);for(p&&p(t);d.length;)d.shift()();return i.push.apply(i,l||[]),n()}function n(){for(var e,t=0;t<i.length;t++){for(var n=i[t],a=!0,r=1;r<n.length;r++){var s=n[r];0!==o[s]&&(a=!1)}a&&(i.splice(t--,1),e=c(c.s=n[0]))}return e}var a={},o={34:0},i=[];function c(t){if(a[t])return a[t].exports;var n=a[t]={i:t,l:!1,exports:{}};return e[t].call(n.exports,n,n.exports,c),n.l=!0,n.exports}c.m=e,c.c=a,c.d=function(e,t,n){c.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:n})},c.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},c.t=function(e,t){if(1&t&&(e=c(e)),8&t)return e;if(4&t&&"object"==typeof e&&e&&e.__esModule)return e;var n=Object.create(null);if(c.r(n),Object.defineProperty(n,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var a in e)c.d(n,a,function(t){return e[t]}.bind(null,a));return n},c.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return c.d(t,"a",t),t},c.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},c.p="";var r=window.webpackJsonp=window.webpackJsonp||[],s=r.push.bind(r);r.push=t,r=r.slice();for(var l=0;l<r.length;l++)t(r[l]);var p=s;i.push([266,0]),n()}({266:function(e,t,n){"use strict";n.r(t);n(640);layui.use(["table","form","layer","laydate","tree"],function(){var e=window.parent.permissionsData1(),t=+sessionStorage.machineID,n=permissionsVal1({436:!1,437:!1,446:!1},e);function a(){n[436]?$(".addSalesBtn").removeClass("hide"):$(".addSalesBtn").addClass("hide"),n[437]?$(".pushImportBtn").removeClass("hide"):$(".pushImportBtn").addClass("hide"),n[446]?$(".delBtn").removeClass("hide"):$(".delBtn").addClass("hide")}a();var o=layui.table,i=layui.layer,c=layui.form,r=layui.tree,s=sessionStorage.token;$(".sidebar i").click(function(){$(".left-mian").hide(),$(".on-left").show()}),$(".on-left").click(function(){$(".left-mian").show(),$(".on-left").hide()}),$(".playHeader .close").click(function(){h(),$(this).parent().parent().addClass("margin0"),$(this).parents(".maskContnet").fadeOut()}),$("body").bind("keydown",function(e){116==e.keyCode&&f5Fun()}),$(".refreshBtn").click(function(){location.reload()});var l=o.render({elem:"#salesTable",method:"post",url:"".concat(vApi,"/accSplit/getReceiverList"),contentType:"application/json",headers:{token:s},height:600,cols:[[{field:"accsplitMerName",title:"接收方名称",align:"center"},{field:"accountName",title:"户名",align:"center"},{field:"merType",title:"接收方类型",align:"center",templet:function(e){return"01"===e.merType?"个人":"企业"}},{field:"account",title:"账号",align:"center"},{field:"accountNature",title:"账户属性",align:"center",templet:function(e){return"1"===e.accountNature?"对公":"对私"}},{field:"accountType",title:"账户类型",align:"center",templet:function(e){return accountType(e.accountType)}},{field:"payee",title:"收款账户",align:"center"},{field:"effectiveDate",title:"生效时间",align:"center"},{field:"expiryDate",title:"失效时间",align:"center"},{field:"accountBank",title:"开户行",align:"center"},{field:"status",title:"状态",align:"center",templet:function(e){return"1"===e.status?"启用":"禁用"}},{field:"operation",align:"center",title:"操作",toolbar:"#barDemo"}]],id:"salesId",page:!0,loading:!0,request:{pageName:"pageNum",limitName:"pageSize"},where:{merchantId:t},parseData:function(e){return 200==e.code?{code:e.code,msg:e.message,count:e.data.total,data:e.data.list}:403!=e.code?{code:e.code,msg:e.message}:void(window.parent.location.href="login.html")},response:{statusCode:200},done:function(e){403==e.code?window.parent.location.href="login.html":405==e.code&&$(".hangContent").show(),a()}}),p=null,u=1;function d(){var e=new Date;return e.getFullYear()+"-"+(e.getMonth()+1<10?"0"+(e.getMonth()+1):e.getMonth()+1)+"-"+(e.getDate()<10?"0"+e.getDate():e.getDate())+" "+(e.getHours()<10?"0"+e.getHours():e.getHours())+":"+(e.getMinutes()<10?"0"+e.getMinutes():e.getMinutes())+":"+(e.getSeconds()<10?"0"+e.getSeconds():e.getSeconds())}function f(e){return new Promise(function(t,n){loadingAjax("/accSplit/getAccRec","post",JSON.stringify({pageNum:1,pageSize:200,merchantId:e}),s).then(function(e){var n="";$.each(e.data,function(e,t){n+='<option value="'.concat(t.id,'">').concat(t.payee,"</option>")}),$("#payId").html(n),c.render("select"),t(e)}).catch(function(e){n(e)})}).catch(function(e){return Promise.reject(e)})}o.on("tool(salesTable)",function(e){p=e.data,console.log(p),event.stopPropagation(),"operation"===e.event&&(e.data.id,$(".ListOperation").fadeIn(),$(".ListOperation").css({left:$(this).offset().left-35+"px",top:$(this).offset().top+35+"px"}))}),c.on("radio(merType)",function(e){"01"===e.value?($(".personal").show(),$(".enterprise").hide()):($(".personal").hide(),$(".enterprise").show())}),c.on("radio(accountNature)",function(e){"1"===e.value?$(".accountType").show():$(".accountType").hide()}),$(".queryBtn").click(function(){l.reload({where:{keyword:$(".KyeText").val().trim()}})});$(".addSalesBtn").click(function(){$(".J-datepicker-range").datePicker({hasShortcut:!0,min:d(),max:"",isRange:!0,hide:function(e){this.$input.eq(0).val(),this.$input.eq(1).val()}}),u=1,$(".text").html("新增接收方"),f(t).then(function(e){popupShow("addSalesCont","addSalesBox")}).catch(function(e){var t=e.flag;console.log(t),i.msg("该商户不具备新增接收方的功能，请先配置对应的杉德支付方式",{icon:7})})});var m=null;function h(){$('input[name="merType"]').prop("disabled",!1),$('select[name="businessLicenseType"]').prop("disabled",!1),$('input[name="businessLicense"]').prop("disabled",!1),$('select[name="userPapersType"]').prop("disabled",!1),$('select[name="payId"]').prop("disabled",!1),$('input[name="papersNo"]').prop("disabled",!1),c.val("formData",{account:"",accountBank:"",accountBankCode:"",accountName:"",accsplitMerName:"",businessLicense:"",businessLicenseType:"",clearCycle:"",effectiveDate:"",expiryDate:"",papersNo:"",payId:"",status:"",userPapersType:"",merType:"",accountNature:"",accountType:""})}function g(e,t){loadingAjax(e,"post",t,s).then(function(e){i.msg(e.message,{icon:1}),l.reload({where:{}}),h(),popupHide("addSalesCont","addSalesBox")}).catch(function(e){i.msg(e.message,{icon:2})})}$(".ListOperation .edit").click(function(){$(".J-datepicker-range").datePicker({hasShortcut:!0,min:d(),max:"",isRange:!0,hide:function(e){this.$input.eq(0).val(),this.$input.eq(1).val()}}),u=2,$(".text").html("编辑接收方"),f(t).then(function(e){"01"===p.merType?($(".personal").show(),$(".enterprise").hide()):($(".personal").hide(),$(".enterprise").show()),"1"===p.accountNature?$(".accountType").show():$(".accountType").hide(),$('input[name="merType"]').prop("disabled",!0),$('select[name="businessLicenseType"]').prop("disabled",!0),$('input[name="businessLicense"]').prop("disabled",!0),$('select[name="userPapersType"]').prop("disabled",!0),$('select[name="payId"]').prop("disabled",!0),$('input[name="papersNo"]').prop("disabled",!0),m=p.accsplitMerNo,c.val("formData",{account:p.account,accountBank:p.accountBank,accountBankCode:p.accountBankCode,accountName:p.accountName,accsplitMerName:p.accsplitMerName,businessLicense:p.businessLicense,businessLicenseType:p.businessLicenseType,clearCycle:p.clearCycle,effectiveDate:p.effectiveDate,expiryDate:p.expiryDate,papersNo:p.papersNo,payId:p.payId,status:p.status,userPapersType:p.userPapersType,merType:p.merType,accountNature:p.accountNature,accountType:p.accountType})}),popupShow("addSalesCont","addSalesBox")}),$(".ListOperation .del").click(function(){i.confirm("确定删除？",function(e){i.close(e),$(".mask").fadeIn(),$(".maskSpan").addClass("maskIcon"),loadingAjax("/accSplit/deleteReceiver","post",JSON.stringify({accsplitMerNo:p.accsplitMerNo}),s,"mask","","",i).then(function(e){i.msg(e.message,{icon:1}),l.reload({where:{}})}).catch(function(e){i.msg(e.message,{icon:2})})})}),$(".addSalesCont .confirmBtn").click(function(){var e=c.val("formData");e.merchantId=t,console.log(e),1===u?g("/accSplit/insertReceiver",JSON.stringify(e)):(e.accsplitMerNo=m,g("/accSplit/updateReceiver",JSON.stringify(e)))}),$(".addSalesCont .cancelBtn").click(function(){h(),popupHide("addSalesCont","addSalesBox")});var y=treeList();function v(e,n,a,o){e.render({elem:"#".concat(n),id:"treelist",showLine:!0,onlyIconControl:!0,data:o,spread:!0,text:{defaultNodeName:"无数据",none:"您没有权限，请联系管理员授权!"},click:function(e){console.log(e),t=e.data.id,a.reload({where:{merchantId:e.data.id}});for(var o=$("#".concat(n," .layui-tree-txt")),i=0;i<o.length;i++)o[i].innerHTML===e.data.title?o[i].style.color="#be954a":o[i].style.color="#555"}})}$(".refreshBtnList").click(function(){var e=treeList();JSON.stringify(e)!=JSON.stringify(y)?(v(r,"testGoods",l,y=e),l.reload({where:{merchantId:t}}),i.msg("已刷新",{icon:1})):i.msg("已刷新",{icon:1})}),v(r,"testGoods",l,y),$("body").click(function(){$(".ListOperation").fadeOut(),null})})}});