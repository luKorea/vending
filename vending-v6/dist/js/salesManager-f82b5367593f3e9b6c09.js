/*! 版权所有，翻版必究 */!function(e){function a(a){for(var t,i,r=a[0],l=a[1],d=a[2],m=0,u=[];m<r.length;m++)i=r[m],Object.prototype.hasOwnProperty.call(o,i)&&o[i]&&u.push(o[i][0]),o[i]=0;for(t in l)Object.prototype.hasOwnProperty.call(l,t)&&(e[t]=l[t]);for(c&&c(a);u.length;)u.shift()();return s.push.apply(s,d||[]),n()}function n(){for(var e,a=0;a<s.length;a++){for(var n=s[a],t=!0,r=1;r<n.length;r++){var l=n[r];0!==o[l]&&(t=!1)}t&&(s.splice(a--,1),e=i(i.s=n[0]))}return e}var t={},o={39:0},s=[];function i(a){if(t[a])return t[a].exports;var n=t[a]={i:a,l:!1,exports:{}};return e[a].call(n.exports,n,n.exports,i),n.l=!0,n.exports}i.m=e,i.c=t,i.d=function(e,a,n){i.o(e,a)||Object.defineProperty(e,a,{enumerable:!0,get:n})},i.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},i.t=function(e,a){if(1&a&&(e=i(e)),8&a)return e;if(4&a&&"object"==typeof e&&e&&e.__esModule)return e;var n=Object.create(null);if(i.r(n),Object.defineProperty(n,"default",{enumerable:!0,value:e}),2&a&&"string"!=typeof e)for(var t in e)i.d(n,t,function(a){return e[a]}.bind(null,t));return n},i.n=function(e){var a=e&&e.__esModule?function(){return e.default}:function(){return e};return i.d(a,"a",a),a},i.o=function(e,a){return Object.prototype.hasOwnProperty.call(e,a)},i.p="";var r=window.webpackJsonp=window.webpackJsonp||[],l=r.push.bind(r);r.push=a,r=r.slice();for(var d=0;d<r.length;d++)a(r[d]);var c=l;s.push([260,0]),n()}({260:function(e,a,n){"use strict";n.r(a);n(640);layui.use(["table","form","layer","laydate","tree"],function(){var e=window.parent.permissionsData1(),a=permissionsVal1({436:!1,437:!1,446:!1},e);function n(){a[436]?$(".addSalesBtn").removeClass("hide"):$(".addSalesBtn").addClass("hide"),a[437]?$(".pushImportBtn").removeClass("hide"):$(".pushImportBtn").addClass("hide"),a[446]?$(".delBtn").removeClass("hide"):$(".delBtn").addClass("hide")}n();var t=layui.table,o=(layui.form,layui.layer),s=layui.laydate,i=layui.tree,r=sessionStorage.token;$(".sidebar i").click(function(){$(".left-mian").hide(),$(".on-left").show()}),$(".on-left").click(function(){$(".left-mian").show(),$(".on-left").hide()}),$(".playHeader .close").click(function(){$(this).parent().parent().addClass("margin0"),$(this).parents(".maskContnet").fadeOut()}),$("body").bind("keydown",function(e){116==e.keyCode&&f5Fun()});var l=getKeyTime().startTime,d=getKeyTime().endTime;s.render({elem:"#test6",range:!0,value:getKeyTime().keyTimeData,done:function(e,a,n){console.log(e);var t=e.split(" - ");console.log(t),l=t[0],d=t[1]}}),$(".refreshBtn").click(function(){location.reload()});var c=[[{checkbox:!0},{field:"sm_no",title:"编号",align:"center"},{field:"sm_name",title:"姓名",align:"center"},{field:"sm_phone",title:"电话号",align:"center"},{field:"sm_classify",title:"类别",align:"center"},{field:"create_name",title:"创建人",align:"center"},{field:"create_time",align:"center",title:"创建时间",templet:function(e){return e.create_time?timeStamp(e.create_time):"-"}}]],m=t.render({elem:"#salesTable",method:"post",url:"".concat(vApi,"/sales_manager/getSalesManager"),contentType:"application/json",headers:{token:sessionStorage.token},cols:c,id:"salesId",page:!0,loading:!0,request:{pageName:"pageNum",limitName:"pageSize"},where:{merchantId:Number(sessionStorage.machineID),start_time:l,end_time:d},parseData:function(e){return 200==e.code?{code:e.code,msg:e.message,count:e.data.total,data:e.data.list}:403!=e.code?{code:e.code,msg:e.message}:void(window.parent.location.href="login.html")},response:{statusCode:200},done:function(e){403==e.code?window.parent.location.href="login.html":405==e.code&&$(".hangContent").show(),n()}});$(".queryBtn").click(function(){timeFlag(l,d)?o.msg("时间选择范围最多三个月",{icon:7}):(saveTableWidth(c),l?m.reload({where:{keyword:$(".KyeText").val(),sm_no:$(".keyNumder").val(),start_time:l,end_time:d},cols:c}):m.reload({where:{keyword:$(".KyeText").val(),sm_no:$(".keyNumder").val()}}))}),$(".addSalesBtn").click(function(){popupShow("addSalesCont","addSalesBox")}),$(".addSalesCont .confirmBtn").click(function(){if($('.addSalesCont input[name="sm_no"]').val()&&$('.addSalesCont input[name="name"]').val()&&$('.addSalesCont input[name="phone"]').val()&&$('.addSalesCont input[name="merchants"]').val()){var e=JSON.stringify({sm_no:$('.addSalesCont input[name="sm_no"]').val(),merchant_id:Number(sessionStorage.machineID),sm_name:$('.addSalesCont input[name="name"]').val(),sm_phone:$('.addSalesCont input[name="phone"]').val(),sm_classify:$('.addSalesCont input[name="merchants"]').val()});loadingAjax("/sales_manager/addSalesManager","post",e,sessionStorage.token).then(function(e){o.msg(e.message,{icon:1}),m.reload({where:{}}),$('.addSalesCont input[name="sm_no"]').val(""),$('.addSalesCont input[name="name"]').val(""),$('.addSalesCont input[name="phone"]').val(""),$('.addSalesCont input[name="merchants"]').val(""),popupHide("addSalesCont","addSalesBox")}).catch(function(e){o.msg(e.message,{icon:2})})}else o.msg("带*号未必填",{icon:7})}),$(".addSalesCont .cancelBtn").click(function(){popupHide("addSalesCont","addSalesBox")}),$(".pushImportBtn").click(function(){popupShow("pushSalesCont","pushSalesBox")}),$('.importBtn input[name="addUpload"]').change(function(e){if($(this).val()){var a=this,n=new FormData;n.append("file",e.target.files[0]),n.append("merchantId ",Number(sessionStorage.machineID)),$(".mask").fadeIn(),$(".maskSpan").addClass("maskIcon"),$.ajax({type:"post",url:"".concat(vApi,"/sales_manager/importSalesManager"),processData:!1,contentType:!1,timeout:1e4,headers:{token:r},data:n,success:function(e){$(".mask").fadeOut(),$(".maskSpan").removeClass("maskIcon"),$(a).val(""),200==e.code?(o.msg(e.message,{icon:1}),m.reload({where:{}}),popupHide("pushSalesCont ","pushSalesBox")):o.msg(e.message,{icon:7})},error:function(e){$(a).val(""),$(".mask").fadeOut(),$(".maskSpan").removeClass("maskIcon"),o.msg("服务器请求超时",{icon:2})}})}}),$(".delBtn").click(function(){var e=t.checkStatus("salesId");console.log(e),0!=e.data.length?o.confirm("确定删除？",function(a){o.close(a),$(".mask").fadeIn(),$(".maskSpan").addClass("maskIcon");var n=[];e.data.forEach(function(e){n.push(e.id)});var t=JSON.stringify({ids:n});loadingAjax("/sales_manager/deleteSalesManager","post",t,sessionStorage.token,"mask","","",o).then(function(e){o.msg(e.message,{icon:1}),m.reload({where:{}}),popupHide("addSalesCont","addSalesBox")}).catch(function(e){o.msg(e.message,{icon:2})})}):o.msg("请选择需要删除的销售经理",{icon:7})});var u=treeList();function p(e,n,t,o){e.render({elem:"#".concat(n),id:"treelist",showLine:!0,onlyIconControl:!0,data:o,spread:!0,text:{defaultNodeName:"无数据",none:"您没有权限，请联系管理员授权!"},click:function(e){console.log(e),a[436]&&(e.data.id==sessionStorage.machineID?$(".addSalesBtn").show():$(".addSalesBtn").hide()),a[437]&&(e.data.id==sessionStorage.machineID?$(".pushImportBtn").show():$(".pushImportBtn").hide()),t.reload({where:{merchantId:e.data.id}});for(var o=$("#".concat(n," .layui-tree-txt")),s=0;s<o.length;s++)o[s].innerHTML===e.data.title?o[s].style.color="#be954a":o[s].style.color="#555"}})}$(".refreshBtnList").click(function(){var e=treeList();JSON.stringify(e)!=JSON.stringify(u)?(p(i,"testGoods",m,u=e),m.reload({where:{merchantId:sessionStorage.machineID}}),o.msg("已刷新",{icon:1})):o.msg("已刷新",{icon:1})}),p(i,"testGoods",m,u)})}});