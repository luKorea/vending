/*! 版权所有，翻版必究 */!function(e){function t(t){for(var a,r,c=t[0],l=t[1],s=t[2],u=0,f=[];u<c.length;u++)r=c[u],Object.prototype.hasOwnProperty.call(o,r)&&o[r]&&f.push(o[r][0]),o[r]=0;for(a in l)Object.prototype.hasOwnProperty.call(l,a)&&(e[a]=l[a]);for(d&&d(t);f.length;)f.shift()();return i.push.apply(i,s||[]),n()}function n(){for(var e,t=0;t<i.length;t++){for(var n=i[t],a=!0,c=1;c<n.length;c++){var l=n[c];0!==o[l]&&(a=!1)}a&&(i.splice(t--,1),e=r(r.s=n[0]))}return e}var a={},o={34:0},i=[];function r(t){if(a[t])return a[t].exports;var n=a[t]={i:t,l:!1,exports:{}};return e[t].call(n.exports,n,n.exports,r),n.l=!0,n.exports}r.m=e,r.c=a,r.d=function(e,t,n){r.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:n})},r.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},r.t=function(e,t){if(1&t&&(e=r(e)),8&t)return e;if(4&t&&"object"==typeof e&&e&&e.__esModule)return e;var n=Object.create(null);if(r.r(n),Object.defineProperty(n,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var a in e)r.d(n,a,function(t){return e[t]}.bind(null,a));return n},r.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return r.d(t,"a",t),t},r.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},r.p="";var c=window.webpackJsonp=window.webpackJsonp||[],l=c.push.bind(c);c.push=t,c=c.slice();for(var s=0;s<c.length;s++)t(c[s]);var d=l;i.push([266,0]),n()}({266:function(e,t,n){"use strict";n.r(t);n(640);layui.use(["table","form","layer","laydate","tree"],function(){var e=window.parent.permissionsData1(),t=+sessionStorage.machineID,n=permissionsVal1({436:!1,437:!1,446:!1},e);function a(){n[436]?$(".addSalesBtn").removeClass("hide"):$(".addSalesBtn").addClass("hide"),n[437]?$(".pushImportBtn").removeClass("hide"):$(".pushImportBtn").addClass("hide"),n[446]?$(".delBtn").removeClass("hide"):$(".delBtn").addClass("hide")}a();var o=layui.table,i=layui.layer,r=layui.form,c=layui.tree,l=sessionStorage.token;$(".sidebar i").click(function(){$(".left-mian").hide(),$(".on-left").show()}),$(".on-left").click(function(){$(".left-mian").show(),$(".on-left").hide()}),$(".playHeader .close").click(function(){p(),$(this).parent().parent().addClass("margin0"),$(this).parents(".maskContnet").fadeOut()}),$("body").bind("keydown",function(e){116==e.keyCode&&f5Fun()}),$(".refreshBtn").click(function(){location.reload()});var s=o.render({elem:"#salesTable",method:"post",url:"".concat(vApi,"/sales_manager/getSalesManager"),contentType:"application/json",headers:{token:l},cols:[[{field:"accsplitMerName",title:"接收方名称",align:"center"},{field:"merType",title:"接收方类型",align:"center"},{field:"clearCycle",title:"结算周期",align:"center"},{field:"accountNature",title:"账户属性",align:"center"},{field:"accountType",title:"账户类型",align:"center"},{field:"accountBank",title:"开户行",align:"center"},{field:"accountName",title:"户名",align:"center"},{field:"effectiveDate",title:"生效时间",align:"center"},{field:"expiryDate",title:"失效时间",align:"center"},{field:"payId",title:"收款账户",align:"center"},{field:"status",title:"状态",align:"center"},{field:"operation",align:"center",title:"操作",toolbar:"#barDemo"}]],id:"salesId",page:!0,loading:!0,request:{pageName:"pageNum",limitName:"pageSize"},where:{merchantId:t},parseData:function(e){return 200==e.code?{code:e.code,msg:e.message,count:e.data.total,data:e.data.list}:403!=e.code?{code:e.code,msg:e.message}:void(window.parent.location.href="login.html")},response:{statusCode:200},done:function(e){403==e.code?window.parent.location.href="login.html":405==e.code&&$(".hangContent").show(),a()}}),d=null,u=null,f=1;o.on("tool(salesTable)",function(e){if(d=e.data,event.stopPropagation(),$('.editInput input[name="userName"]').val(d.name),"operation"===e.event){if(u==e.data.id)return $(".ListOperation").fadeOut(),void(u=null);u=e.data.id,$(".ListOperation").fadeIn(),$(".ListOperation").css({left:$(this).offset().left-35+"px",top:$(this).offset().top+35+"px"})}}),r.on("radio(merType)",function(e){"01"===e.value?($(".personal").show(),$(".enterprise").hide()):($(".personal").hide(),$(".enterprise").show())}),r.on("radio(accountType)",function(e){"02"===e.value?$(".accountType").show():$(".accountType").hide()}),$(".queryBtn").click(function(){s.reload({where:{keyword:$(".KyeText").val()}})});function p(){r.val("formData",{account:"",accountBank:"",accountBankCode:"",accountName:"",accsplitMerName:"",businessLicense:"",businessLicenseType:"",clearCycle:"",effectiveDate:"",expiryDate:"",papersNo:"",payId:"",status:"",userPapersType:""})}function g(e,t){loadingAjax(e,"post",t,l).then(function(e){i.msg(e.message,{icon:1}),s.reload({where:{}}),p(),popupHide("addSalesCont","addSalesBox")}).catch(function(e){i.msg(e.message,{icon:2})})}$(".addSalesBtn").click(function(){$(".J-datepicker-range").datePicker({hasShortcut:!0,min:function(){var e=new Date;return e.getFullYear()+"-"+(e.getMonth()+1<10?"0"+(e.getMonth()+1):e.getMonth()+1)+"-"+(e.getDate()<10?"0"+e.getDate():e.getDate())+" "+(e.getHours()<10?"0"+e.getHours():e.getHours())+":"+(e.getMinutes()<10?"0"+e.getMinutes():e.getMinutes())+":"+(e.getSeconds()<10?"0"+e.getSeconds():e.getSeconds())}(),max:"",isRange:!0,hide:function(e){this.$input.eq(0).val(),this.$input.eq(1).val()}}),f=1,$(".text").html("新增接收方"),function(e){return new Promise(function(t,n){loadingAjax("/accSplit/getAccRec","post",JSON.stringify({pageNum:1,pageSize:200,merchantId:e}),l).then(function(e){var n="";$.each(e.data,function(e,t){n+='<option value="'.concat(t.id,'">').concat(t.payee,"</option>")}),$("#payId").html(n),r.render("select"),t(e)}).catch(function(e){n(e)})}).catch(function(e){return Promise.reject(e)})}(t).then(function(e){popupShow("addSalesCont","addSalesBox")}).catch(function(e){var t=e.flag;console.log(t),i.msg("该商户不具备新增接收方的功能，请先配置对应的杉德支付功能",{icon:7})})}),$(".ListOperation .edit").click(function(){f=2,$(".text").html("编辑接收方"),popupShow("addSalesCont","addSalesBox")}),$(".ListOperation .del").click(function(){console.log(d),i.confirm("确定删除？",function(e){i.close(e)})}),$(".addSalesCont .confirmBtn").click(function(){var e=r.val("formData");e.machineId=t,g(1===f?"/accSplit/insertReceiver":"/sales_manager/edit",JSON.stringify(e))}),$(".addSalesCont .cancelBtn").click(function(){popupHide("addSalesCont","addSalesBox")});var h=treeList();function m(e,n,a,o){e.render({elem:"#".concat(n),id:"treelist",showLine:!0,onlyIconControl:!0,data:o,spread:!0,text:{defaultNodeName:"无数据",none:"您没有权限，请联系管理员授权!"},click:function(e){console.log(e),t=e.data.id,a.reload({where:{merchantId:e.data.id}});for(var o=$("#".concat(n," .layui-tree-txt")),i=0;i<o.length;i++)o[i].innerHTML===e.data.title?o[i].style.color="#be954a":o[i].style.color="#555"}})}$(".refreshBtnList").click(function(){var e=treeList();JSON.stringify(e)!=JSON.stringify(h)?(m(c,"testGoods",s,h=e),s.reload({where:{merchantId:t}}),i.msg("已刷新",{icon:1})):i.msg("已刷新",{icon:1})}),m(c,"testGoods",s,h),$("body").click(function(){$(".ListOperation").fadeOut(),u=null})})}});