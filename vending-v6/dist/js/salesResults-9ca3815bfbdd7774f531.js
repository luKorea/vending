/*! 版权所有，翻版必究 */!function(e){function t(t){for(var a,i,s=t[0],l=t[1],c=t[2],m=0,u=[];m<s.length;m++)i=s[m],Object.prototype.hasOwnProperty.call(o,i)&&o[i]&&u.push(o[i][0]),o[i]=0;for(a in l)Object.prototype.hasOwnProperty.call(l,a)&&(e[a]=l[a]);for(d&&d(t);u.length;)u.shift()();return r.push.apply(r,c||[]),n()}function n(){for(var e,t=0;t<r.length;t++){for(var n=r[t],a=!0,s=1;s<n.length;s++){var l=n[s];0!==o[l]&&(a=!1)}a&&(r.splice(t--,1),e=i(i.s=n[0]))}return e}var a={},o={40:0},r=[];function i(t){if(a[t])return a[t].exports;var n=a[t]={i:t,l:!1,exports:{}};return e[t].call(n.exports,n,n.exports,i),n.l=!0,n.exports}i.m=e,i.c=a,i.d=function(e,t,n){i.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:n})},i.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},i.t=function(e,t){if(1&t&&(e=i(e)),8&t)return e;if(4&t&&"object"==typeof e&&e&&e.__esModule)return e;var n=Object.create(null);if(i.r(n),Object.defineProperty(n,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var a in e)i.d(n,a,function(t){return e[t]}.bind(null,a));return n},i.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return i.d(t,"a",t),t},i.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},i.p="";var s=window.webpackJsonp=window.webpackJsonp||[],l=s.push.bind(s);s.push=t,s=s.slice();for(var c=0;c<s.length;c++)t(s[c]);var d=l;r.push([263,0]),n()}({263:function(e,t,n){"use strict";n.r(t);n(646);layui.use(["table","form","layer","laydate","tree"],function(){var e=window.parent.permissionsData1(),t=permissionsVal1({460:!1},e);function n(){t[460]?$(".pushBtn").removeClass("hide"):$(".pushBtn").addClass("hide")}n();var a=layui.table,o=(layui.form,layui.layer),r=layui.laydate,i=layui.tree,s=(sessionStorage.token,getKeyTime().startTime),l=getKeyTime().endTime;r.render({elem:"#test6",range:!0,value:getKeyTime().keyTimeData,done:function(e,t,n){var a=e.split(" - ");s=a[0],l=a[1]}}),$(".sidebar i").click(function(){$(".left-mian").hide(),$(".on-left").show()}),$(".on-left").click(function(){$(".left-mian").show(),$(".on-left").hide()});var c=a.render({elem:"#salesTable",method:"post",url:"".concat(vApi,"/sales_manager/getSalesAchievement"),contentType:"application/json",headers:{token:sessionStorage.token},cols:[[{field:"sm_no",title:"销售经理编号",align:"center"},{field:"sm_name",title:"销售经理姓名",align:"center"},{field:"sm_phone",title:"销售经理电话",align:"center"},{field:"sm_classify",title:"销售经理类别",align:"center"},{field:"create_name",title:"总单数",align:"center",templet:function(e){return 0==e.achievement.length?"-":e.order_total}},{field:"create_name",title:"总金额(￥)",align:"center",templet:function(e){return percentileMoney(e.achievement)}}]],id:"salesId",page:!0,loading:!0,request:{pageName:"pageNum",limitName:"pageSize"},where:{merchantId:Number(sessionStorage.machineID),refund:0,start_time:s,end_time:l},parseData:function(e){return 200==e.code?{code:e.code,msg:e.message,count:e.data.total,data:e.data.list}:403!=e.code?{code:e.code,msg:e.message}:void(window.parent.location.href="login.html")},response:{statusCode:200},done:function(e){403==e.code?window.parent.location.href="login.html":405==e.code&&$(".hangContent").show(),n()}});$(".queryBtn").click(function(){timeFlag(s,l)?o.msg("时间选择范围最多三个月",{icon:7}):c.reload({where:{start_time:s,end_time:l,refund:$('.newKeyItem input[name="open"]').prop("checked")?0:1}})}),$(".refreshBtn").click(function(){location.reload()}),$(".playHeader .close").click(function(){$(this).parent().parent().addClass("margin0"),$(this).parents(".maskContnet").fadeOut()});var d=null;var m=null;a.on("row(salesTable)",function(e){m=e.data,$(".salesCont .playHeader span").html("".concat(m.sm_name,"(").concat(s,"-").concat(l,")销售业绩")),popupShow("salesCont","salesBox"),d?d.reload({where:{sm_no:m.sm_no,start_time:s,end_time:l}}):function(e){d=a.render({elem:"#managerIn",method:"post",url:"".concat(vApi,"/sales_manager/getSalesManagerOrder"),contentType:"application/json",headers:{token:sessionStorage.token},cols:[[{field:"number",width:200,title:"订单号",align:"center"},{field:"amount",width:180,title:"订单金额(￥)",align:"center",templet:function(e){return percentileMoney(e.amount)}},{field:"refundAmount",width:145,title:"退款金额",align:"center",templet:function(e){return percentileMoney(e.refundAmount[0])}},{field:"sm_phone",width:130,title:"是否邮寄订单",align:"center",templet:function(e){return 1==e.mail?"是":"否"}},{field:"subject",width:180,title:"订单商品",align:"center"},{field:"notes",width:180,title:"出货状态",align:"center",templet:function(e){return e.shipStatus?e.shipStatus:"-"}},{field:"payType",width:180,title:"支付类型",align:"center",templet:function(e){return 1==e.payType?"微信":"支付宝"}},{field:"payType",width:180,title:"支付状态",align:"center",templet:function(e){return 0==e.payStatus?"未支付":1==e.payStatus?"支付中":"已支付"}},{field:"time",width:230,title:"购买时间",align:"center",templet:function(e){return e.time?timeStamp(e.time):"-"}}]],id:"managerId",page:!0,loading:!0,request:{pageName:"pageNum",limitName:"pageSize"},where:{sm_no:e,start_time:s,end_time:l,merchantId:Number(sessionStorage.machineID)},parseData:function(e){return 200==e.code?{code:e.code,msg:e.message,count:e.data.total,data:e.data.list}:403!=e.code?{code:e.code,msg:e.message}:void(window.parent.location.href="login.html")},response:{statusCode:200},done:function(e){}})}(m.sm_no)});var u=timeStamp((new Date).getTime()),p=timeStamp((new Date).getTime());r.render({elem:"#test8",type:"month",range:!0,done:function(e){var t=e.split(" - ");u=t[0],p=t[1]}}),$(".pushBtn").click(function(){s&&l?timeFlag(s,l)?o.msg("时间选择范围最多三个月",{icon:7}):o.confirm("确定导出（".concat(s,"至").concat(l,"销售经理业绩）？"),function(e){o.close(e),$(".mask").fadeIn(),$(".maskSpan").addClass("maskIcon");var t=new XMLHttpRequest;t.open("POST","".concat(vApi,"/sales_manager/exportSalesManagerOrder"),!0),t.setRequestHeader("token",sessionStorage.token),t.setRequestHeader("Content-Type","application/json;charset=utf-8"),t.responseType="blob",t.onload=function(e){if(200!=t.status)return $(".mask").fadeOut(),$(".maskSpan").removeClass("maskIcon"),void o.msg("服务器请求超时",{icon:2});if($(".mask").fadeOut(),$(".maskSpan").removeClass("maskIcon"),t.response.size<50)o.msg("导出失败",{icon:2});else{var n=t.response,a="".concat(sessionStorage.marchantName,"销售经理业绩(").concat(s,"-").concat(l,").xlsx"),r=document.createElement("a");r.download=a,r.style.display="none";var i=new Blob([n]);r.href=URL.createObjectURL(i),document.body.appendChild(r),r.click(),document.body.removeChild(r)}};var n=JSON.stringify({start_time:s,end_time:l,merchantId:Number(f),refund:$('.newKeyItem input[name="open"]').prop("checked")?0:1});t.send(n)}):o.msg("请选择时间",{icon:7})}),$(".content-footer .cancelBtn").click(function(){popupHide("exportCont","exportBox")}),$(".exportCont .determinePushBtn").click(function(){if(u&&p){$(".mask").fadeIn(),$(".maskSpan").addClass("maskIcon");var e=new XMLHttpRequest;e.open("POST","".concat(vApi,"/sales_manager/exportSalesManagerOrder"),!0),e.setRequestHeader("token",sessionStorage.token),e.setRequestHeader("Content-Type","application/json;charset=utf-8"),e.responseType="blob",e.onload=function(t){if(200!=e.status)return $(".mask").fadeOut(),$(".maskSpan").removeClass("maskIcon"),void o.msg("服务器请求超时",{icon:2});$(".mask").fadeOut(),$(".maskSpan").removeClass("maskIcon");var n=e.response,a="".concat(sessionStorage.marchantName,"销售经理业绩(").concat(u,"-").concat(p,").xlsx"),r=document.createElement("a");r.download=a,r.style.display="none";var i=new Blob([n]);r.href=URL.createObjectURL(i),document.body.appendChild(r),r.click(),document.body.removeChild(r)};var t=JSON.stringify({start_time:u,end_time:p,merchantId:Number(sessionStorage.machineID)});e.send(t)}else o.msg("请选择时间",{icon:7})});var f=sessionStorage.machineID,g=treeList();function h(e,t,n,a){e.render({elem:"#".concat(t),id:"treelist",showLine:!0,onlyIconControl:!0,data:a,spread:!0,text:{defaultNodeName:"无数据",none:"您没有权限，请联系管理员授权!"},click:function(e){f=e.data.id,n.reload({where:{merchantId:e.data.id}});for(var a=$("#".concat(t," .layui-tree-txt")),o=0;o<a.length;o++)a[o].innerHTML===e.data.title?a[o].style.color="#be954a":a[o].style.color="#555"}})}$(".refreshBtnList").click(function(){var e=treeList();JSON.stringify(e)!=JSON.stringify(g)?(h(i,"testGoods",c,g=e),c.reload({where:{merchantId:sessionStorage.machineID}}),o.msg("已刷新",{icon:1})):o.msg("已刷新",{icon:1})}),h(i,"testGoods",c,g)})},646:function(e,t){}});