(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-7af53ef4"],{"0ec4":function(e,a,t){"use strict";t.r(a);var n=function(){var e=this,a=e.$createElement,t=e._self._c||a;return t("div",{staticClass:"app-container"},[t("avue-crud",e._g(e._b({attrs:{page:e.page},on:{"update:page":function(a){e.page=a}},scopedSlots:e._u([{key:"bicId",fn:function(a){return t("div",{staticClass:"row-c"},[1!=a.row.flag?t("el-tooltip",{attrs:{content:"您的可用余额低于预警值，请及时充值",placement:"top"}},[t("svg-icon",{staticStyle:{"font-size":"25px","margin-right":"10px"},attrs:{"icon-class":"warning"}})],1):e._e(),t("span",[e._v(e._s(a.row.bicId))])],1)}},{key:"menuBtn",fn:function(a){return[e.hasPermission(e.config.addBalance)?t("el-dropdown-item",{nativeOn:{click:function(t){return e.$refs.crud.rowEdit(Object.assign({},a.row,{editType:"Recharge",editTitle:"充值"}),a.index)}}},[e._v("充值")]):e._e(),e.hasPermission(e.config.subBalance)?t("el-dropdown-item",{nativeOn:{click:function(t){return e.$refs.crud.rowEdit(Object.assign({},a.row,{editType:"Reduce",editTitle:"调减"}),a.index)}}},[e._v("调减")]):e._e(),e.hasPermission(e.config.getTopUpLog)?t("el-dropdown-item",{nativeOn:{click:function(t){return e.rowView(Object.assign({},a.row,{formslot:"reduceBalance",viewTitle:"商家["+a.row.companyName+"]的充值/调减记录"}),a.index)}}},[e._v(" 充值/调减记录")]):e._e(),e.hasPermission(e.config.orderStatistics)?t("el-dropdown-item",{nativeOn:{click:function(t){return e.rowView(Object.assign({},a.row,{formslot:"usageRecord",viewTitle:"商家["+a.row.companyName+"]的使用记录"}),a.index)}}},[e._v(" 使用记录")]):e._e()]}},{key:"uploadExcelCompanyForm",fn:function(a){return t("div",{},[e.form&&e.form.formslot==a.column.prop?t("uploadExcel",{attrs:{data:e.config.excel},on:{closeDialog:function(a){return e.closeDialog("excelTask3")}}}):e._e(),t("excelTask",{ref:"excelTask3",attrs:{Pconfig:e.config,type:"3"}})],1)}},{key:"reduceBalanceForm",fn:function(a){return t("div",{},[e.form&&e.form.formslot==a.column.prop?t("balanceRecord",{attrs:{Pconfig:e.config,row:a.row}}):e._e()],1)}},{key:"usageRecordForm",fn:function(a){return t("div",{},[e.form&&e.form.formslot==a.column.prop?t("usageRecord",{attrs:{Pconfig:e.config,row:a.row}}):e._e()],1)}},{key:"getExportTaskListForm",fn:function(a){return t("div",{},[e.form&&e.form.formslot==a.column.prop?t("exportTask",{attrs:{title:"导出商家",Pconfig:e.config,row:a.row,type:"3",exportParams:e.params}}):e._e()],1)}},{key:"isMoneyRemindSearch",fn:function(a){var n=a.disabled,i=a.size;return[t("el-checkbox",{attrs:{disabled:n,size:i,label:"是否查询低于预警值",border:""},model:{value:e.search.isMoneyRemind,callback:function(a){e.$set(e.search,"isMoneyRemind",a)},expression:"search.isMoneyRemind"}})]}},{key:"rangeBalanceSearch",fn:function(a){var n=a.disabled,i=a.size;return[t("div",{staticClass:"row rangeSearch"},[t("el-input",{attrs:{placeholder:"最小",step:e.step,type:"number",disabled:n,size:i},model:{value:e.search.startBalance,callback:function(a){e.$set(e.search,"startBalance",a)},expression:"search.startBalance"}}),t("el-input",{attrs:{placeholder:"最大",step:e.step,type:"number",disabled:n,size:i},model:{value:e.search.endBalance,callback:function(a){e.$set(e.search,"endBalance",a)},expression:"search.endBalance"}})],1)]}},{key:"rangeUsableBalanceSearch",fn:function(a){var n=a.disabled,i=a.size;return[t("div",{staticClass:"row rangeSearch"},[t("el-input",{attrs:{placeholder:"最小",step:e.step,type:"number",disabled:n,size:i},model:{value:e.search.startUsableBalance,callback:function(a){e.$set(e.search,"startUsableBalance",a)},expression:"search.startUsableBalance"}}),t("el-input",{attrs:{placeholder:"最大",step:e.step,type:"number",disabled:n,size:i},model:{value:e.search.endUsableBalance,callback:function(a){e.$set(e.search,"endUsableBalance",a)},expression:"search.endUsableBalance"}})],1)]}}]),model:{value:e.form,callback:function(a){e.form=a},expression:"form"}},"avue-crud",e.bindVal,!1),e.onEvent),[t("template",{slot:"menuLeft"},[e.hasPermission(e.config.excel.url)?t("el-button",{staticClass:"el-icon-upload2",attrs:{size:"small"},on:{click:function(a){return e.rowView({formslot:"uploadExcelCompany",viewTitle:"导入商家"},0)}}},[e._v("导入商家")]):e._e(),e.hasPermission(e.config.exportExcel)?t("el-button",{staticClass:"el-icon-download",attrs:{size:"small"},on:{click:function(a){return e.rowView({formslot:"getExportTaskList",viewTitle:"导出商家"},0)}}},[e._v("导出商家")]):e._e()],1)],2)],1)},i=[],o=t("f206"),r=t("353b"),s=t("1c5e"),l=t("f374"),c=(t("6a61"),t("b4fb"),t("e35a"),t("9cf3"),t("08ba"),t("d718")),d=t("82ff"),p=t("e381"),u=t("7e3b"),m=t("47ad"),f=t("22a4"),h=t("99a4"),y=function(){var e=this,a=e.$createElement,t=e._self._c||a;return t("div",{staticClass:"row"},[t("el-input-number",{attrs:{"controls-position":"right",min:0,size:"small"},on:{change:e.handleMinChange},model:{value:e.form.min,callback:function(a){e.$set(e.form,"min",a)},expression:"form.min"}}),e._v(" ~ "),t("el-input-number",{attrs:{"controls-position":"right",min:0,size:"small"},on:{change:e.handleMaxChange},model:{value:e.form.max,callback:function(a){e.$set(e.form,"max",a)},expression:"form.max"}})],1)},b=[],g=(t("513c"),t("44e4"),1),v=1e5,x={data:function(){return{form:{min:"20",max:"100000"},rules:{min:[{required:!0,message:"必填项，请维护",trigger:"blur"},{validator:this.validateCom,trigger:"blur"},{validator:this.validateMin,trigger:"blur"}],max:[{required:!0,message:"必填项，请维护",trigger:"blur"},{validator:this.validateCom,trigger:"blur"},{validator:this.validateMax,trigger:"blur"}]}}},methods:{getFormData:function(){var e=this,a={};return this.$refs.form.validate((function(t){a.valid=t,a.form=e.form})),a},resetForm:function(){this.$refs.form.resetFields()},handleMinChange:function(){this.$refs.form.validateField("max")},handleMaxChange:function(){this.$refs.form.validateField("min")},validateCom:function(e,a,t){var n=Number(a);return Number.isInteger(n)?n<g?t(new Error("输入值必须大于0")):n>v?t(new Error("输入值必须小于100000")):t():t(new Error("输入值必须为正整数"))},validateMin:function(e,a,t){var n=Number(a),i=Number(this.form.max);return!i||n<i?t():t(new Error("输入值不得大于最大阈值"))},validateMax:function(e,a,t){var n=Number(a),i=Number(this.form.min);return!i||n>i?t():t(new Error("输入值不得小于最小阈值"))}}},w=x,_=t("5d22"),D=Object(_["a"])(w,y,b,!1,null,null,null),B=D.exports,O={components:{uploadExcel:p["a"],balanceRecord:u["a"],usageRecord:m["a"],excelTask:h["a"],exportTask:f["a"],numberRange:B},mixins:[c["a"],d["a"]],props:{my:{}},data:function(){var e,a,t;return{step:100,search:{isMoneyRemind:!1,startBalance:"",endBalance:"",startUsableBalance:"",endUsableBalance:""},config:{detail:"",save:"/company/addCompany",delete:"/company/deleteCompanyId",update:"/company/updateCompany",list:"/company/getCompany",addBalance:"/company/addBalance",subBalance:"/company/subBalance",getTopUpLog:"/logCompany/getTopUpLog",orderStatistics:"/logCompany/orderStatistics",findDayOrder:"/company/findDayOrder",getOrderByDayAndbicId:"/logCompany/getOrderByDayAndbicId",getQualityTestingByDayAndbicName:"/logCompany/getQualityTestingByDayAndbicName",exportExcel:"/company/deriveExcel",exportTask:"/exportTask/getCompanyExportTaskList",excelTask:"/excelTask/getCompanyExcelTaskList",excel:{msg:"若商家在系统中已存在，余额将会以系统中余额为准，不做修改!",title:"商家",url:"/company/excelCompany",href:"./assets/uploadCompany.xlsx"}},method:{delete:"GET"},rowKey:"companyId",option:Object(l["a"])({addBtn:!0,addBtnText:"新增商家",menuType:"menu",viewBtn:!1,stripe:!1,column:[].concat(Object(s["a"])(this.column_def("商家ID","bicId",!0,{search:!0,searchSpan:6,editDisabled:!0,fixed:"left",viewDisplay:!1})),Object(s["a"])(this.column_def("商家名称","companyName",!0,{search:!0,searchSpan:6,fixed:"left",viewDisplay:!1})),Object(s["a"])(this.column_def("是否启用","startUsingStr",!1,{hide:!0,addDisplay:!1,editDisplay:!1,viewDisplay:!1})),Object(s["a"])(this.column_switch("是否启用","startUsing",!1,{hide:!0,value:2,addDisplay:!1,editDisplay:!1,viewDisplay:!1,dicData:[{value:1,label:"否"},{value:2,label:"是"}]})),Object(s["a"])(this.column_money("余额","balance",!0,{searchslot:!0,viewDisplay:!1,editDisabled:!0})),Object(s["a"])(this.column_money("余额","rangeBalance",!1,(e={hide:!0,search:!0,searchslot:!0,searchSpan:6},Object(r["a"])(e,"searchslot",!0),Object(r["a"])(e,"viewDisplay",!1),Object(r["a"])(e,"editDisplay",!1),e))),Object(s["a"])(this.column_money("可用余额","rangeUsableBalance",!1,(a={hide:!0,search:!0,searchslot:!0,searchSpan:6},Object(r["a"])(a,"searchslot",!0),Object(r["a"])(a,"viewDisplay",!1),Object(r["a"])(a,"editDisplay",!1),a))),Object(s["a"])(this.column_switch("","isMoneyRemind",!1,(t={hide:!0,search:!0,searchslot:!0,searchSpan:6},Object(r["a"])(t,"searchslot",!0),Object(r["a"])(t,"viewDisplay",!1),Object(r["a"])(t,"editDisplay",!1),Object(r["a"])(t,"dicData",[{value:1,label:"是"},{value:2,label:"否"}]),t))),Object(s["a"])(this.column_money("冻结金额","freezeMoney",!0,{addDisplay:!1,viewDisplay:!1,editDisplay:!1})),Object(s["a"])(this.column_money("可用余额","usableBalance",!0,{addDisplay:!1,viewDisplay:!1,editDisplay:!1})),Object(s["a"])(this.column_money("余额预警值","moneyRemind",!0,{viewDisplay:!1,editDisabled:!0})),Object(s["a"])(this.column_money("充值金额","Recharge",!0,{addDisplay:!1,viewDisplay:!1,display:!0,hide:!0})),Object(s["a"])(this.column_money("调减金额","Reduce",!0,{addDisplay:!1,viewDisplay:!1,display:!0,hide:!0})),Object(s["a"])(this.column_textarea("备注","remark",!1,{viewDisplay:!1,editDisplay:!0})))},this.group_def([].concat(Object(s["a"])(this.group_column_formslot("uploadExcelCompany")),Object(s["a"])(this.group_column_formslot("reduceBalance")),Object(s["a"])(this.group_column_formslot("usageRecord")),Object(s["a"])(this.group_column_formslot("getExportTaskList")),Object(s["a"])(this.group_column_formslot("exportQualityTesting")))))}},created:function(){return Object(o["a"])(regeneratorRuntime.mark((function e(){return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:case"end":return e.stop()}}),e)})))()},methods:{listBefore:function(){for(var e in this.search)this.params[e]=this.search[e];this.search.isMoneyRemind?this.params.isMoneyRemind=1:this.params.isMoneyRemind=2},resetBefore:function(){for(var e in this.search)this.search[e]="";this.search.isMoneyRemind=!1},By100:function(){var e=this;e.form.balance=100*e.form.balance,e.form.usableBalance=100*e.form.usableBalance,e.form.moneyRemind=100*e.form.moneyRemind},addBefore:function(){return this.By100(),1},updateBefore:function(){var e=this;return!e.form.editType||"Recharge"!=e.form.editType&&"Reduce"!=e.form.editType?e.config.update="company/updateCompany":("Recharge"==e.form.editType&&(e.config.update="company/addBalance",e.form.balance=e.form.Recharge),"Reduce"==e.form.editType&&(e.config.update="company/subBalance",e.form.balance=e.form.Reduce)),this.By100(),1},openBefore:function(e){var a=this;!a.form.editType||"Recharge"!=a.form.editType&&"Reduce"!=a.form.editType?(a.option.column.forEach((function(e){"Reduce"==e.prop&&(e.display=!1),"Recharge"==e.prop&&(e.display=!1),"companyName"==e.prop&&(e.editDisabled=!1),"moneyRemind"==e.prop&&(e.editDisplay=!0,e.editDisabled=!1),"balance"==e.prop&&(e.editDisplay=!1)})),a.option=Object.assign(a.option,{})):a.option.column.forEach((function(e){"Reduce"==e.prop&&"Recharge"==a.form.editType&&(e.display=!1),"Recharge"==e.prop&&"Reduce"==a.form.editType&&(e.display=!1),"Recharge"==e.prop&&"Recharge"==a.form.editType&&(e.display=!0),"Reduce"==e.prop&&"Reduce"==a.form.editType&&(e.display=!0),"moneyRemind"==e.prop&&(e.editDisplay=!1),"companyName"==e.prop&&(e.editDisabled=!0),"balance"==e.prop&&(e.editDisplay=!0)})),this.option.editTitle=this.form.editTitle,this.option=Object.assign(this.option,{}),console.log(this.option)},tableRowClassName:function(e){var a=e.row;e.rowIndex;return 1==a.flag?"":"warning-row "}}},R=O,k=Object(_["a"])(R,n,i,!1,null,null,null);a["default"]=k.exports},"44e4":function(e,a,t){var n=t("1c8b"),i=t("cb06");n({target:"Number",stat:!0},{isInteger:i})},"9cf3":function(e,a,t){"use strict";var n=t("b2a2"),i=t("857c"),o=t("2732"),r=t("9d5c"),s=t("59da");n("search",1,(function(e,a,t){return[function(a){var t=o(this),n=void 0==a?void 0:a[e];return void 0!==n?n.call(a,t):new RegExp(a)[e](String(t))},function(e){var n=t(a,e,this);if(n.done)return n.value;var o=i(e),l=String(this),c=o.lastIndex;r(c,0)||(o.lastIndex=0);var d=s(o,l);return r(o.lastIndex,c)||(o.lastIndex=c),null===d?-1:d.index}]}))},"9d5c":function(e,a){e.exports=Object.is||function(e,a){return e===a?0!==e||1/e===1/a:e!=e&&a!=a}},cb06:function(e,a,t){var n=t("a719"),i=Math.floor;e.exports=function(e){return!n(e)&&isFinite(e)&&i(e)===e}},e381:function(e,a,t){"use strict";var n=function(){var e=this,a=e.$createElement,t=e._self._c||a;return t("div",{staticClass:"row-c"},[t("el-upload",{ref:"upload",staticStyle:{margin:"auto"},attrs:{limit:1,accept:".xlsx, .xls",action:e.data.url,disabled:e.isUploading,"http-request":e.handleFileUpload,"auto-upload":!0,drag:""}},[t("i",{staticClass:"el-icon-upload"}),t("div",{staticClass:"el-upload__text"},[e._v("将文件拖到此处，或"),t("em",[e._v("点击上传")])]),t("div",{staticClass:"el-upload__tip",staticStyle:{color:"#ff0000","text-align":"center"},attrs:{slot:"tip"},slot:"tip"},[t("el-link",{staticClass:"dowloadX",staticStyle:{"font-size":"12px"},attrs:{href:e.data.href,download:e.data.title+"导入模板.xlsx",type:"primary",icon:"el-icon-warning-outline"}},[e._v(" 下载"+e._s(e.data.title)+"导入模板")]),e.data.msg?t("br"):e._e(),e._v(" "+e._s(e.data.msg)+" "),t("br"),e._v(" 提示：仅允许导入“xls”或“xlsx”格式文件！ ")],1)])],1)},i=[],o=(t("9302"),t("337a")),r={components:{},props:{data:{}},watch:{},data:function(){return{isUploading:!1}},created:function(){},methods:{handleFileUpload:function(e){var a=this,t=new FormData;t.append("file",e.file),a.isUploading=!0;var n=this.$loading({lock:!0,text:"文件上传中",spinner:"el-icon-loading",background:"rgba(0, 0, 0, 0.7)"});Object(o["a"])(a.data.url,t,"upload",!0,!0).then((function(e){console.log(e),a.$refs.upload.clearFiles(),a.isUploading=!1,a.$emit("closeDialog"),n.close(),200!=e.code&&a.$alert(e.data&&e.data.join(","),"提示",{confirmButtonText:"确定",callback:function(e){}})})).catch((function(e){a.$refs.upload.clearFiles(),a.isUploading=!1,n.close()}))}}},s=r,l=t("5d22"),c=Object(l["a"])(s,n,i,!1,null,null,null);a["a"]=c.exports}}]);