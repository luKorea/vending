/*! 版权所有，翻版必究 */!function(d){function e(e){for(var t,n,a=e[0],i=e[1],o=e[2],c=0,r=[];c<a.length;c++)n=a[c],Object.prototype.hasOwnProperty.call(s,n)&&s[n]&&r.push(s[n][0]),s[n]=0;for(t in i)Object.prototype.hasOwnProperty.call(i,t)&&(d[t]=i[t]);for(p&&p(e);r.length;)r.shift()();return m.push.apply(m,o||[]),l()}function l(){for(var e,t=0;t<m.length;t++){for(var n=m[t],a=!0,i=1;i<n.length;i++){var o=n[i];0!==s[o]&&(a=!1)}a&&(m.splice(t--,1),e=c(c.s=n[0]))}return e}var n={},s={3:0},m=[];function c(e){if(n[e])return n[e].exports;var t=n[e]={i:e,l:!1,exports:{}};return d[e].call(t.exports,t,t.exports,c),t.l=!0,t.exports}c.m=d,c.c=n,c.d=function(e,t,n){c.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:n})},c.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},c.t=function(t,e){if(1&e&&(t=c(t)),8&e)return t;if(4&e&&"object"==typeof t&&t&&t.__esModule)return t;var n=Object.create(null);if(c.r(n),Object.defineProperty(n,"default",{enumerable:!0,value:t}),2&e&&"string"!=typeof t)for(var a in t)c.d(n,a,function(e){return t[e]}.bind(null,a));return n},c.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return c.d(t,"a",t),t},c.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},c.p="";var t=window.webpackJsonp=window.webpackJsonp||[],a=t.push.bind(t);t.push=e,t=t.slice();for(var i=0;i<t.length;i++)e(t[i]);var p=a;m.push([336,0]),l()}({336:function(e,t,n){"use strict";n.r(t);var t=n(348),u=n(1);layui.use(["table","form","layer","tree","util"],function(){sessionStorage.token||(window.parent.location.href="login.html");var a=layui.jquery,n=layui.table,i=layui.layer,i=layui.layer,e=(layui.util,layui.tree,layui.form),t=sessionStorage.token,o=n.render({elem:"#tableTest",url:"".concat(Vapi,"/company/getCompany"),method:"post",contentType:"application/json",headers:{token:t},cols:[[{field:"goods_images",width:35,title:"",templet:"#imgtmp",align:"center"},{field:"bicId",width:160,title:"商家ID",align:"center"},{field:"companyName",width:180,title:"商家名称",align:"center"},{field:"startUsingStr",width:110,title:"是否启用",align:"center"},{field:"balance",width:160,title:"余额",align:"center",templet:function(e){return Object(u.h)(e.balance)}},{field:"moneyRemind",width:150,title:"余额预警值",align:"center",templet:function(e){return Object(u.h)(e.moneyRemind)}},{field:"remark",width:180,title:"备注",align:"center"},{field:"freezeMoney",width:150,title:"冻结金额",align:"center",templet:function(e){return Object(u.h)(e.freezeMoney)}},{field:"usableBalance",width:150,title:"可用金额",align:"center",templet:function(e){return Object(u.h)(e.usableBalance)}},{field:"operation",width:150,title:"操作",toolbar:"#barDemo",align:"center"}]],id:"tableId",page:!0,loading:!0,even:!0,request:{pageName:"pageNum",limitName:"pageSize"},where:{},parseData:function(e){return 200==e.code?{code:e.code,msg:e.message,count:e.data.total,data:e.data.list}:{code:e.code,msg:e.message}},response:{statusCode:200},done:function(e){for(var t in 403==e.code&&(i.msg("登录过期,请重新登录",{icon:2}),setTimeout(function(e){window.parent.location.href="login.html"},1500)),e.data){2==e.data[t].flag&&a(".data_list1 tr[data-index="+t+"]").addClass("warning")}Object(u.c)()}});a(".playHeader .close").click(function(){a(this).parent().parent().addClass("margin0"),a(this).parents(".maskContnet").fadeOut()}),a(".queryBtnClick").click(function(){o.reload({where:{companyName:a('.addMember input[name="keyMerchants"]').val(),bicId:a('.addMember input[name="keyBIC"]').val()}})});var c=null,r=null;n.on("tool(tableTest)",function(e){if(event.stopPropagation(),c=e.data,"operation"===e.event){if(r==e.data.companyId)return a(".ListOperation").fadeOut(),void(r=null);r=e.data.companyId,a(".ListOperation").fadeIn(),a(".ListOperation").css({left:a(this).offset().left-35+"px",top:a(this).offset().top+35+"px"})}}),a(".addBtn").click(function(){Object(u.j)(".addMerchantsCont",".addMBox")}),a(".addMBox .cancel1").click(function(){Object(u.i)(".addMerchantsCont",".addMBox")}),a(".addMBox .determine1").click(function(){var e;a('.addMBody input[name="companyName"]').val()&&a('.addMBody input[name="bicId"]').val()&&a('.addMBody input[name="moneyRemind"]').val()?(Object(u.b)(),e=JSON.stringify({companyName:a('.addMBody input[name="companyName"]').val(),bicId:a('.addMBody input[name="bicId"]').val(),moneyRemind:Object(u.g)(Number(a('.addMBody input[name="moneyRemind"]').val()),100),startUsing:a('.addMBox input[name="open"]').prop("checked")?2:1,remark:a('.addMBody input[name="remark"]').val(),balance:Object(u.g)(Number(a('.addMBody input[name="balance"]').val()),100)}),Object(u.f)("/company/addCompany","post",sessionStorage.token,e,i,"mask",".addMerchantsCont",".addMBox").then(function(e){i.msg(e.message,{icon:1}),o.reload({where:{}}),a('.addMBody input[name="companyName"]').val(""),a('.addMBody input[name="bicId"]').val(""),a('.addMBody input[name="moneyRemind"]').val(""),a('.addMBody input[name="balance"]').val(""),a('.addMBody input[name="remark"]').val("")}).catch(function(e){i.msg(e.message,{icon:2})})):i.msg("带*为必填",{icon:"7"})}),a(".ListOperation .topUpBtn").click(function(){a('.topUPBox input[name="companyName"]').val(c.companyName),a('.topUPBox input[name="balance"]').val(c.balance),Object(u.j)(".topUPContent",".topUPBox")}),a(".topUPBox .determine1").click(function(){a('.topUPBox input[name="topUpNum"]').val()?0<a('.topUPBox input[name="topUpNum"]').val()?i.confirm("确定充值?",function(e){i.close(e),Object(u.b)();e=JSON.stringify({balance:Object(u.g)(Number(a('.topUPBox input[name="topUpNum"]').val()),100),companyId:c.companyId,remark:a('.topUPBox input[name="remark"]').val()});Object(u.f)("/company/addBalance","post",sessionStorage.token,e,i,"mask",".topUPContent",".topUPBox").then(function(e){i.msg(e.message,{icon:1}),o.reload({where:{}}),a('.topUPBox input[name="topUpNum"]').val(""),a('.topUPBox input[name="remark"]').val("")}).catch(function(e){i.msg(e.message,{icon:2})})}):i.msg("充值金额必须大于0",{icon:7}):i.msg("带*为必填",{icon:7})}),a(".topUPBox .cancel1").click(function(){Object(u.i)(".topUPContent",".topUPBox")}),a(".ListOperation .reductionsBtn").click(function(){a('.reductionsBox input[name="companyName"]').val(c.companyName),a('.reductionsBox input[name="balance"]').val(c.balance),Object(u.j)(".reductionsCOntent",".reductionsBox")}),a(".reductionsBox .determine1").click(function(){a('.reductionsBox input[name="reductionsNum"]').val()?0<a('.reductionsBox input[name="reductionsNum"]').val()?i.confirm("确定调减?",function(e){i.close(e),Object(u.b)();e=JSON.stringify({balance:Object(u.g)(Number(a('.reductionsBox input[name="reductionsNum"]').val()),100),companyId:c.companyId,remark:a('.reductionsBox input[name="remark"]').val()});Object(u.f)("/company/subBalance","post",sessionStorage.token,e,i,"mask",".reductionsCOntent",".reductionsBox").then(function(e){i.msg(e.message,{icon:1}),o.reload({where:{}}),a('.reductionsBox input[name="reductionsNum"]').val(""),a('.reductionsBox input[name="remark"]').val("")}).catch(function(e){i.msg(e.message,{icon:2})})}):i.msg("充值金额必须大于0",{icon:7}):i.msg("带*为必填",{icon:7})}),a(".reductionsBox .cancel1").click(function(){Object(u.i)(".reductionsCOntent",".reductionsBox")}),a(".ListOperation .edit").click(function(){a('.editBox input[name="companyName"]').val(c.companyName),a('.editBox input[name="bicId"]').val(c.bicId),a('.editBox input[name="moneyRemind"]').val(c.moneyRemind),a('.editBox input[name="open"]').prop("checked",2==c.startUsing),a('.editBox input[name="remark"]').val(c.remark),e.render("checkbox"),Object(u.j)(".editContent",".editBox")}),a(".editBox .determine1").click(function(){var e;a('.editBox input[name="companyName"]').val()&&a('.editBox input[name="bicId"]').val()&&a('.editBox input[name="moneyRemind"]').val()?(Object(u.b)(),e=JSON.stringify({companyName:a('.editBox input[name="companyName"]').val(),bicId:a('.editBox input[name="bicId"]').val(),moneyRemind:Object(u.g)(Number(a('.editBox input[name="moneyRemind"]').val()),100),companyId:c.companyId,startUsing:a('.editBox input[name="open"]').prop("checked")?2:1,remark:a('.editBox input[name="remark"]').val()}),Object(u.f)("/company/updateCompany","post",sessionStorage.token,e,i,"mask",".editContent",".editBox").then(function(e){i.msg(e.message,{icon:1}),o.reload({where:{}})}).catch(function(e){i.msg(e.message,{icon:2})})):i.msg("带*为必填",{icon:"7"})}),a(".editBox .cancel1").click(function(){Object(u.i)(".editContent",".editBox")}),a("body").click(function(){a(".ListOperation").fadeOut(),r=null}),a(".ListOperation .del").click(function(){i.confirm("确定删除?",function(e){i.close(e),Object(u.b)();e={companyId:c.companyId};Object(u.f)("/company/deleteCompanyId","get",sessionStorage.token,e,i,"mask").then(function(e){i.msg(e.message,{icon:1}),o.reload({where:{}})}).catch(function(e){i.msg(e.message,{icon:2})})})});var d=null;a(".ListOperation .top").click(function(){Object(u.j)(".TopUpRecordContent",".topUpRecordBox"),d?d.reload({where:{companyId:c.companyId}}):d=n.render({elem:"#TopUpTable",url:"".concat(Vapi,"/logCompany/getTopUpLog"),method:"post",contentType:"application/json",headers:{token:t},cols:[[{field:"frontBalance",width:160,title:"充值/调减前余额",align:"center",templet:function(e){return Object(u.h)(e.frontBalance)}},{field:"money",width:160,title:"充值/调减余额",align:"center",templet:function(e){return 1==e.flag?"-"+Object(u.h)(e.money):Object(u.h)(e.money)}},{field:"laterBalance",width:160,title:"余额",align:"center",templet:function(e){return Object(u.h)(e.laterBalance)}},{field:"remark",width:160,title:"备注",align:"center"},{field:"logTime",width:180,title:"充值/调减时间",align:"center"}]],id:"tioUpId",page:!0,loading:!0,even:!0,request:{pageName:"pageNum",limitName:"pageSize"},where:{companyId:c.companyId},parseData:function(e){return 200==e.code?{code:e.code,msg:e.message,count:e.data.total,data:e.data.list}:{code:e.code,msg:e.message}},response:{statusCode:200},done:function(e){403==e.code&&(i.msg("登录过期,请重新登录",{icon:2}),setTimeout(function(e){window.parent.location.href="login.html"},1500)),Object(u.c)()}}),a(".topUpRecordBox .playHeader span").html("".concat(c.companyName,"充值/调减记录"))});var l=null;a(".ListOperation .use").click(function(){l?l.reload({where:{bicId:c.companyId}}):l=n.render({elem:"#useTable",url:"".concat(Vapi,"/logCompany/orderStatistics"),method:"GET",headers:{token:t},cols:[[{field:"statisticsTime",width:200,title:"使用月份",align:"center",templet:function(e){return e.statisticsTime?Object(u.l)(e.statisticsTime):"-"}},{field:"monthMoney",width:200,title:"使用金额",align:"center",templet:function(e){return e.monthMoney||0==e.monthMoney?Object(u.h)(e.monthMoney):"-"}}]],id:"useId",page:!0,loading:!0,even:!0,request:{pageName:"pageNum",limitName:"pageSize"},where:{bicId:c.companyId},parseData:function(e){return 200==e.code?{code:e.code,msg:e.message,count:e.data.total,data:e.data.list}:{code:e.code,msg:e.message}},response:{statusCode:200},done:function(e){403==e.code&&(i.msg("登录过期,请重新登录",{icon:2}),setTimeout(function(e){window.parent.location.href="login.html"},1500)),Object(u.c)()}}),a(".useRecordBox .playHeader span").html(c.companyName+"使用记录"),Object(u.j)(".useRecordContent",".useRecordBox")});var s;n.on("row(useTable)",function(e){s=e.data,m?m.reload({where:{bicId:c.bicId,time:Object(u.l)(s.statisticsTime)}}):m=n.render({elem:"#dayTable",url:"".concat(Vapi,"/company/findDayOrder"),method:"GET",headers:{token:t},cols:[[{field:"day",width:180,title:"使用时间",align:"center"},{field:"money",width:200,title:"使用金额",align:"center",templet:function(e){return Object(u.h)(e.money)}}]],id:"dayId",loading:!0,even:!0,request:{pageName:"pageNum",limitName:"pageSize"},initSort:{field:"day",type:"desc"},where:{bicId:c.bicId,time:Object(u.l)(s.statisticsTime)},parseData:function(e){return 200==e.code?{code:e.code,msg:e.message,count:e.data.length,data:e.data}:{code:e.code,msg:e.message}},response:{statusCode:200},done:function(e){403==e.code&&(i.msg("登录过期,请重新登录",{icon:2}),setTimeout(function(e){window.parent.location.href="login.html"},1500)),Object(u.c)()}}),a(".dayRecordBox .playHeader span").html("".concat(c.companyName,"(").concat(Object(u.l)(s.statisticsTime),")使用记录")),Object(u.j)(".dayRecordContent",".dayRecordBox")});var m=null;n.on("row(dayTable)",function(e){var t;p?p.reload({where:{data:e.data.orders}}):(t=e.data.orders,p=n.render({elem:"#orderTable",cols:[[{field:"orderId",width:180,title:"订单编号",align:"center"},{field:"orderYard",width:180,title:"订单码",align:"center"},{field:"flagStr",width:130,title:"扣费状态",align:"center"},{field:"expressMoney",width:130,title:"物流费用",align:"center",templet:function(e){return Object(u.h)(e.expressMoney)}},{field:"qualityMoney",width:130,title:"质检费用",align:"center",templet:function(e){return Object(u.h)(e.qualityMoney)}},{field:"bicId",width:160,title:"商家ID",align:"center"},{field:"companyName",width:160,title:"商家名称",align:"center"},{field:"orderAppointFlag",width:160,title:"订单履约状态",align:"center"},{field:"cancelStr",width:160,title:"是否取消",align:"center"},{field:"interceptStr",width:160,title:"是否拦截",align:"center"},{field:"interceptCause",width:160,title:"拦截原因",align:"center"},{field:"mergeBatch",width:160,title:"合并批次号",align:"center"},{field:"storageNumber",width:160,title:"入库件数",align:"center"},{field:"testingInstitutes",width:160,title:"质检机构",align:"center"},{field:"qualityResult",width:160,title:"质检结果",align:"center"},{field:"recheckResult",width:160,title:"复检结果",align:"center"},{field:"planExpress",width:160,title:"计划发货快递",align:"center"},{field:"realityExpress",width:160,title:"实际发货快递",align:"center"},{field:"expressNumber",width:160,title:"快递单号",align:"center"},{field:"placeReceipt",width:160,title:"收货省份",align:"center"},{field:"orderTimeStr",width:180,title:"下单时间",align:"center"},{field:"storageTimeStr",width:180,title:"入库时间",align:"center"},{field:"inspectTimeStr",width:180,title:"送检时间",align:"center"},{field:"accomplishTimeStr",width:180,title:"质检完成时间",align:"center"},{field:" deliveryTime",width:180,title:"出库时间",align:"center"}]],id:"orderId",loading:!0,page:!0,even:!0,data:t,request:{pageName:"pageNum",limitName:"pageSize"}})),a(".dayOrderBox .playHeader span").html("".concat(c.companyName,"(").concat(e.data.day,")使用记录")),Object(u.j)(".dayOrderContent",".dayOrderBox")});var p=null;a(".pushBtn").click(function(){Object(u.b)();var a=new XMLHttpRequest;a.open("GET","".concat(Vapi,"/company/deriveExcel"),!0),a.setRequestHeader("token",sessionStorage.token),a.responseType="blob",a.onload=function(e){var t,n;200==a.status?(Object(u.a)(),a.response.size<50?i.msg("导出失败",{icon:7}):(n=a.response,(t=document.createElement("a")).download="商家信息汇总.xls",t.style.display="none",n=new Blob([n]),t.href=URL.createObjectURL(n),document.body.appendChild(t),t.click(),document.body.removeChild(t))):(Object(u.a)(),i.msg("服务器请求超时",{icon:2}))},a.send()}),a(".importBtn").click(function(){Object(u.j)(".pushOrderContent",".pushOrderBox")}),a("#pushMerchants").change(function(e){var n,t;a(this).val()&&(n=this,(t=new FormData).append("file",e.target.files[0]),Object(u.b)(),a.ajax({type:"post",url:"".concat(Vapi,"/company/excelCompany"),processData:!1,contentType:!1,timeout:6e4,headers:{token:sessionStorage.token},data:t,success:function(e){var t;Object(u.a)(),a(n).val(""),200==e.code?(i.msg(e.message,{icon:1}),Object(u.i)(".pushOrderContent",".pushOrderBox"),o.reload({where:{}})):403==e.code?(i.msg("登录过期,请重新登录",{icon:2}),setTimeout(function(e){window.parent.location.href="login.html"},1500)):0<e.data.length?(Object(u.i)(".pushOrderContent",".pushOrderBox"),Object(u.j)(".catchContent",".messageBox"),e=e.data,t="",e.forEach(function(e){t+="<p>".concat(e,"</p>")}),a(".messageBox .message .import_fail").html(t)):a(".messageBox .message .import_fail").html("导入失败")},error:function(){a(n).val(""),Object(u.a)(),a(".maskSpan").removeClass("maskIcon"),i.msg("服务器请求超时",{icon:2})}}))})})},348:function(e,t){}});